<!DOCTYPE html>
<html>
<head>
  <title>ajv.bundle.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "node_modules/ajv/dist/ajv.bundle.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>ajv.bundle.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">f</span>)</span>{<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> exports===<span class="hljs-string">"object"</span>&amp;&amp;<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span>!==<span class="hljs-string">"undefined"</span>){<span class="hljs-built_in">module</span>.exports=f()}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> define===<span class="hljs-string">"function"</span>&amp;&amp;define.amd){define([],f)}<span class="hljs-keyword">else</span>{<span class="hljs-keyword">var</span> g;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>!==<span class="hljs-string">"undefined"</span>){g=<span class="hljs-built_in">window</span>}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> global!==<span class="hljs-string">"undefined"</span>){g=global}<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> self!==<span class="hljs-string">"undefined"</span>){g=self}<span class="hljs-keyword">else</span>{g=<span class="hljs-keyword">this</span>}g.Ajv = f()}})(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-keyword">var</span> define,<span class="hljs-built_in">module</span>,exports;<span class="hljs-keyword">return</span> (<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">r</span>(<span class="hljs-params">e,n,t</span>)</span>{<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">o</span>(<span class="hljs-params">i,f</span>)</span>{<span class="hljs-keyword">if</span>(!n[i]){<span class="hljs-keyword">if</span>(!e[i]){<span class="hljs-keyword">var</span> c=<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>&amp;&amp;<span class="hljs-built_in">require</span>;<span class="hljs-keyword">if</span>(!f&amp;&amp;c)<span class="hljs-keyword">return</span> c(i,!<span class="hljs-number">0</span>);<span class="hljs-keyword">if</span>(u)<span class="hljs-keyword">return</span> u(i,!<span class="hljs-number">0</span>);<span class="hljs-keyword">var</span> a=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Cannot find module '"</span>+i+<span class="hljs-string">"'"</span>);<span class="hljs-keyword">throw</span> a.code=<span class="hljs-string">"MODULE_NOT_FOUND"</span>,a}<span class="hljs-keyword">var</span> p=n[i]={<span class="hljs-attr">exports</span>:{}};e[i][<span class="hljs-number">0</span>].call(p.exports,<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">r</span>)</span>{<span class="hljs-keyword">var</span> n=e[i][<span class="hljs-number">1</span>][r];<span class="hljs-keyword">return</span> o(n||r)},p,p.exports,r,e,n,t)}<span class="hljs-keyword">return</span> n[i].exports}<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> u=<span class="hljs-string">"function"</span>==<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span>&amp;&amp;<span class="hljs-built_in">require</span>,i=<span class="hljs-number">0</span>;i&lt;t.length;i++)o(t[i]);<span class="hljs-keyword">return</span> o}<span class="hljs-keyword">return</span> r})()({<span class="hljs-number">1</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;


<span class="hljs-keyword">var</span> Cache = <span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cache</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>._cache = {};
};


Cache.prototype.put = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cache_put</span>(<span class="hljs-params">key, value</span>) </span>{
  <span class="hljs-keyword">this</span>._cache[key] = value;
};


Cache.prototype.get = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cache_get</span>(<span class="hljs-params">key</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._cache[key];
};


Cache.prototype.del = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cache_del</span>(<span class="hljs-params">key</span>) </span>{
  <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._cache[key];
};


Cache.prototype.clear = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cache_clear</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>._cache = {};
};

},{}],<span class="hljs-number">2</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> MissingRefError = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./error_classes'</span>).MissingRef;

<span class="hljs-built_in">module</span>.exports = compileAsync;


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates validating function for passed schema with asynchronous loading of missing schemas.
<code>loadSchema</code> option should be a function that accepts schema uri and returns promise that resolves with the schema.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">meta</span>
<span class="dox_type">Boolean</span>
<span>optional true to compile meta-schema; this parameter can be skipped
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">Function</span>
<span>an optional node-style callback, it is called with 2 parameters: error (or null) and validating function.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Promise</span>
<span>promise that resolves with a validating function.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compileAsync</span>(<span class="hljs-params">schema, meta, callback</span>) </span>{
  <span class="hljs-comment">/* eslint no-shadow: 0 */</span>
  <span class="hljs-comment">/* global Promise */</span>
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>._opts.loadSchema != <span class="hljs-string">'function'</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'options.loadSchema should be a function'</span>);

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> meta == <span class="hljs-string">'function'</span>) {
    callback = meta;
    meta = <span class="hljs-literal">undefined</span>;
  }

  <span class="hljs-keyword">var</span> p = loadMetaSchemaOf(schema).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> schemaObj = self._addSchema(schema, <span class="hljs-literal">undefined</span>, meta);
    <span class="hljs-keyword">return</span> schemaObj.validate || _compileAsync(schemaObj);
  });

  <span class="hljs-keyword">if</span> (callback) {
    p.then(
      <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">v</span>) </span>{ callback(<span class="hljs-literal">null</span>, v); },
      callback
    );
  }

  <span class="hljs-keyword">return</span> p;


  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadMetaSchemaOf</span>(<span class="hljs-params">sch</span>) </span>{
    <span class="hljs-keyword">var</span> $schema = sch.$schema;
    <span class="hljs-keyword">return</span> $schema &amp;&amp; !self.getSchema($schema)
            ? compileAsync.call(self, { <span class="hljs-attr">$ref</span>: $schema }, <span class="hljs-literal">true</span>)
            : <span class="hljs-built_in">Promise</span>.resolve();
  }


  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_compileAsync</span>(<span class="hljs-params">schemaObj</span>) </span>{
    <span class="hljs-keyword">try</span> { <span class="hljs-keyword">return</span> self._compile(schemaObj); }
    <span class="hljs-keyword">catch</span>(e) {
      <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> MissingRefError) <span class="hljs-keyword">return</span> loadMissingSchema(e);
      <span class="hljs-keyword">throw</span> e;
    }


    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadMissingSchema</span>(<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">var</span> ref = e.missingSchema;
      <span class="hljs-keyword">if</span> (added(ref)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Schema '</span> + ref + <span class="hljs-string">' is loaded but '</span> + e.missingRef + <span class="hljs-string">' cannot be resolved'</span>);

      <span class="hljs-keyword">var</span> schemaPromise = self._loadingSchemas[ref];
      <span class="hljs-keyword">if</span> (!schemaPromise) {
        schemaPromise = self._loadingSchemas[ref] = self._opts.loadSchema(ref);
        schemaPromise.then(removePromise, removePromise);
      }

      <span class="hljs-keyword">return</span> schemaPromise.then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sch</span>) </span>{
        <span class="hljs-keyword">if</span> (!added(ref)) {
          <span class="hljs-keyword">return</span> loadMetaSchemaOf(sch).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (!added(ref)) self.addSchema(sch, ref, <span class="hljs-literal">undefined</span>, meta);
          });
        }
      }).then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> _compileAsync(schemaObj);
      });

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removePromise</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">delete</span> self._loadingSchemas[ref];
      }

      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">added</span>(<span class="hljs-params">ref</span>) </span>{
        <span class="hljs-keyword">return</span> self._refs[ref] || self._schemas[ref];
      }
    }
  }
}

},{<span class="hljs-string">"./error_classes"</span>:<span class="hljs-number">3</span>}],<span class="hljs-number">3</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> resolve = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./resolve'</span>);

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">Validation</span>: errorSubclass(ValidationError),
  <span class="hljs-attr">MissingRef</span>: errorSubclass(MissingRefError)
};


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ValidationError</span>(<span class="hljs-params">errors</span>) </span>{
  <span class="hljs-keyword">this</span>.message = <span class="hljs-string">'validation failed'</span>;
  <span class="hljs-keyword">this</span>.errors = errors;
  <span class="hljs-keyword">this</span>.ajv = <span class="hljs-keyword">this</span>.validation = <span class="hljs-literal">true</span>;
}


MissingRefError.message = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">baseId, ref</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'can\'t resolve reference '</span> + ref + <span class="hljs-string">' from id '</span> + baseId;
};


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MissingRefError</span>(<span class="hljs-params">baseId, ref, message</span>) </span>{
  <span class="hljs-keyword">this</span>.message = message || MissingRefError.message(baseId, ref);
  <span class="hljs-keyword">this</span>.missingRef = resolve.url(baseId, ref);
  <span class="hljs-keyword">this</span>.missingSchema = resolve.normalizeId(resolve.fullPath(<span class="hljs-keyword">this</span>.missingRef));
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorSubclass</span>(<span class="hljs-params">Subclass</span>) </span>{
  Subclass.prototype = <span class="hljs-built_in">Object</span>.create(<span class="hljs-built_in">Error</span>.prototype);
  Subclass.prototype.constructor = Subclass;
  <span class="hljs-keyword">return</span> Subclass;
}

},{<span class="hljs-string">"./resolve"</span>:<span class="hljs-number">6</span>}],<span class="hljs-number">4</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./util'</span>);

<span class="hljs-keyword">var</span> DATE = <span class="hljs-regexp">/^(\d\d\d\d)-(\d\d)-(\d\d)$/</span>;
<span class="hljs-keyword">var</span> DAYS = [<span class="hljs-number">0</span>,<span class="hljs-number">31</span>,<span class="hljs-number">28</span>,<span class="hljs-number">31</span>,<span class="hljs-number">30</span>,<span class="hljs-number">31</span>,<span class="hljs-number">30</span>,<span class="hljs-number">31</span>,<span class="hljs-number">31</span>,<span class="hljs-number">30</span>,<span class="hljs-number">31</span>,<span class="hljs-number">30</span>,<span class="hljs-number">31</span>];
<span class="hljs-keyword">var</span> TIME = <span class="hljs-regexp">/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i</span>;
<span class="hljs-keyword">var</span> HOSTNAME = <span class="hljs-regexp">/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i</span>;
<span class="hljs-keyword">var</span> URI = <span class="hljs-regexp">/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&amp;'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&amp;'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&amp;'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&amp;'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i</span>;
<span class="hljs-keyword">var</span> URIREF = <span class="hljs-regexp">/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&amp;'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&amp;'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&amp;'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&amp;'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>uri-template: https://tools.ietf.org/html/rfc6570</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> URITEMPLATE = <span class="hljs-regexp">/^(?:(?:[^\x00-\x20"'&lt;&gt;%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&amp;=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>For the source: https://gist.github.com/dperini/729294
For test cases: https://mathiasbynens.be/demo/url-regex
@todo Delete current URL in favour of the commented out URL rule when this issue is fixed https://github.com/eslint/eslint/issues/7983.
var URL = /^(?:(?:https?|ftp)://)(?:\S+(?::\S*)?@)?(?:(?!10(?:.\d{1,3}){3})(?!127(?:.\d{1,3}){3})(?!169.254(?:.\d{1,3}){2})(?!192.168(?:.\d{1,3}){2})(?!172.(?:1[6-9]|2\d|3[0-1])(?:.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u{00a1}-\u{ffff}0-9]+-)<em>[a-z\u{00a1}-\u{ffff}0-9]+)(?:.(?:[a-z\u{00a1}-\u{ffff}0-9]+-)</em>[a-z\u{00a1}-\u{ffff}0-9]+)<em>(?:.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:/[^\s]</em>)?$/iu;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> URL = <span class="hljs-regexp">/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i</span>;
<span class="hljs-keyword">var</span> UUID = <span class="hljs-regexp">/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i</span>;
<span class="hljs-keyword">var</span> JSON_POINTER = <span class="hljs-regexp">/^(?:\/(?:[^~/]|~0|~1)*)*$/</span>;
<span class="hljs-keyword">var</span> JSON_POINTER_URI_FRAGMENT = <span class="hljs-regexp">/^#(?:\/(?:[a-z0-9_\-.!$&amp;'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i</span>;
<span class="hljs-keyword">var</span> RELATIVE_JSON_POINTER = <span class="hljs-regexp">/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/</span>;


<span class="hljs-built_in">module</span>.exports = formats;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formats</span>(<span class="hljs-params">mode</span>) </span>{
  mode = mode == <span class="hljs-string">'full'</span> ? <span class="hljs-string">'full'</span> : <span class="hljs-string">'fast'</span>;
  <span class="hljs-keyword">return</span> util.copy(formats[mode]);
}


formats.fast = {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>date: http://tools.ietf.org/html/rfc3339#section-5.6</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  date: <span class="hljs-regexp">/^\d\d\d\d-[0-1]\d-[0-3]\d$/</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>date-time: http://tools.ietf.org/html/rfc3339#section-5.6</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  time: <span class="hljs-regexp">/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i</span>,
  <span class="hljs-string">'date-time'</span>: <span class="hljs-regexp">/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  uri: <span class="hljs-regexp">/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i</span>,
  <span class="hljs-string">'uri-reference'</span>: <span class="hljs-regexp">/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i</span>,
  <span class="hljs-string">'uri-template'</span>: URITEMPLATE,
  <span class="hljs-attr">url</span>: URL,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>email (sources from jsen validator):
http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363
http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'willful violation')</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  email: <span class="hljs-regexp">/^[a-z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i</span>,
  <span class="hljs-attr">hostname</span>: HOSTNAME,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ipv4: <span class="hljs-regexp">/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>optimized http://stackoverflow.com/questions/53497/regular-expression-that-matches-valid-ipv6-addresses</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  ipv6: <span class="hljs-regexp">/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i</span>,
  <span class="hljs-attr">regex</span>: regex,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>uuid: http://tools.ietf.org/html/rfc4122</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  uuid: UUID,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>JSON-pointer: https://tools.ietf.org/html/rfc6901
uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-string">'json-pointer'</span>: JSON_POINTER,
  <span class="hljs-string">'json-pointer-uri-fragment'</span>: JSON_POINTER_URI_FRAGMENT,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-string">'relative-json-pointer'</span>: RELATIVE_JSON_POINTER
};


formats.full = {
  <span class="hljs-attr">date</span>: date,
  <span class="hljs-attr">time</span>: time,
  <span class="hljs-string">'date-time'</span>: date_time,
  <span class="hljs-attr">uri</span>: uri,
  <span class="hljs-string">'uri-reference'</span>: URIREF,
  <span class="hljs-string">'uri-template'</span>: URITEMPLATE,
  <span class="hljs-attr">url</span>: URL,
  <span class="hljs-attr">email</span>: <span class="hljs-regexp">/^[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i</span>,
  <span class="hljs-attr">hostname</span>: HOSTNAME,
  <span class="hljs-attr">ipv4</span>: <span class="hljs-regexp">/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span>,
  <span class="hljs-attr">ipv6</span>: <span class="hljs-regexp">/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i</span>,
  <span class="hljs-attr">regex</span>: regex,
  <span class="hljs-attr">uuid</span>: UUID,
  <span class="hljs-string">'json-pointer'</span>: JSON_POINTER,
  <span class="hljs-string">'json-pointer-uri-fragment'</span>: JSON_POINTER_URI_FRAGMENT,
  <span class="hljs-string">'relative-json-pointer'</span>: RELATIVE_JSON_POINTER
};


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isLeapYear</span>(<span class="hljs-params">year</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>https://tools.ietf.org/html/rfc3339#appendix-C</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">return</span> year % <span class="hljs-number">4</span> === <span class="hljs-number">0</span> &amp;&amp; (year % <span class="hljs-number">100</span> !== <span class="hljs-number">0</span> || year % <span class="hljs-number">400</span> === <span class="hljs-number">0</span>);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">date</span>(<span class="hljs-params">str</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>full-date from http://tools.ietf.org/html/rfc3339#section-5.6</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> matches = str.match(DATE);
  <span class="hljs-keyword">if</span> (!matches) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">var</span> year = +matches[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> month = +matches[<span class="hljs-number">2</span>];
  <span class="hljs-keyword">var</span> day = +matches[<span class="hljs-number">3</span>];

  <span class="hljs-keyword">return</span> month &gt;= <span class="hljs-number">1</span> &amp;&amp; month &lt;= <span class="hljs-number">12</span> &amp;&amp; day &gt;= <span class="hljs-number">1</span> &amp;&amp;
          day &lt;= (month == <span class="hljs-number">2</span> &amp;&amp; isLeapYear(year) ? <span class="hljs-number">29</span> : DAYS[month]);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">time</span>(<span class="hljs-params">str, full</span>) </span>{
  <span class="hljs-keyword">var</span> matches = str.match(TIME);
  <span class="hljs-keyword">if</span> (!matches) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">var</span> hour = matches[<span class="hljs-number">1</span>];
  <span class="hljs-keyword">var</span> minute = matches[<span class="hljs-number">2</span>];
  <span class="hljs-keyword">var</span> second = matches[<span class="hljs-number">3</span>];
  <span class="hljs-keyword">var</span> timeZone = matches[<span class="hljs-number">5</span>];
  <span class="hljs-keyword">return</span> ((hour &lt;= <span class="hljs-number">23</span> &amp;&amp; minute &lt;= <span class="hljs-number">59</span> &amp;&amp; second &lt;= <span class="hljs-number">59</span>) ||
          (hour == <span class="hljs-number">23</span> &amp;&amp; minute == <span class="hljs-number">59</span> &amp;&amp; second == <span class="hljs-number">60</span>)) &amp;&amp;
         (!full || timeZone);
}


<span class="hljs-keyword">var</span> DATE_TIME_SEPARATOR = <span class="hljs-regexp">/t|\s/i</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">date_time</span>(<span class="hljs-params">str</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>http://tools.ietf.org/html/rfc3339#section-5.6</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> dateTime = str.split(DATE_TIME_SEPARATOR);
  <span class="hljs-keyword">return</span> dateTime.length == <span class="hljs-number">2</span> &amp;&amp; date(dateTime[<span class="hljs-number">0</span>]) &amp;&amp; time(dateTime[<span class="hljs-number">1</span>], <span class="hljs-literal">true</span>);
}


<span class="hljs-keyword">var</span> NOT_URI_FRAGMENT = <span class="hljs-regexp">/\/|:/</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">uri</span>(<span class="hljs-params">str</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required &quot;.&quot;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">return</span> NOT_URI_FRAGMENT.test(str) &amp;&amp; URI.test(str);
}


<span class="hljs-keyword">var</span> Z_ANCHOR = <span class="hljs-regexp">/[^\\]\\Z/</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">regex</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">if</span> (Z_ANCHOR.test(str)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(str);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  } <span class="hljs-keyword">catch</span>(e) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
}

},{<span class="hljs-string">"./util"</span>:<span class="hljs-number">10</span>}],<span class="hljs-number">5</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> resolve = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./resolve'</span>)
  , util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./util'</span>)
  , errorClasses = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./error_classes'</span>)
  , stableStringify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-json-stable-stringify'</span>);

<span class="hljs-keyword">var</span> validateGenerator = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../dotjs/validate'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<div class="dox">
<div class="summary">
<p>Functions below are used inside compiled validations function</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> ucs2length = util.ucs2length;
<span class="hljs-keyword">var</span> equal = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-deep-equal'</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>this error is thrown by async schemas to return validation errors via exception</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ValidationError = errorClasses.Validation;

<span class="hljs-built_in">module</span>.exports = compile;


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<div class="dox">
<div class="summary">
<p>Compiles schema to validation function</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">root</span>
<span class="dox_type">Object</span>
<span>object with information about the root schema for this schema
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">localRefs</span>
<span class="dox_type">Object</span>
<span>the hash of local references inside the schema (created by resolve.id), used for inline resolution
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">baseId</span>
<span class="dox_type">String</span>
<span>base ID for IDs in the schema
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Function</span>
<span>validation function
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compile</span>(<span class="hljs-params">schema, root, localRefs, baseId</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true, evil: true */</span>
  <span class="hljs-comment">/* eslint no-shadow: 0 */</span>
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>
    , opts = <span class="hljs-keyword">this</span>._opts
    , refVal = [ <span class="hljs-literal">undefined</span> ]
    , refs = {}
    , patterns = []
    , patternsHash = {}
    , defaults = []
    , defaultsHash = {}
    , customRules = [];

  root = root || { <span class="hljs-attr">schema</span>: schema, <span class="hljs-attr">refVal</span>: refVal, <span class="hljs-attr">refs</span>: refs };

  <span class="hljs-keyword">var</span> c = checkCompiling.call(<span class="hljs-keyword">this</span>, schema, root, baseId);
  <span class="hljs-keyword">var</span> compilation = <span class="hljs-keyword">this</span>._compilations[c.index];
  <span class="hljs-keyword">if</span> (c.compiling) <span class="hljs-keyword">return</span> (compilation.callValidate = callValidate);

  <span class="hljs-keyword">var</span> formats = <span class="hljs-keyword">this</span>._formats;
  <span class="hljs-keyword">var</span> RULES = <span class="hljs-keyword">this</span>.RULES;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">var</span> v = localCompile(schema, root, localRefs, baseId);
    compilation.validate = v;
    <span class="hljs-keyword">var</span> cv = compilation.callValidate;
    <span class="hljs-keyword">if</span> (cv) {
      cv.schema = v.schema;
      cv.errors = <span class="hljs-literal">null</span>;
      cv.refs = v.refs;
      cv.refVal = v.refVal;
      cv.root = v.root;
      cv.$<span class="hljs-keyword">async</span> = v.$<span class="hljs-keyword">async</span>;
      <span class="hljs-keyword">if</span> (opts.sourceCode) cv.source = v.source;
    }
    <span class="hljs-keyword">return</span> v;
  } <span class="hljs-keyword">finally</span> {
    endCompiling.call(<span class="hljs-keyword">this</span>, schema, root, baseId);
  }

  <span class="hljs-comment">/* @this   {*} - custom context, see passContext option */</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callValidate</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/* jshint validthis: true */</span>
    <span class="hljs-keyword">var</span> validate = compilation.validate;
    <span class="hljs-keyword">var</span> result = validate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    callValidate.errors = validate.errors;
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">localCompile</span>(<span class="hljs-params">_schema, _root, localRefs, baseId</span>) </span>{
    <span class="hljs-keyword">var</span> isRoot = !_root || (_root &amp;&amp; _root.schema == _schema);
    <span class="hljs-keyword">if</span> (_root.schema != root.schema)
      <span class="hljs-keyword">return</span> compile.call(self, _schema, _root, localRefs, baseId);

    <span class="hljs-keyword">var</span> $<span class="hljs-keyword">async</span> = _schema.$<span class="hljs-keyword">async</span> === <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">var</span> sourceCode = validateGenerator({
      <span class="hljs-attr">isTop</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">schema</span>: _schema,
      <span class="hljs-attr">isRoot</span>: isRoot,
      <span class="hljs-attr">baseId</span>: baseId,
      <span class="hljs-attr">root</span>: _root,
      <span class="hljs-attr">schemaPath</span>: <span class="hljs-string">''</span>,
      <span class="hljs-attr">errSchemaPath</span>: <span class="hljs-string">'#'</span>,
      <span class="hljs-attr">errorPath</span>: <span class="hljs-string">'""'</span>,
      <span class="hljs-attr">MissingRefError</span>: errorClasses.MissingRef,
      <span class="hljs-attr">RULES</span>: RULES,
      <span class="hljs-attr">validate</span>: validateGenerator,
      <span class="hljs-attr">util</span>: util,
      <span class="hljs-attr">resolve</span>: resolve,
      <span class="hljs-attr">resolveRef</span>: resolveRef,
      <span class="hljs-attr">usePattern</span>: usePattern,
      <span class="hljs-attr">useDefault</span>: useDefault,
      <span class="hljs-attr">useCustomRule</span>: useCustomRule,
      <span class="hljs-attr">opts</span>: opts,
      <span class="hljs-attr">formats</span>: formats,
      <span class="hljs-attr">logger</span>: self.logger,
      <span class="hljs-attr">self</span>: self
    });

    sourceCode = vars(refVal, refValCode) + vars(patterns, patternCode)
                   + vars(defaults, defaultCode) + vars(customRules, customRuleCode)
                   + sourceCode;

    <span class="hljs-keyword">if</span> (opts.processCode) sourceCode = opts.processCode(sourceCode, _schema);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<p>console.log('\n\n\n *** \n', JSON.stringify(sourceCode));</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> validate;
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">var</span> makeValidate = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(
        <span class="hljs-string">'self'</span>,
        <span class="hljs-string">'RULES'</span>,
        <span class="hljs-string">'formats'</span>,
        <span class="hljs-string">'root'</span>,
        <span class="hljs-string">'refVal'</span>,
        <span class="hljs-string">'defaults'</span>,
        <span class="hljs-string">'customRules'</span>,
        <span class="hljs-string">'equal'</span>,
        <span class="hljs-string">'ucs2length'</span>,
        <span class="hljs-string">'ValidationError'</span>,
        sourceCode
      );

      validate = makeValidate(
        self,
        RULES,
        formats,
        root,
        refVal,
        defaults,
        customRules,
        equal,
        ucs2length,
        ValidationError
      );

      refVal[<span class="hljs-number">0</span>] = validate;
    } <span class="hljs-keyword">catch</span>(e) {
      self.logger.error(<span class="hljs-string">'Error compiling schema, function code:'</span>, sourceCode);
      <span class="hljs-keyword">throw</span> e;
    }

    validate.schema = _schema;
    validate.errors = <span class="hljs-literal">null</span>;
    validate.refs = refs;
    validate.refVal = refVal;
    validate.root = isRoot ? validate : _root;
    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span>) validate.$<span class="hljs-keyword">async</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> (opts.sourceCode === <span class="hljs-literal">true</span>) {
      validate.source = {
        <span class="hljs-attr">code</span>: sourceCode,
        <span class="hljs-attr">patterns</span>: patterns,
        <span class="hljs-attr">defaults</span>: defaults
      };
    }

    <span class="hljs-keyword">return</span> validate;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveRef</span>(<span class="hljs-params">baseId, ref, isRoot</span>) </span>{
    ref = resolve.url(baseId, ref);
    <span class="hljs-keyword">var</span> refIndex = refs[ref];
    <span class="hljs-keyword">var</span> _refVal, refCode;
    <span class="hljs-keyword">if</span> (refIndex !== <span class="hljs-literal">undefined</span>) {
      _refVal = refVal[refIndex];
      refCode = <span class="hljs-string">'refVal['</span> + refIndex + <span class="hljs-string">']'</span>;
      <span class="hljs-keyword">return</span> resolvedRef(_refVal, refCode);
    }
    <span class="hljs-keyword">if</span> (!isRoot &amp;&amp; root.refs) {
      <span class="hljs-keyword">var</span> rootRefId = root.refs[ref];
      <span class="hljs-keyword">if</span> (rootRefId !== <span class="hljs-literal">undefined</span>) {
        _refVal = root.refVal[rootRefId];
        refCode = addLocalRef(ref, _refVal);
        <span class="hljs-keyword">return</span> resolvedRef(_refVal, refCode);
      }
    }

    refCode = addLocalRef(ref);
    <span class="hljs-keyword">var</span> v = resolve.call(self, localCompile, root, ref);
    <span class="hljs-keyword">if</span> (v === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">var</span> localSchema = localRefs &amp;&amp; localRefs[ref];
      <span class="hljs-keyword">if</span> (localSchema) {
        v = resolve.inlineRef(localSchema, opts.inlineRefs)
            ? localSchema
            : compile.call(self, localSchema, root, localRefs, baseId);
      }
    }

    <span class="hljs-keyword">if</span> (v === <span class="hljs-literal">undefined</span>) {
      removeLocalRef(ref);
    } <span class="hljs-keyword">else</span> {
      replaceLocalRef(ref, v);
      <span class="hljs-keyword">return</span> resolvedRef(v, refCode);
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLocalRef</span>(<span class="hljs-params">ref, v</span>) </span>{
    <span class="hljs-keyword">var</span> refId = refVal.length;
    refVal[refId] = v;
    refs[ref] = refId;
    <span class="hljs-keyword">return</span> <span class="hljs-string">'refVal'</span> + refId;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeLocalRef</span>(<span class="hljs-params">ref</span>) </span>{
    <span class="hljs-keyword">delete</span> refs[ref];
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceLocalRef</span>(<span class="hljs-params">ref, v</span>) </span>{
    <span class="hljs-keyword">var</span> refId = refs[ref];
    refVal[refId] = v;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolvedRef</span>(<span class="hljs-params">refVal, code</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> refVal == <span class="hljs-string">'object'</span> || <span class="hljs-keyword">typeof</span> refVal == <span class="hljs-string">'boolean'</span>
            ? { <span class="hljs-attr">code</span>: code, <span class="hljs-attr">schema</span>: refVal, <span class="hljs-attr">inline</span>: <span class="hljs-literal">true</span> }
            : { <span class="hljs-attr">code</span>: code, <span class="hljs-attr">$async</span>: refVal &amp;&amp; !!refVal.$<span class="hljs-keyword">async</span> };
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">usePattern</span>(<span class="hljs-params">regexStr</span>) </span>{
    <span class="hljs-keyword">var</span> index = patternsHash[regexStr];
    <span class="hljs-keyword">if</span> (index === <span class="hljs-literal">undefined</span>) {
      index = patternsHash[regexStr] = patterns.length;
      patterns[index] = regexStr;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">'pattern'</span> + index;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDefault</span>(<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> value) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'boolean'</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span> + value;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
        <span class="hljs-keyword">return</span> util.toQuotedString(value);
      <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>:
        <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'null'</span>;
        <span class="hljs-keyword">var</span> valueStr = stableStringify(value);
        <span class="hljs-keyword">var</span> index = defaultsHash[valueStr];
        <span class="hljs-keyword">if</span> (index === <span class="hljs-literal">undefined</span>) {
          index = defaultsHash[valueStr] = defaults.length;
          defaults[index] = value;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">'default'</span> + index;
    }
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCustomRule</span>(<span class="hljs-params">rule, schema, parentSchema, it</span>) </span>{
    <span class="hljs-keyword">if</span> (self._opts.validateSchema !== <span class="hljs-literal">false</span>) {
      <span class="hljs-keyword">var</span> deps = rule.definition.dependencies;
      <span class="hljs-keyword">if</span> (deps &amp;&amp; !deps.every(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">keyword</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(parentSchema, keyword);
      }))
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'parent schema must have all required keywords: '</span> + deps.join(<span class="hljs-string">','</span>));

      <span class="hljs-keyword">var</span> validateSchema = rule.definition.validateSchema;
      <span class="hljs-keyword">if</span> (validateSchema) {
        <span class="hljs-keyword">var</span> valid = validateSchema(schema);
        <span class="hljs-keyword">if</span> (!valid) {
          <span class="hljs-keyword">var</span> message = <span class="hljs-string">'keyword schema is invalid: '</span> + self.errorsText(validateSchema.errors);
          <span class="hljs-keyword">if</span> (self._opts.validateSchema == <span class="hljs-string">'log'</span>) self.logger.error(message);
          <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(message);
        }
      }
    }

    <span class="hljs-keyword">var</span> compile = rule.definition.compile
      , inline = rule.definition.inline
      , macro = rule.definition.macro;

    <span class="hljs-keyword">var</span> validate;
    <span class="hljs-keyword">if</span> (compile) {
      validate = compile.call(self, schema, parentSchema, it);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (macro) {
      validate = macro.call(self, schema, parentSchema, it);
      <span class="hljs-keyword">if</span> (opts.validateSchema !== <span class="hljs-literal">false</span>) self.validateSchema(validate, <span class="hljs-literal">true</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (inline) {
      validate = inline.call(self, it, rule.keyword, schema, parentSchema);
    } <span class="hljs-keyword">else</span> {
      validate = rule.definition.validate;
      <span class="hljs-keyword">if</span> (!validate) <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (validate === <span class="hljs-literal">undefined</span>)
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'custom keyword "'</span> + rule.keyword + <span class="hljs-string">'"failed to compile'</span>);

    <span class="hljs-keyword">var</span> index = customRules.length;
    customRules[index] = validate;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">code</span>: <span class="hljs-string">'customRule'</span> + index,
      <span class="hljs-attr">validate</span>: validate
    };
  }
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22"></a>
</div>
<div class="dox">
<div class="summary">
<p>Checks if the schema is currently compiled</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema to compile
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">root</span>
<span class="dox_type">Object</span>
<span>root object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">baseId</span>
<span class="dox_type">String</span>
<span>base schema ID
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Object</span>
<span>object with properties &quot;index&quot; (compilation index) and &quot;compiling&quot; (boolean)
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkCompiling</span>(<span class="hljs-params">schema, root, baseId</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> index = compIndex.call(<span class="hljs-keyword">this</span>, schema, root, baseId);
  <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> { <span class="hljs-attr">index</span>: index, <span class="hljs-attr">compiling</span>: <span class="hljs-literal">true</span> };
  index = <span class="hljs-keyword">this</span>._compilations.length;
  <span class="hljs-keyword">this</span>._compilations[index] = {
    <span class="hljs-attr">schema</span>: schema,
    <span class="hljs-attr">root</span>: root,
    <span class="hljs-attr">baseId</span>: baseId
  };
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">index</span>: index, <span class="hljs-attr">compiling</span>: <span class="hljs-literal">false</span> };
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23"></a>
</div>
<div class="dox">
<div class="summary">
<p>Removes the schema from the currently compiled list</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema to compile
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">root</span>
<span class="dox_type">Object</span>
<span>root object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">baseId</span>
<span class="dox_type">String</span>
<span>base schema ID
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">endCompiling</span>(<span class="hljs-params">schema, root, baseId</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> i = compIndex.call(<span class="hljs-keyword">this</span>, schema, root, baseId);
  <span class="hljs-keyword">if</span> (i &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">this</span>._compilations.splice(i, <span class="hljs-number">1</span>);
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24"></a>
</div>
<div class="dox">
<div class="summary">
<p>Index of schema compilation in the currently compiled list</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema to compile
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">root</span>
<span class="dox_type">Object</span>
<span>root object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">baseId</span>
<span class="dox_type">String</span>
<span>base schema ID
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Integer</span>
<span>compilation index
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compIndex</span>(<span class="hljs-params">schema, root, baseId</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-keyword">this</span>._compilations.length; i++) {
    <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>._compilations[i];
    <span class="hljs-keyword">if</span> (c.schema == schema &amp;&amp; c.root == root &amp;&amp; c.baseId == baseId) <span class="hljs-keyword">return</span> i;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">patternCode</span>(<span class="hljs-params">i, patterns</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'var pattern'</span> + i + <span class="hljs-string">' = new RegExp('</span> + util.toQuotedString(patterns[i]) + <span class="hljs-string">');'</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultCode</span>(<span class="hljs-params">i</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'var default'</span> + i + <span class="hljs-string">' = defaults['</span> + i + <span class="hljs-string">'];'</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">refValCode</span>(<span class="hljs-params">i, refVal</span>) </span>{
  <span class="hljs-keyword">return</span> refVal[i] === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">''</span> : <span class="hljs-string">'var refVal'</span> + i + <span class="hljs-string">' = refVal['</span> + i + <span class="hljs-string">'];'</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">customRuleCode</span>(<span class="hljs-params">i</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'var customRule'</span> + i + <span class="hljs-string">' = customRules['</span> + i + <span class="hljs-string">'];'</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vars</span>(<span class="hljs-params">arr, statement</span>) </span>{
  <span class="hljs-keyword">if</span> (!arr.length) <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> code = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;arr.length; i++)
    code += statement(i, arr);
  <span class="hljs-keyword">return</span> code;
}

},{<span class="hljs-string">"../dotjs/validate"</span>:<span class="hljs-number">38</span>,<span class="hljs-string">"./error_classes"</span>:<span class="hljs-number">3</span>,<span class="hljs-string">"./resolve"</span>:<span class="hljs-number">6</span>,<span class="hljs-string">"./util"</span>:<span class="hljs-number">10</span>,<span class="hljs-string">"fast-deep-equal"</span>:<span class="hljs-number">42</span>,<span class="hljs-string">"fast-json-stable-stringify"</span>:<span class="hljs-number">43</span>}],<span class="hljs-number">6</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> URI = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uri-js'</span>)
  , equal = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-deep-equal'</span>)
  , util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./util'</span>)
  , SchemaObject = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./schema_obj'</span>)
  , traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">'json-schema-traverse'</span>);

<span class="hljs-built_in">module</span>.exports = resolve;

resolve.normalizeId = normalizeId;
resolve.fullPath = getFullPath;
resolve.url = resolveUrl;
resolve.ids = resolveIds;
resolve.inlineRef = inlineRef;
resolve.schema = resolveSchema;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-25" id="section-25"></a>
</div>
<div class="dox">
<div class="summary">
<p>[resolve and compile the references ($ref)]</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">compile</span>
<span class="dox_type">Function</span>
<span>reference to schema compilation funciton (localCompile)
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">root</span>
<span class="dox_type">Object</span>
<span>object with information about the root schema for the current schema
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">ref</span>
<span class="dox_type">String</span>
<span>reference to resolve
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Object</span>
<span class="dox_type">Function</span>
<span>schema object (if the schema can be inlined) or validation function
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolve</span>(<span class="hljs-params">compile, root, ref</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> refVal = <span class="hljs-keyword">this</span>._refs[ref];
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> refVal == <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._refs[refVal]) refVal = <span class="hljs-keyword">this</span>._refs[refVal];
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> resolve.call(<span class="hljs-keyword">this</span>, compile, root, refVal);
  }

  refVal = refVal || <span class="hljs-keyword">this</span>._schemas[ref];
  <span class="hljs-keyword">if</span> (refVal <span class="hljs-keyword">instanceof</span> SchemaObject) {
    <span class="hljs-keyword">return</span> inlineRef(refVal.schema, <span class="hljs-keyword">this</span>._opts.inlineRefs)
            ? refVal.schema
            : refVal.validate || <span class="hljs-keyword">this</span>._compile(refVal);
  }

  <span class="hljs-keyword">var</span> res = resolveSchema.call(<span class="hljs-keyword">this</span>, root, ref);
  <span class="hljs-keyword">var</span> schema, v, baseId;
  <span class="hljs-keyword">if</span> (res) {
    schema = res.schema;
    root = res.root;
    baseId = res.baseId;
  }

  <span class="hljs-keyword">if</span> (schema <span class="hljs-keyword">instanceof</span> SchemaObject) {
    v = schema.validate || compile.call(<span class="hljs-keyword">this</span>, schema.schema, root, <span class="hljs-literal">undefined</span>, baseId);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (schema !== <span class="hljs-literal">undefined</span>) {
    v = inlineRef(schema, <span class="hljs-keyword">this</span>._opts.inlineRefs)
        ? schema
        : compile.call(<span class="hljs-keyword">this</span>, schema, root, <span class="hljs-literal">undefined</span>, baseId);
  }

  <span class="hljs-keyword">return</span> v;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26"></a>
</div>
<div class="dox">
<div class="summary">
<p>Resolve schema, its root and baseId</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">root</span>
<span class="dox_type">Object</span>
<span>root object with properties schema, refVal, refs
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">ref</span>
<span class="dox_type">String</span>
<span>reference to resolve
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Object</span>
<span>object with properties schema, root, baseId
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveSchema</span>(<span class="hljs-params">root, ref</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> p = URI.parse(ref)
    , refPath = _getFullPath(p)
    , baseId = getFullPath(<span class="hljs-keyword">this</span>._getId(root.schema));
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(root.schema).length === <span class="hljs-number">0</span> || refPath !== baseId) {
    <span class="hljs-keyword">var</span> id = normalizeId(refPath);
    <span class="hljs-keyword">var</span> refVal = <span class="hljs-keyword">this</span>._refs[id];
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> refVal == <span class="hljs-string">'string'</span>) {
      <span class="hljs-keyword">return</span> resolveRecursive.call(<span class="hljs-keyword">this</span>, root, refVal, p);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (refVal <span class="hljs-keyword">instanceof</span> SchemaObject) {
      <span class="hljs-keyword">if</span> (!refVal.validate) <span class="hljs-keyword">this</span>._compile(refVal);
      root = refVal;
    } <span class="hljs-keyword">else</span> {
      refVal = <span class="hljs-keyword">this</span>._schemas[id];
      <span class="hljs-keyword">if</span> (refVal <span class="hljs-keyword">instanceof</span> SchemaObject) {
        <span class="hljs-keyword">if</span> (!refVal.validate) <span class="hljs-keyword">this</span>._compile(refVal);
        <span class="hljs-keyword">if</span> (id == normalizeId(ref))
          <span class="hljs-keyword">return</span> { <span class="hljs-attr">schema</span>: refVal, <span class="hljs-attr">root</span>: root, <span class="hljs-attr">baseId</span>: baseId };
        root = refVal;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span>;
      }
    }
    <span class="hljs-keyword">if</span> (!root.schema) <span class="hljs-keyword">return</span>;
    baseId = getFullPath(<span class="hljs-keyword">this</span>._getId(root.schema));
  }
  <span class="hljs-keyword">return</span> getJsonPointer.call(<span class="hljs-keyword">this</span>, p, baseId, root.schema, root);
}


<span class="hljs-comment">/* @this Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveRecursive</span>(<span class="hljs-params">root, ref, parsedRef</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> res = resolveSchema.call(<span class="hljs-keyword">this</span>, root, ref);
  <span class="hljs-keyword">if</span> (res) {
    <span class="hljs-keyword">var</span> schema = res.schema;
    <span class="hljs-keyword">var</span> baseId = res.baseId;
    root = res.root;
    <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>._getId(schema);
    <span class="hljs-keyword">if</span> (id) baseId = resolveUrl(baseId, id);
    <span class="hljs-keyword">return</span> getJsonPointer.call(<span class="hljs-keyword">this</span>, parsedRef, baseId, schema, root);
  }
}


<span class="hljs-keyword">var</span> PREVENT_SCOPE_CHANGE = util.toHash([<span class="hljs-string">'properties'</span>, <span class="hljs-string">'patternProperties'</span>, <span class="hljs-string">'enum'</span>, <span class="hljs-string">'dependencies'</span>, <span class="hljs-string">'definitions'</span>]);
<span class="hljs-comment">/* @this Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getJsonPointer</span>(<span class="hljs-params">parsedRef, baseId, schema, root</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  parsedRef.fragment = parsedRef.fragment || <span class="hljs-string">''</span>;
  <span class="hljs-keyword">if</span> (parsedRef.fragment.slice(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>) != <span class="hljs-string">'/'</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> parts = parsedRef.fragment.split(<span class="hljs-string">'/'</span>);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">1</span>; i &lt; parts.length; i++) {
    <span class="hljs-keyword">var</span> part = parts[i];
    <span class="hljs-keyword">if</span> (part) {
      part = util.unescapeFragment(part);
      schema = schema[part];
      <span class="hljs-keyword">if</span> (schema === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">var</span> id;
      <span class="hljs-keyword">if</span> (!PREVENT_SCOPE_CHANGE[part]) {
        id = <span class="hljs-keyword">this</span>._getId(schema);
        <span class="hljs-keyword">if</span> (id) baseId = resolveUrl(baseId, id);
        <span class="hljs-keyword">if</span> (schema.$ref) {
          <span class="hljs-keyword">var</span> $ref = resolveUrl(baseId, schema.$ref);
          <span class="hljs-keyword">var</span> res = resolveSchema.call(<span class="hljs-keyword">this</span>, root, $ref);
          <span class="hljs-keyword">if</span> (res) {
            schema = res.schema;
            root = res.root;
            baseId = res.baseId;
          }
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> (schema !== <span class="hljs-literal">undefined</span> &amp;&amp; schema !== root.schema)
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">schema</span>: schema, <span class="hljs-attr">root</span>: root, <span class="hljs-attr">baseId</span>: baseId };
}


<span class="hljs-keyword">var</span> SIMPLE_INLINED = util.toHash([
  <span class="hljs-string">'type'</span>, <span class="hljs-string">'format'</span>, <span class="hljs-string">'pattern'</span>,
  <span class="hljs-string">'maxLength'</span>, <span class="hljs-string">'minLength'</span>,
  <span class="hljs-string">'maxProperties'</span>, <span class="hljs-string">'minProperties'</span>,
  <span class="hljs-string">'maxItems'</span>, <span class="hljs-string">'minItems'</span>,
  <span class="hljs-string">'maximum'</span>, <span class="hljs-string">'minimum'</span>,
  <span class="hljs-string">'uniqueItems'</span>, <span class="hljs-string">'multipleOf'</span>,
  <span class="hljs-string">'required'</span>, <span class="hljs-string">'enum'</span>
]);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inlineRef</span>(<span class="hljs-params">schema, limit</span>) </span>{
  <span class="hljs-keyword">if</span> (limit === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">if</span> (limit === <span class="hljs-literal">undefined</span> || limit === <span class="hljs-literal">true</span>) <span class="hljs-keyword">return</span> checkNoRef(schema);
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (limit) <span class="hljs-keyword">return</span> countKeys(schema) &lt;= limit;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkNoRef</span>(<span class="hljs-params">schema</span>) </span>{
  <span class="hljs-keyword">var</span> item;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(schema)) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;schema.length; i++) {
      item = schema[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item == <span class="hljs-string">'object'</span> &amp;&amp; !checkNoRef(item)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> schema) {
      <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'$ref'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      item = schema[key];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item == <span class="hljs-string">'object'</span> &amp;&amp; !checkNoRef(item)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">countKeys</span>(<span class="hljs-params">schema</span>) </span>{
  <span class="hljs-keyword">var</span> count = <span class="hljs-number">0</span>, item;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(schema)) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;schema.length; i++) {
      item = schema[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item == <span class="hljs-string">'object'</span>) count += countKeys(item);
      <span class="hljs-keyword">if</span> (count == <span class="hljs-literal">Infinity</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">Infinity</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> schema) {
      <span class="hljs-keyword">if</span> (key == <span class="hljs-string">'$ref'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">Infinity</span>;
      <span class="hljs-keyword">if</span> (SIMPLE_INLINED[key]) {
        count++;
      } <span class="hljs-keyword">else</span> {
        item = schema[key];
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> item == <span class="hljs-string">'object'</span>) count += countKeys(item) + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (count == <span class="hljs-literal">Infinity</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">Infinity</span>;
      }
    }
  }
  <span class="hljs-keyword">return</span> count;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFullPath</span>(<span class="hljs-params">id, normalize</span>) </span>{
  <span class="hljs-keyword">if</span> (normalize !== <span class="hljs-literal">false</span>) id = normalizeId(id);
  <span class="hljs-keyword">var</span> p = URI.parse(id);
  <span class="hljs-keyword">return</span> _getFullPath(p);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getFullPath</span>(<span class="hljs-params">p</span>) </span>{
  <span class="hljs-keyword">return</span> URI.serialize(p).split(<span class="hljs-string">'#'</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">'#'</span>;
}


<span class="hljs-keyword">var</span> TRAILING_SLASH_HASH = <span class="hljs-regexp">/#\/?$/</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalizeId</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">return</span> id ? id.replace(TRAILING_SLASH_HASH, <span class="hljs-string">''</span>) : <span class="hljs-string">''</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveUrl</span>(<span class="hljs-params">baseId, id</span>) </span>{
  id = normalizeId(id);
  <span class="hljs-keyword">return</span> URI.resolve(baseId, id);
}


<span class="hljs-comment">/* @this Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveIds</span>(<span class="hljs-params">schema</span>) </span>{
  <span class="hljs-keyword">var</span> schemaId = normalizeId(<span class="hljs-keyword">this</span>._getId(schema));
  <span class="hljs-keyword">var</span> baseIds = {<span class="hljs-string">''</span>: schemaId};
  <span class="hljs-keyword">var</span> fullPaths = {<span class="hljs-string">''</span>: getFullPath(schemaId, <span class="hljs-literal">false</span>)};
  <span class="hljs-keyword">var</span> localRefs = {};
  <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;

  traverse(schema, {<span class="hljs-attr">allKeys</span>: <span class="hljs-literal">true</span>}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sch, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex</span>) </span>{
    <span class="hljs-keyword">if</span> (jsonPtr === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">var</span> id = self._getId(sch);
    <span class="hljs-keyword">var</span> baseId = baseIds[parentJsonPtr];
    <span class="hljs-keyword">var</span> fullPath = fullPaths[parentJsonPtr] + <span class="hljs-string">'/'</span> + parentKeyword;
    <span class="hljs-keyword">if</span> (keyIndex !== <span class="hljs-literal">undefined</span>)
      fullPath += <span class="hljs-string">'/'</span> + (<span class="hljs-keyword">typeof</span> keyIndex == <span class="hljs-string">'number'</span> ? keyIndex : util.escapeFragment(keyIndex));

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> id == <span class="hljs-string">'string'</span>) {
      id = baseId = normalizeId(baseId ? URI.resolve(baseId, id) : id);

      <span class="hljs-keyword">var</span> refVal = self._refs[id];
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> refVal == <span class="hljs-string">'string'</span>) refVal = self._refs[refVal];
      <span class="hljs-keyword">if</span> (refVal &amp;&amp; refVal.schema) {
        <span class="hljs-keyword">if</span> (!equal(sch, refVal.schema))
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'id "'</span> + id + <span class="hljs-string">'" resolves to more than one schema'</span>);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (id != normalizeId(fullPath)) {
        <span class="hljs-keyword">if</span> (id[<span class="hljs-number">0</span>] == <span class="hljs-string">'#'</span>) {
          <span class="hljs-keyword">if</span> (localRefs[id] &amp;&amp; !equal(sch, localRefs[id]))
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'id "'</span> + id + <span class="hljs-string">'" resolves to more than one schema'</span>);
          localRefs[id] = sch;
        } <span class="hljs-keyword">else</span> {
          self._refs[id] = fullPath;
        }
      }
    }
    baseIds[jsonPtr] = baseId;
    fullPaths[jsonPtr] = fullPath;
  });

  <span class="hljs-keyword">return</span> localRefs;
}

},{<span class="hljs-string">"./schema_obj"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"./util"</span>:<span class="hljs-number">10</span>,<span class="hljs-string">"fast-deep-equal"</span>:<span class="hljs-number">42</span>,<span class="hljs-string">"json-schema-traverse"</span>:<span class="hljs-number">44</span>,<span class="hljs-string">"uri-js"</span>:<span class="hljs-number">45</span>}],<span class="hljs-number">7</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> ruleModules = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../dotjs'</span>)
  , toHash = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./util'</span>).toHash;

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rules</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> RULES = [
    { <span class="hljs-attr">type</span>: <span class="hljs-string">'number'</span>,
      <span class="hljs-attr">rules</span>: [ { <span class="hljs-string">'maximum'</span>: [<span class="hljs-string">'exclusiveMaximum'</span>] },
               { <span class="hljs-string">'minimum'</span>: [<span class="hljs-string">'exclusiveMinimum'</span>] }, <span class="hljs-string">'multipleOf'</span>, <span class="hljs-string">'format'</span>] },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>,
      <span class="hljs-attr">rules</span>: [ <span class="hljs-string">'maxLength'</span>, <span class="hljs-string">'minLength'</span>, <span class="hljs-string">'pattern'</span>, <span class="hljs-string">'format'</span> ] },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">'array'</span>,
      <span class="hljs-attr">rules</span>: [ <span class="hljs-string">'maxItems'</span>, <span class="hljs-string">'minItems'</span>, <span class="hljs-string">'items'</span>, <span class="hljs-string">'contains'</span>, <span class="hljs-string">'uniqueItems'</span> ] },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,
      <span class="hljs-attr">rules</span>: [ <span class="hljs-string">'maxProperties'</span>, <span class="hljs-string">'minProperties'</span>, <span class="hljs-string">'required'</span>, <span class="hljs-string">'dependencies'</span>, <span class="hljs-string">'propertyNames'</span>,
               { <span class="hljs-string">'properties'</span>: [<span class="hljs-string">'additionalProperties'</span>, <span class="hljs-string">'patternProperties'</span>] } ] },
    { <span class="hljs-attr">rules</span>: [ <span class="hljs-string">'$ref'</span>, <span class="hljs-string">'const'</span>, <span class="hljs-string">'enum'</span>, <span class="hljs-string">'not'</span>, <span class="hljs-string">'anyOf'</span>, <span class="hljs-string">'oneOf'</span>, <span class="hljs-string">'allOf'</span>, <span class="hljs-string">'if'</span> ] }
  ];

  <span class="hljs-keyword">var</span> ALL = [ <span class="hljs-string">'type'</span>, <span class="hljs-string">'$comment'</span> ];
  <span class="hljs-keyword">var</span> KEYWORDS = [
    <span class="hljs-string">'$schema'</span>, <span class="hljs-string">'$id'</span>, <span class="hljs-string">'id'</span>, <span class="hljs-string">'$data'</span>, <span class="hljs-string">'$async'</span>, <span class="hljs-string">'title'</span>,
    <span class="hljs-string">'description'</span>, <span class="hljs-string">'default'</span>, <span class="hljs-string">'definitions'</span>,
    <span class="hljs-string">'examples'</span>, <span class="hljs-string">'readOnly'</span>, <span class="hljs-string">'writeOnly'</span>,
    <span class="hljs-string">'contentMediaType'</span>, <span class="hljs-string">'contentEncoding'</span>,
    <span class="hljs-string">'additionalItems'</span>, <span class="hljs-string">'then'</span>, <span class="hljs-string">'else'</span>
  ];
  <span class="hljs-keyword">var</span> TYPES = [ <span class="hljs-string">'number'</span>, <span class="hljs-string">'integer'</span>, <span class="hljs-string">'string'</span>, <span class="hljs-string">'array'</span>, <span class="hljs-string">'object'</span>, <span class="hljs-string">'boolean'</span>, <span class="hljs-string">'null'</span> ];
  RULES.all = toHash(ALL);
  RULES.types = toHash(TYPES);

  RULES.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">group</span>) </span>{
    group.rules = group.rules.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">keyword</span>) </span>{
      <span class="hljs-keyword">var</span> implKeywords;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> keyword == <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">var</span> key = <span class="hljs-built_in">Object</span>.keys(keyword)[<span class="hljs-number">0</span>];
        implKeywords = keyword[key];
        keyword = key;
        implKeywords.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">k</span>) </span>{
          ALL.push(k);
          RULES.all[k] = <span class="hljs-literal">true</span>;
        });
      }
      ALL.push(keyword);
      <span class="hljs-keyword">var</span> rule = RULES.all[keyword] = {
        <span class="hljs-attr">keyword</span>: keyword,
        <span class="hljs-attr">code</span>: ruleModules[keyword],
        <span class="hljs-attr">implements</span>: implKeywords
      };
      <span class="hljs-keyword">return</span> rule;
    });

    RULES.all.$comment = {
      <span class="hljs-attr">keyword</span>: <span class="hljs-string">'$comment'</span>,
      <span class="hljs-attr">code</span>: ruleModules.$comment
    };

    <span class="hljs-keyword">if</span> (group.type) RULES.types[group.type] = group;
  });

  RULES.keywords = toHash(ALL.concat(KEYWORDS));
  RULES.custom = {};

  <span class="hljs-keyword">return</span> RULES;
};

},{<span class="hljs-string">"../dotjs"</span>:<span class="hljs-number">27</span>,<span class="hljs-string">"./util"</span>:<span class="hljs-number">10</span>}],<span class="hljs-number">8</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./util'</span>);

<span class="hljs-built_in">module</span>.exports = SchemaObject;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SchemaObject</span>(<span class="hljs-params">obj</span>) </span>{
  util.copy(obj, <span class="hljs-keyword">this</span>);
}

},{<span class="hljs-string">"./util"</span>:<span class="hljs-number">10</span>}],<span class="hljs-number">9</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27"></a>
</div>
<p>https://mathiasbynens.be/notes/javascript-encoding
https://github.com/bestiejs/punycode.js - punycode.ucs2.decode</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2length</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">var</span> length = <span class="hljs-number">0</span>
    , len = str.length
    , pos = <span class="hljs-number">0</span>
    , value;
  <span class="hljs-keyword">while</span> (pos &lt; len) {
    length++;
    value = str.charCodeAt(pos++);
    <span class="hljs-keyword">if</span> (value &gt;= <span class="hljs-number">0xD800</span> &amp;&amp; value &lt;= <span class="hljs-number">0xDBFF</span> &amp;&amp; pos &lt; len) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-28" id="section-28"></a>
</div>
<p>high surrogate, and there is a next character</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">      value = str.charCodeAt(pos);
      <span class="hljs-keyword">if</span> ((value &amp; <span class="hljs-number">0xFC00</span>) == <span class="hljs-number">0xDC00</span>) pos++; <span class="hljs-comment">// low surrogate</span>
    }
  }
  <span class="hljs-keyword">return</span> length;
};

},{}],<span class="hljs-number">10</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;


<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">copy</span>: copy,
  <span class="hljs-attr">checkDataType</span>: checkDataType,
  <span class="hljs-attr">checkDataTypes</span>: checkDataTypes,
  <span class="hljs-attr">coerceToTypes</span>: coerceToTypes,
  <span class="hljs-attr">toHash</span>: toHash,
  <span class="hljs-attr">getProperty</span>: getProperty,
  <span class="hljs-attr">escapeQuotes</span>: escapeQuotes,
  <span class="hljs-attr">equal</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-deep-equal'</span>),
  <span class="hljs-attr">ucs2length</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./ucs2length'</span>),
  <span class="hljs-attr">varOccurences</span>: varOccurences,
  <span class="hljs-attr">varReplace</span>: varReplace,
  <span class="hljs-attr">schemaHasRules</span>: schemaHasRules,
  <span class="hljs-attr">schemaHasRulesExcept</span>: schemaHasRulesExcept,
  <span class="hljs-attr">schemaUnknownRules</span>: schemaUnknownRules,
  <span class="hljs-attr">toQuotedString</span>: toQuotedString,
  <span class="hljs-attr">getPathExpr</span>: getPathExpr,
  <span class="hljs-attr">getPath</span>: getPath,
  <span class="hljs-attr">getData</span>: getData,
  <span class="hljs-attr">unescapeFragment</span>: unescapeFragment,
  <span class="hljs-attr">unescapeJsonPointer</span>: unescapeJsonPointer,
  <span class="hljs-attr">escapeFragment</span>: escapeFragment,
  <span class="hljs-attr">escapeJsonPointer</span>: escapeJsonPointer
};


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">copy</span>(<span class="hljs-params">o, to</span>) </span>{
  to = to || {};
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> o) to[key] = o[key];
  <span class="hljs-keyword">return</span> to;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkDataType</span>(<span class="hljs-params">dataType, data, strictNumbers, negate</span>) </span>{
  <span class="hljs-keyword">var</span> EQUAL = negate ? <span class="hljs-string">' !== '</span> : <span class="hljs-string">' === '</span>
    , AND = negate ? <span class="hljs-string">' || '</span> : <span class="hljs-string">' &amp;&amp; '</span>
    , OK = negate ? <span class="hljs-string">'!'</span> : <span class="hljs-string">''</span>
    , NOT = negate ? <span class="hljs-string">''</span> : <span class="hljs-string">'!'</span>;
  <span class="hljs-keyword">switch</span> (dataType) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'null'</span>: <span class="hljs-keyword">return</span> data + EQUAL + <span class="hljs-string">'null'</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'array'</span>: <span class="hljs-keyword">return</span> OK + <span class="hljs-string">'Array.isArray('</span> + data + <span class="hljs-string">')'</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">'('</span> + OK + data + AND +
                          <span class="hljs-string">'typeof '</span> + data + EQUAL + <span class="hljs-string">'"object"'</span> + AND +
                          NOT + <span class="hljs-string">'Array.isArray('</span> + data + <span class="hljs-string">'))'</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'integer'</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">'(typeof '</span> + data + EQUAL + <span class="hljs-string">'"number"'</span> + AND +
                           NOT + <span class="hljs-string">'('</span> + data + <span class="hljs-string">' % 1)'</span> +
                           AND + data + EQUAL + data +
                           (strictNumbers ? (AND + OK + <span class="hljs-string">'isFinite('</span> + data + <span class="hljs-string">')'</span>) : <span class="hljs-string">''</span>) + <span class="hljs-string">')'</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'number'</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">'(typeof '</span> + data + EQUAL + <span class="hljs-string">'"'</span> + dataType + <span class="hljs-string">'"'</span> +
                          (strictNumbers ? (AND + OK + <span class="hljs-string">'isFinite('</span> + data + <span class="hljs-string">')'</span>) : <span class="hljs-string">''</span>) + <span class="hljs-string">')'</span>;
    <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-string">'typeof '</span> + data + EQUAL + <span class="hljs-string">'"'</span> + dataType + <span class="hljs-string">'"'</span>;
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkDataTypes</span>(<span class="hljs-params">dataTypes, data, strictNumbers</span>) </span>{
  <span class="hljs-keyword">switch</span> (dataTypes.length) {
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-keyword">return</span> checkDataType(dataTypes[<span class="hljs-number">0</span>], data, strictNumbers, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">var</span> code = <span class="hljs-string">''</span>;
      <span class="hljs-keyword">var</span> types = toHash(dataTypes);
      <span class="hljs-keyword">if</span> (types.array &amp;&amp; types.object) {
        code = types.null ? <span class="hljs-string">'('</span>: <span class="hljs-string">'(!'</span> + data + <span class="hljs-string">' || '</span>;
        code += <span class="hljs-string">'typeof '</span> + data + <span class="hljs-string">' !== "object")'</span>;
        <span class="hljs-keyword">delete</span> types.null;
        <span class="hljs-keyword">delete</span> types.array;
        <span class="hljs-keyword">delete</span> types.object;
      }
      <span class="hljs-keyword">if</span> (types.number) <span class="hljs-keyword">delete</span> types.integer;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> t <span class="hljs-keyword">in</span> types)
        code += (code ? <span class="hljs-string">' &amp;&amp; '</span> : <span class="hljs-string">''</span> ) + checkDataType(t, data, strictNumbers, <span class="hljs-literal">true</span>);

      <span class="hljs-keyword">return</span> code;
  }
}


<span class="hljs-keyword">var</span> COERCE_TO_TYPES = toHash([ <span class="hljs-string">'string'</span>, <span class="hljs-string">'number'</span>, <span class="hljs-string">'integer'</span>, <span class="hljs-string">'boolean'</span>, <span class="hljs-string">'null'</span> ]);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">coerceToTypes</span>(<span class="hljs-params">optionCoerceTypes, dataTypes</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(dataTypes)) {
    <span class="hljs-keyword">var</span> types = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;dataTypes.length; i++) {
      <span class="hljs-keyword">var</span> t = dataTypes[i];
      <span class="hljs-keyword">if</span> (COERCE_TO_TYPES[t]) types[types.length] = t;
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (optionCoerceTypes === <span class="hljs-string">'array'</span> &amp;&amp; t === <span class="hljs-string">'array'</span>) types[types.length] = t;
    }
    <span class="hljs-keyword">if</span> (types.length) <span class="hljs-keyword">return</span> types;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (COERCE_TO_TYPES[dataTypes]) {
    <span class="hljs-keyword">return</span> [dataTypes];
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (optionCoerceTypes === <span class="hljs-string">'array'</span> &amp;&amp; dataTypes === <span class="hljs-string">'array'</span>) {
    <span class="hljs-keyword">return</span> [<span class="hljs-string">'array'</span>];
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toHash</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-keyword">var</span> hash = {};
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;arr.length; i++) hash[arr[i]] = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> hash;
}


<span class="hljs-keyword">var</span> IDENTIFIER = <span class="hljs-regexp">/^[a-z$_][a-z$_0-9]*$/i</span>;
<span class="hljs-keyword">var</span> SINGLE_QUOTE = <span class="hljs-regexp">/'|\\/g</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getProperty</span>(<span class="hljs-params">key</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> key == <span class="hljs-string">'number'</span>
          ? <span class="hljs-string">'['</span> + key + <span class="hljs-string">']'</span>
          : IDENTIFIER.test(key)
            ? <span class="hljs-string">'.'</span> + key
            : <span class="hljs-string">"['"</span> + escapeQuotes(key) + <span class="hljs-string">"']"</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeQuotes</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> str.replace(SINGLE_QUOTE, <span class="hljs-string">'\\$&amp;'</span>)
            .replace(<span class="hljs-regexp">/\n/g</span>, <span class="hljs-string">'\\n'</span>)
            .replace(<span class="hljs-regexp">/\r/g</span>, <span class="hljs-string">'\\r'</span>)
            .replace(<span class="hljs-regexp">/\f/g</span>, <span class="hljs-string">'\\f'</span>)
            .replace(<span class="hljs-regexp">/\t/g</span>, <span class="hljs-string">'\\t'</span>);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">varOccurences</span>(<span class="hljs-params">str, dataVar</span>) </span>{
  dataVar += <span class="hljs-string">'[^0-9]'</span>;
  <span class="hljs-keyword">var</span> matches = str.match(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(dataVar, <span class="hljs-string">'g'</span>));
  <span class="hljs-keyword">return</span> matches ? matches.length : <span class="hljs-number">0</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">varReplace</span>(<span class="hljs-params">str, dataVar, expr</span>) </span>{
  dataVar += <span class="hljs-string">'([^0-9])'</span>;
  expr = expr.replace(<span class="hljs-regexp">/\$/g</span>, <span class="hljs-string">'$$$$'</span>);
  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(dataVar, <span class="hljs-string">'g'</span>), expr + <span class="hljs-string">'$1'</span>);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">schemaHasRules</span>(<span class="hljs-params">schema, rules</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> schema == <span class="hljs-string">'boolean'</span>) <span class="hljs-keyword">return</span> !schema;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> schema) <span class="hljs-keyword">if</span> (rules[key]) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">schemaHasRulesExcept</span>(<span class="hljs-params">schema, rules, exceptKeyword</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> schema == <span class="hljs-string">'boolean'</span>) <span class="hljs-keyword">return</span> !schema &amp;&amp; exceptKeyword != <span class="hljs-string">'not'</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> schema) <span class="hljs-keyword">if</span> (key != exceptKeyword &amp;&amp; rules[key]) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">schemaUnknownRules</span>(<span class="hljs-params">schema, rules</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> schema == <span class="hljs-string">'boolean'</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> schema) <span class="hljs-keyword">if</span> (!rules[key]) <span class="hljs-keyword">return</span> key;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toQuotedString</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">'\''</span> + escapeQuotes(str) + <span class="hljs-string">'\''</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPathExpr</span>(<span class="hljs-params">currentPath, expr, jsonPointers, isNumber</span>) </span>{
  <span class="hljs-keyword">var</span> path = jsonPointers <span class="hljs-comment">// false by default</span>
              ? <span class="hljs-string">'\'/\' + '</span> + expr + (isNumber ? <span class="hljs-string">''</span> : <span class="hljs-string">'.replace(/~/g, \'~0\').replace(/\\//g, \'~1\')'</span>)
              : (isNumber ? <span class="hljs-string">'\'[\' + '</span> + expr + <span class="hljs-string">' + \']\''</span> : <span class="hljs-string">'\'[\\\'\' + '</span> + expr + <span class="hljs-string">' + \'\\\']\''</span>);
  <span class="hljs-keyword">return</span> joinPaths(currentPath, path);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPath</span>(<span class="hljs-params">currentPath, prop, jsonPointers</span>) </span>{
  <span class="hljs-keyword">var</span> path = jsonPointers <span class="hljs-comment">// false by default</span>
              ? toQuotedString(<span class="hljs-string">'/'</span> + escapeJsonPointer(prop))
              : toQuotedString(getProperty(prop));
  <span class="hljs-keyword">return</span> joinPaths(currentPath, path);
}


<span class="hljs-keyword">var</span> JSON_POINTER = <span class="hljs-regexp">/^\/(?:[^~]|~0|~1)*$/</span>;
<span class="hljs-keyword">var</span> RELATIVE_JSON_POINTER = <span class="hljs-regexp">/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params">$data, lvl, paths</span>) </span>{
  <span class="hljs-keyword">var</span> up, jsonPointer, data, matches;
  <span class="hljs-keyword">if</span> ($data === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'rootData'</span>;
  <span class="hljs-keyword">if</span> ($data[<span class="hljs-number">0</span>] == <span class="hljs-string">'/'</span>) {
    <span class="hljs-keyword">if</span> (!JSON_POINTER.test($data)) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid JSON-pointer: '</span> + $data);
    jsonPointer = $data;
    data = <span class="hljs-string">'rootData'</span>;
  } <span class="hljs-keyword">else</span> {
    matches = $data.match(RELATIVE_JSON_POINTER);
    <span class="hljs-keyword">if</span> (!matches) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid JSON-pointer: '</span> + $data);
    up = +matches[<span class="hljs-number">1</span>];
    jsonPointer = matches[<span class="hljs-number">2</span>];
    <span class="hljs-keyword">if</span> (jsonPointer == <span class="hljs-string">'#'</span>) {
      <span class="hljs-keyword">if</span> (up &gt;= lvl) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Cannot access property/index '</span> + up + <span class="hljs-string">' levels up, current level is '</span> + lvl);
      <span class="hljs-keyword">return</span> paths[lvl - up];
    }

    <span class="hljs-keyword">if</span> (up &gt; lvl) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Cannot access data '</span> + up + <span class="hljs-string">' levels up, current level is '</span> + lvl);
    data = <span class="hljs-string">'data'</span> + ((lvl - up) || <span class="hljs-string">''</span>);
    <span class="hljs-keyword">if</span> (!jsonPointer) <span class="hljs-keyword">return</span> data;
  }

  <span class="hljs-keyword">var</span> expr = data;
  <span class="hljs-keyword">var</span> segments = jsonPointer.split(<span class="hljs-string">'/'</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;segments.length; i++) {
    <span class="hljs-keyword">var</span> segment = segments[i];
    <span class="hljs-keyword">if</span> (segment) {
      data += getProperty(unescapeJsonPointer(segment));
      expr += <span class="hljs-string">' &amp;&amp; '</span> + data;
    }
  }
  <span class="hljs-keyword">return</span> expr;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">joinPaths</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">if</span> (a == <span class="hljs-string">'""'</span>) <span class="hljs-keyword">return</span> b;
  <span class="hljs-keyword">return</span> (a + <span class="hljs-string">' + '</span> + b).replace(<span class="hljs-regexp">/([^\\])' \+ '/g</span>, <span class="hljs-string">'$1'</span>);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unescapeFragment</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> unescapeJsonPointer(<span class="hljs-built_in">decodeURIComponent</span>(str));
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeFragment</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">encodeURIComponent</span>(escapeJsonPointer(str));
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeJsonPointer</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/~/g</span>, <span class="hljs-string">'~0'</span>).replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">'~1'</span>);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unescapeJsonPointer</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/~1/g</span>, <span class="hljs-string">'/'</span>).replace(<span class="hljs-regexp">/~0/g</span>, <span class="hljs-string">'~'</span>);
}

},{<span class="hljs-string">"./ucs2length"</span>:<span class="hljs-number">9</span>,<span class="hljs-string">"fast-deep-equal"</span>:<span class="hljs-number">42</span>}],<span class="hljs-number">11</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> KEYWORDS = [
  <span class="hljs-string">'multipleOf'</span>,
  <span class="hljs-string">'maximum'</span>,
  <span class="hljs-string">'exclusiveMaximum'</span>,
  <span class="hljs-string">'minimum'</span>,
  <span class="hljs-string">'exclusiveMinimum'</span>,
  <span class="hljs-string">'maxLength'</span>,
  <span class="hljs-string">'minLength'</span>,
  <span class="hljs-string">'pattern'</span>,
  <span class="hljs-string">'additionalItems'</span>,
  <span class="hljs-string">'maxItems'</span>,
  <span class="hljs-string">'minItems'</span>,
  <span class="hljs-string">'uniqueItems'</span>,
  <span class="hljs-string">'maxProperties'</span>,
  <span class="hljs-string">'minProperties'</span>,
  <span class="hljs-string">'required'</span>,
  <span class="hljs-string">'additionalProperties'</span>,
  <span class="hljs-string">'enum'</span>,
  <span class="hljs-string">'format'</span>,
  <span class="hljs-string">'const'</span>
];

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">metaSchema, keywordsJsonPointers</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;keywordsJsonPointers.length; i++) {
    metaSchema = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(metaSchema));
    <span class="hljs-keyword">var</span> segments = keywordsJsonPointers[i].split(<span class="hljs-string">'/'</span>);
    <span class="hljs-keyword">var</span> keywords = metaSchema;
    <span class="hljs-keyword">var</span> j;
    <span class="hljs-keyword">for</span> (j=<span class="hljs-number">1</span>; j&lt;segments.length; j++)
      keywords = keywords[segments[j]];

    <span class="hljs-keyword">for</span> (j=<span class="hljs-number">0</span>; j&lt;KEYWORDS.length; j++) {
      <span class="hljs-keyword">var</span> key = KEYWORDS[j];
      <span class="hljs-keyword">var</span> schema = keywords[key];
      <span class="hljs-keyword">if</span> (schema) {
        keywords[key] = {
          <span class="hljs-attr">anyOf</span>: [
            schema,
            { <span class="hljs-attr">$ref</span>: <span class="hljs-string">'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#'</span> }
          ]
        };
      }
    }
  }

  <span class="hljs-keyword">return</span> metaSchema;
};

},{}],<span class="hljs-number">12</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> metaSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./refs/json-schema-draft-07.json'</span>);

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">$id</span>: <span class="hljs-string">'https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js'</span>,
  <span class="hljs-attr">definitions</span>: {
    <span class="hljs-attr">simpleTypes</span>: metaSchema.definitions.simpleTypes
  },
  <span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>,
  <span class="hljs-attr">dependencies</span>: {
    <span class="hljs-attr">schema</span>: [<span class="hljs-string">'validate'</span>],
    <span class="hljs-attr">$data</span>: [<span class="hljs-string">'validate'</span>],
    <span class="hljs-attr">statements</span>: [<span class="hljs-string">'inline'</span>],
    <span class="hljs-attr">valid</span>: {<span class="hljs-attr">not</span>: {<span class="hljs-attr">required</span>: [<span class="hljs-string">'macro'</span>]}}
  },
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-attr">type</span>: metaSchema.properties.type,
    <span class="hljs-attr">schema</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
    <span class="hljs-attr">statements</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
    <span class="hljs-attr">dependencies</span>: {
      <span class="hljs-attr">type</span>: <span class="hljs-string">'array'</span>,
      <span class="hljs-attr">items</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'string'</span>}
    },
    <span class="hljs-attr">metaSchema</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'object'</span>},
    <span class="hljs-attr">modifying</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
    <span class="hljs-attr">valid</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
    <span class="hljs-attr">$data</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
    <span class="hljs-attr">async</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
    <span class="hljs-attr">errors</span>: {
      <span class="hljs-attr">anyOf</span>: [
        {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>},
        {<span class="hljs-attr">const</span>: <span class="hljs-string">'full'</span>}
      ]
    }
  }
};

},{<span class="hljs-string">"./refs/json-schema-draft-07.json"</span>:<span class="hljs-number">41</span>}],<span class="hljs-number">13</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate__limit</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $errorKeyword;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">var</span> $isMax = $keyword == <span class="hljs-string">'maximum'</span>,
    $exclusiveKeyword = $isMax ? <span class="hljs-string">'exclusiveMaximum'</span> : <span class="hljs-string">'exclusiveMinimum'</span>,
    $schemaExcl = it.schema[$exclusiveKeyword],
    $isDataExcl = it.opts.$data &amp;&amp; $schemaExcl &amp;&amp; $schemaExcl.$data,
    $op = $isMax ? <span class="hljs-string">'&lt;'</span> : <span class="hljs-string">'&gt;'</span>,
    $notOp = $isMax ? <span class="hljs-string">'&gt;'</span> : <span class="hljs-string">'&lt;'</span>,
    $errorKeyword = <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">if</span> (!($isData || <span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'number'</span> || $schema === <span class="hljs-literal">undefined</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($keyword + <span class="hljs-string">' must be number'</span>);
  }
  <span class="hljs-keyword">if</span> (!($isDataExcl || $schemaExcl === <span class="hljs-literal">undefined</span> || <span class="hljs-keyword">typeof</span> $schemaExcl == <span class="hljs-string">'number'</span> || <span class="hljs-keyword">typeof</span> $schemaExcl == <span class="hljs-string">'boolean'</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($exclusiveKeyword + <span class="hljs-string">' must be number or boolean'</span>);
  }
  <span class="hljs-keyword">if</span> ($isDataExcl) {
    <span class="hljs-keyword">var</span> $schemaValueExcl = it.util.getData($schemaExcl.$data, $dataLvl, it.dataPathArr),
      $exclusive = <span class="hljs-string">'exclusive'</span> + $lvl,
      $exclType = <span class="hljs-string">'exclType'</span> + $lvl,
      $exclIsNumber = <span class="hljs-string">'exclIsNumber'</span> + $lvl,
      $opExpr = <span class="hljs-string">'op'</span> + $lvl,
      $opStr = <span class="hljs-string">'\' + '</span> + $opExpr + <span class="hljs-string">' + \''</span>;
    out += <span class="hljs-string">' var schemaExcl'</span> + ($lvl) + <span class="hljs-string">' = '</span> + ($schemaValueExcl) + <span class="hljs-string">'; '</span>;
    $schemaValueExcl = <span class="hljs-string">'schemaExcl'</span> + $lvl;
    out += <span class="hljs-string">' var '</span> + ($exclusive) + <span class="hljs-string">'; var '</span> + ($exclType) + <span class="hljs-string">' = typeof '</span> + ($schemaValueExcl) + <span class="hljs-string">'; if ('</span> + ($exclType) + <span class="hljs-string">' != \'boolean\' &amp;&amp; '</span> + ($exclType) + <span class="hljs-string">' != \'undefined\' &amp;&amp; '</span> + ($exclType) + <span class="hljs-string">' != \'number\') { '</span>;
    <span class="hljs-keyword">var</span> $errorKeyword = $exclusiveKeyword;
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'_exclusiveLimit'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: {} '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \''</span> + ($exclusiveKeyword) + <span class="hljs-string">' should be boolean\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    <span class="hljs-keyword">var</span> __err = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    }
    out += <span class="hljs-string">' } else if ( '</span>;
    <span class="hljs-keyword">if</span> ($isData) {
      out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\') || '</span>;
    }
    out += <span class="hljs-string">' '</span> + ($exclType) + <span class="hljs-string">' == \'number\' ? ( ('</span> + ($exclusive) + <span class="hljs-string">' = '</span> + ($schemaValue) + <span class="hljs-string">' === undefined || '</span> + ($schemaValueExcl) + <span class="hljs-string">' '</span> + ($op) + <span class="hljs-string">'= '</span> + ($schemaValue) + <span class="hljs-string">') ? '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">'= '</span> + ($schemaValueExcl) + <span class="hljs-string">' : '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">' ) : ( ('</span> + ($exclusive) + <span class="hljs-string">' = '</span> + ($schemaValueExcl) + <span class="hljs-string">' === true) ? '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">'= '</span> + ($schemaValue) + <span class="hljs-string">' : '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">' ) || '</span> + ($data) + <span class="hljs-string">' !== '</span> + ($data) + <span class="hljs-string">') { var op'</span> + ($lvl) + <span class="hljs-string">' = '</span> + ($exclusive) + <span class="hljs-string">' ? \''</span> + ($op) + <span class="hljs-string">'\' : \''</span> + ($op) + <span class="hljs-string">'=\'; '</span>;
    <span class="hljs-keyword">if</span> ($schema === <span class="hljs-literal">undefined</span>) {
      $errorKeyword = $exclusiveKeyword;
      $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $exclusiveKeyword;
      $schemaValue = $schemaValueExcl;
      $isData = $isDataExcl;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> $exclIsNumber = <span class="hljs-keyword">typeof</span> $schemaExcl == <span class="hljs-string">'number'</span>,
      $opStr = $op;
    <span class="hljs-keyword">if</span> ($exclIsNumber &amp;&amp; $isData) {
      <span class="hljs-keyword">var</span> $opExpr = <span class="hljs-string">'\''</span> + $opStr + <span class="hljs-string">'\''</span>;
      out += <span class="hljs-string">' if ( '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\') || '</span>;
      }
      out += <span class="hljs-string">' ( '</span> + ($schemaValue) + <span class="hljs-string">' === undefined || '</span> + ($schemaExcl) + <span class="hljs-string">' '</span> + ($op) + <span class="hljs-string">'= '</span> + ($schemaValue) + <span class="hljs-string">' ? '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">'= '</span> + ($schemaExcl) + <span class="hljs-string">' : '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">' ) || '</span> + ($data) + <span class="hljs-string">' !== '</span> + ($data) + <span class="hljs-string">') { '</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> ($exclIsNumber &amp;&amp; $schema === <span class="hljs-literal">undefined</span>) {
        $exclusive = <span class="hljs-literal">true</span>;
        $errorKeyword = $exclusiveKeyword;
        $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $exclusiveKeyword;
        $schemaValue = $schemaExcl;
        $notOp += <span class="hljs-string">'='</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> ($exclIsNumber) $schemaValue = <span class="hljs-built_in">Math</span>[$isMax ? <span class="hljs-string">'min'</span> : <span class="hljs-string">'max'</span>]($schemaExcl, $schema);
        <span class="hljs-keyword">if</span> ($schemaExcl === ($exclIsNumber ? $schemaValue : <span class="hljs-literal">true</span>)) {
          $exclusive = <span class="hljs-literal">true</span>;
          $errorKeyword = $exclusiveKeyword;
          $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $exclusiveKeyword;
          $notOp += <span class="hljs-string">'='</span>;
        } <span class="hljs-keyword">else</span> {
          $exclusive = <span class="hljs-literal">false</span>;
          $opStr += <span class="hljs-string">'='</span>;
        }
      }
      <span class="hljs-keyword">var</span> $opExpr = <span class="hljs-string">'\''</span> + $opStr + <span class="hljs-string">'\''</span>;
      out += <span class="hljs-string">' if ( '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\') || '</span>;
      }
      out += <span class="hljs-string">' '</span> + ($data) + <span class="hljs-string">' '</span> + ($notOp) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">' || '</span> + ($data) + <span class="hljs-string">' !== '</span> + ($data) + <span class="hljs-string">') { '</span>;
    }
  }
  $errorKeyword = $errorKeyword || $keyword;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'_limit'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { comparison: '</span> + ($opExpr) + <span class="hljs-string">', limit: '</span> + ($schemaValue) + <span class="hljs-string">', exclusive: '</span> + ($exclusive) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should be '</span> + ($opStr) + <span class="hljs-string">' '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schemaValue) + <span class="hljs-string">'\''</span>;
      }
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">' } '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">14</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate__limitItems</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $errorKeyword;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">if</span> (!($isData || <span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'number'</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($keyword + <span class="hljs-string">' must be number'</span>);
  }
  <span class="hljs-keyword">var</span> $op = $keyword == <span class="hljs-string">'maxItems'</span> ? <span class="hljs-string">'&gt;'</span> : <span class="hljs-string">'&lt;'</span>;
  out += <span class="hljs-string">'if ( '</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\') || '</span>;
  }
  out += <span class="hljs-string">' '</span> + ($data) + <span class="hljs-string">'.length '</span> + ($op) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">') { '</span>;
  <span class="hljs-keyword">var</span> $errorKeyword = $keyword;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'_limitItems'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { limit: '</span> + ($schemaValue) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should NOT have '</span>;
      <span class="hljs-keyword">if</span> ($keyword == <span class="hljs-string">'maxItems'</span>) {
        out += <span class="hljs-string">'more'</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">'fewer'</span>;
      }
      out += <span class="hljs-string">' than '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue) + <span class="hljs-string">' + \''</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">' items\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">'} '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">15</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate__limitLength</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $errorKeyword;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">if</span> (!($isData || <span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'number'</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($keyword + <span class="hljs-string">' must be number'</span>);
  }
  <span class="hljs-keyword">var</span> $op = $keyword == <span class="hljs-string">'maxLength'</span> ? <span class="hljs-string">'&gt;'</span> : <span class="hljs-string">'&lt;'</span>;
  out += <span class="hljs-string">'if ( '</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\') || '</span>;
  }
  <span class="hljs-keyword">if</span> (it.opts.unicode === <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' '</span> + ($data) + <span class="hljs-string">'.length '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' ucs2length('</span> + ($data) + <span class="hljs-string">') '</span>;
  }
  out += <span class="hljs-string">' '</span> + ($op) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">') { '</span>;
  <span class="hljs-keyword">var</span> $errorKeyword = $keyword;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'_limitLength'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { limit: '</span> + ($schemaValue) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should NOT be '</span>;
      <span class="hljs-keyword">if</span> ($keyword == <span class="hljs-string">'maxLength'</span>) {
        out += <span class="hljs-string">'longer'</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">'shorter'</span>;
      }
      out += <span class="hljs-string">' than '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue) + <span class="hljs-string">' + \''</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">' characters\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">'} '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">16</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate__limitProperties</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $errorKeyword;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">if</span> (!($isData || <span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'number'</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($keyword + <span class="hljs-string">' must be number'</span>);
  }
  <span class="hljs-keyword">var</span> $op = $keyword == <span class="hljs-string">'maxProperties'</span> ? <span class="hljs-string">'&gt;'</span> : <span class="hljs-string">'&lt;'</span>;
  out += <span class="hljs-string">'if ( '</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\') || '</span>;
  }
  out += <span class="hljs-string">' Object.keys('</span> + ($data) + <span class="hljs-string">').length '</span> + ($op) + <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">') { '</span>;
  <span class="hljs-keyword">var</span> $errorKeyword = $keyword;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'_limitProperties'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { limit: '</span> + ($schemaValue) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should NOT have '</span>;
      <span class="hljs-keyword">if</span> ($keyword == <span class="hljs-string">'maxProperties'</span>) {
        out += <span class="hljs-string">'more'</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">'fewer'</span>;
      }
      out += <span class="hljs-string">' than '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue) + <span class="hljs-string">' + \''</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">' properties\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">'} '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">17</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_allOf</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $currentBaseId = $it.baseId,
    $allSchemasEmpty = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> arr1 = $schema;
  <span class="hljs-keyword">if</span> (arr1) {
    <span class="hljs-keyword">var</span> $sch, $i = <span class="hljs-number">-1</span>,
      l1 = arr1.length - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> ($i &lt; l1) {
      $sch = arr1[$i += <span class="hljs-number">1</span>];
      <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all))) {
        $allSchemasEmpty = <span class="hljs-literal">false</span>;
        $it.schema = $sch;
        $it.schemaPath = $schemaPath + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>;
        $it.errSchemaPath = $errSchemaPath + <span class="hljs-string">'/'</span> + $i;
        out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
        $it.baseId = $currentBaseId;
        <span class="hljs-keyword">if</span> ($breakOnError) {
          out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
          $closingBraces += <span class="hljs-string">'}'</span>;
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> ($breakOnError) {
    <span class="hljs-keyword">if</span> ($allSchemasEmpty) {
      out += <span class="hljs-string">' if (true) { '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' '</span> + ($closingBraces.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>)) + <span class="hljs-string">' '</span>;
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">18</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_anyOf</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $noEmptySchema = $schema.every(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">$sch</span>) </span>{
    <span class="hljs-keyword">return</span> (it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all));
  });
  <span class="hljs-keyword">if</span> ($noEmptySchema) {
    <span class="hljs-keyword">var</span> $currentBaseId = $it.baseId;
    out += <span class="hljs-string">' var '</span> + ($errs) + <span class="hljs-string">' = errors; var '</span> + ($valid) + <span class="hljs-string">' = false;  '</span>;
    <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
    it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> arr1 = $schema;
    <span class="hljs-keyword">if</span> (arr1) {
      <span class="hljs-keyword">var</span> $sch, $i = <span class="hljs-number">-1</span>,
        l1 = arr1.length - <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span> ($i &lt; l1) {
        $sch = arr1[$i += <span class="hljs-number">1</span>];
        $it.schema = $sch;
        $it.schemaPath = $schemaPath + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>;
        $it.errSchemaPath = $errSchemaPath + <span class="hljs-string">'/'</span> + $i;
        out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
        $it.baseId = $currentBaseId;
        out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($valid) + <span class="hljs-string">' || '</span> + ($nextValid) + <span class="hljs-string">'; if (!'</span> + ($valid) + <span class="hljs-string">') { '</span>;
        $closingBraces += <span class="hljs-string">'}'</span>;
      }
    }
    it.compositeRule = $it.compositeRule = $wasComposite;
    out += <span class="hljs-string">' '</span> + ($closingBraces) + <span class="hljs-string">' if (!'</span> + ($valid) + <span class="hljs-string">') {   var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'anyOf'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: {} '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'should match some schema in anyOf\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(vErrors); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = vErrors; return false; '</span>;
      }
    }
    out += <span class="hljs-string">' } else {  errors = '</span> + ($errs) + <span class="hljs-string">'; if (vErrors !== null) { if ('</span> + ($errs) + <span class="hljs-string">') vErrors.length = '</span> + ($errs) + <span class="hljs-string">'; else vErrors = null; } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.allErrors) {
      out += <span class="hljs-string">' } '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (true) { '</span>;
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">19</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_comment</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $comment = it.util.toQuotedString($schema);
  <span class="hljs-keyword">if</span> (it.opts.$comment === <span class="hljs-literal">true</span>) {
    out += <span class="hljs-string">' console.log('</span> + ($comment) + <span class="hljs-string">');'</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> it.opts.$comment == <span class="hljs-string">'function'</span>) {
    out += <span class="hljs-string">' self._opts.$comment('</span> + ($comment) + <span class="hljs-string">', '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">', validate.root.schema);'</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">20</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_const</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">if</span> (!$isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = validate.schema'</span> + ($schemaPath) + <span class="hljs-string">';'</span>;
  }
  out += <span class="hljs-string">'var '</span> + ($valid) + <span class="hljs-string">' = equal('</span> + ($data) + <span class="hljs-string">', schema'</span> + ($lvl) + <span class="hljs-string">'); if (!'</span> + ($valid) + <span class="hljs-string">') {   '</span>;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'const'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { allowedValue: schema'</span> + ($lvl) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should be equal to constant\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">' }'</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">21</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_contains</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $idx = <span class="hljs-string">'i'</span> + $lvl,
    $dataNxt = $it.dataLevel = it.dataLevel + <span class="hljs-number">1</span>,
    $nextData = <span class="hljs-string">'data'</span> + $dataNxt,
    $currentBaseId = it.baseId,
    $nonEmptySchema = (it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($schema).length &gt; <span class="hljs-number">0</span>) || $schema === <span class="hljs-literal">false</span> : it.util.schemaHasRules($schema, it.RULES.all));
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors;var '</span> + ($valid) + <span class="hljs-string">';'</span>;
  <span class="hljs-keyword">if</span> ($nonEmptySchema) {
    <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
    it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
    $it.schema = $schema;
    $it.schemaPath = $schemaPath;
    $it.errSchemaPath = $errSchemaPath;
    out += <span class="hljs-string">' var '</span> + ($nextValid) + <span class="hljs-string">' = false; for (var '</span> + ($idx) + <span class="hljs-string">' = 0; '</span> + ($idx) + <span class="hljs-string">' &lt; '</span> + ($data) + <span class="hljs-string">'.length; '</span> + ($idx) + <span class="hljs-string">'++) { '</span>;
    $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $idx + <span class="hljs-string">']'</span>;
    $it.dataPathArr[$dataNxt] = $idx;
    <span class="hljs-keyword">var</span> $code = it.validate($it);
    $it.baseId = $currentBaseId;
    <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
      out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') break; }  '</span>;
    it.compositeRule = $it.compositeRule = $wasComposite;
    out += <span class="hljs-string">' '</span> + ($closingBraces) + <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') {'</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' if ('</span> + ($data) + <span class="hljs-string">'.length == 0) {'</span>;
  }
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'contains'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: {} '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should contain a valid item\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">' } else { '</span>;
  <span class="hljs-keyword">if</span> ($nonEmptySchema) {
    out += <span class="hljs-string">'  errors = '</span> + ($errs) + <span class="hljs-string">'; if (vErrors !== null) { if ('</span> + ($errs) + <span class="hljs-string">') vErrors.length = '</span> + ($errs) + <span class="hljs-string">'; else vErrors = null; } '</span>;
  }
  <span class="hljs-keyword">if</span> (it.opts.allErrors) {
    out += <span class="hljs-string">' } '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">22</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_custom</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $errorKeyword;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">var</span> $rule = <span class="hljs-keyword">this</span>,
    $definition = <span class="hljs-string">'definition'</span> + $lvl,
    $rDef = $rule.definition,
    $closingBraces = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> $compile, $inline, $macro, $ruleValidate, $validateCode;
  <span class="hljs-keyword">if</span> ($isData &amp;&amp; $rDef.$data) {
    $validateCode = <span class="hljs-string">'keywordValidate'</span> + $lvl;
    <span class="hljs-keyword">var</span> $validateSchema = $rDef.validateSchema;
    out += <span class="hljs-string">' var '</span> + ($definition) + <span class="hljs-string">' = RULES.custom[\''</span> + ($keyword) + <span class="hljs-string">'\'].definition; var '</span> + ($validateCode) + <span class="hljs-string">' = '</span> + ($definition) + <span class="hljs-string">'.validate;'</span>;
  } <span class="hljs-keyword">else</span> {
    $ruleValidate = it.useCustomRule($rule, $schema, it.schema, it);
    <span class="hljs-keyword">if</span> (!$ruleValidate) <span class="hljs-keyword">return</span>;
    $schemaValue = <span class="hljs-string">'validate.schema'</span> + $schemaPath;
    $validateCode = $ruleValidate.code;
    $compile = $rDef.compile;
    $inline = $rDef.inline;
    $macro = $rDef.macro;
  }
  <span class="hljs-keyword">var</span> $ruleErrs = $validateCode + <span class="hljs-string">'.errors'</span>,
    $i = <span class="hljs-string">'i'</span> + $lvl,
    $ruleErr = <span class="hljs-string">'ruleErr'</span> + $lvl,
    $asyncKeyword = $rDef.async;
  <span class="hljs-keyword">if</span> ($asyncKeyword &amp;&amp; !it.async) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'async keyword in sync schema'</span>);
  <span class="hljs-keyword">if</span> (!($inline || $macro)) {
    out += <span class="hljs-string">''</span> + ($ruleErrs) + <span class="hljs-string">' = null;'</span>;
  }
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors;var '</span> + ($valid) + <span class="hljs-string">';'</span>;
  <span class="hljs-keyword">if</span> ($isData &amp;&amp; $rDef.$data) {
    $closingBraces += <span class="hljs-string">'}'</span>;
    out += <span class="hljs-string">' if ('</span> + ($schemaValue) + <span class="hljs-string">' === undefined) { '</span> + ($valid) + <span class="hljs-string">' = true; } else { '</span>;
    <span class="hljs-keyword">if</span> ($validateSchema) {
      $closingBraces += <span class="hljs-string">'}'</span>;
      out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($definition) + <span class="hljs-string">'.validateSchema('</span> + ($schemaValue) + <span class="hljs-string">'); if ('</span> + ($valid) + <span class="hljs-string">') { '</span>;
    }
  }
  <span class="hljs-keyword">if</span> ($inline) {
    <span class="hljs-keyword">if</span> ($rDef.statements) {
      out += <span class="hljs-string">' '</span> + ($ruleValidate.validate) + <span class="hljs-string">' '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($ruleValidate.validate) + <span class="hljs-string">'; '</span>;
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($macro) {
    <span class="hljs-keyword">var</span> $it = it.util.copy(it);
    <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
    $it.level++;
    <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
    $it.schema = $ruleValidate.validate;
    $it.schemaPath = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
    it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> $code = it.validate($it).replace(<span class="hljs-regexp">/validate\.schema/g</span>, $validateCode);
    it.compositeRule = $it.compositeRule = $wasComposite;
    out += <span class="hljs-string">' '</span> + ($code);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>;
    out += <span class="hljs-string">'  '</span> + ($validateCode) + <span class="hljs-string">'.call( '</span>;
    <span class="hljs-keyword">if</span> (it.opts.passContext) {
      out += <span class="hljs-string">'this'</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">'self'</span>;
    }
    <span class="hljs-keyword">if</span> ($compile || $rDef.schema === <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , '</span> + ($data) + <span class="hljs-string">' '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' , '</span> + ($schemaValue) + <span class="hljs-string">' , '</span> + ($data) + <span class="hljs-string">' , validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' , (dataPath || \'\')'</span>;
    <span class="hljs-keyword">if</span> (it.errorPath != <span class="hljs-string">'""'</span>) {
      out += <span class="hljs-string">' + '</span> + (it.errorPath);
    }
    <span class="hljs-keyword">var</span> $parentData = $dataLvl ? <span class="hljs-string">'data'</span> + (($dataLvl - <span class="hljs-number">1</span>) || <span class="hljs-string">''</span>) : <span class="hljs-string">'parentData'</span>,
      $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : <span class="hljs-string">'parentDataProperty'</span>;
    out += <span class="hljs-string">' , '</span> + ($parentData) + <span class="hljs-string">' , '</span> + ($parentDataProperty) + <span class="hljs-string">' , rootData )  '</span>;
    <span class="hljs-keyword">var</span> def_callRuleValidate = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> ($rDef.errors === <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span>;
      <span class="hljs-keyword">if</span> ($asyncKeyword) {
        out += <span class="hljs-string">'await '</span>;
      }
      out += <span class="hljs-string">''</span> + (def_callRuleValidate) + <span class="hljs-string">'; '</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> ($asyncKeyword) {
        $ruleErrs = <span class="hljs-string">'customErrors'</span> + $lvl;
        out += <span class="hljs-string">' var '</span> + ($ruleErrs) + <span class="hljs-string">' = null; try { '</span> + ($valid) + <span class="hljs-string">' = await '</span> + (def_callRuleValidate) + <span class="hljs-string">'; } catch (e) { '</span> + ($valid) + <span class="hljs-string">' = false; if (e instanceof ValidationError) '</span> + ($ruleErrs) + <span class="hljs-string">' = e.errors; else throw e; } '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' '</span> + ($ruleErrs) + <span class="hljs-string">' = null; '</span> + ($valid) + <span class="hljs-string">' = '</span> + (def_callRuleValidate) + <span class="hljs-string">'; '</span>;
      }
    }
  }
  <span class="hljs-keyword">if</span> ($rDef.modifying) {
    out += <span class="hljs-string">' if ('</span> + ($parentData) + <span class="hljs-string">') '</span> + ($data) + <span class="hljs-string">' = '</span> + ($parentData) + <span class="hljs-string">'['</span> + ($parentDataProperty) + <span class="hljs-string">'];'</span>;
  }
  out += <span class="hljs-string">''</span> + ($closingBraces);
  <span class="hljs-keyword">if</span> ($rDef.valid) {
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (true) { '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' if ( '</span>;
    <span class="hljs-keyword">if</span> ($rDef.valid === <span class="hljs-literal">undefined</span>) {
      out += <span class="hljs-string">' !'</span>;
      <span class="hljs-keyword">if</span> ($macro) {
        out += <span class="hljs-string">''</span> + ($nextValid);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($valid);
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' '</span> + (!$rDef.valid) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">') { '</span>;
    $errorKeyword = $rule.keyword;
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'custom'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { keyword: \''</span> + ($rule.keyword) + <span class="hljs-string">'\' } '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'should pass "'</span> + ($rule.keyword) + <span class="hljs-string">'" keyword validation\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    <span class="hljs-keyword">var</span> __err = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    }
    <span class="hljs-keyword">var</span> def_customError = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> ($inline) {
      <span class="hljs-keyword">if</span> ($rDef.errors) {
        <span class="hljs-keyword">if</span> ($rDef.errors != <span class="hljs-string">'full'</span>) {
          out += <span class="hljs-string">'  for (var '</span> + ($i) + <span class="hljs-string">'='</span> + ($errs) + <span class="hljs-string">'; '</span> + ($i) + <span class="hljs-string">'&lt;errors; '</span> + ($i) + <span class="hljs-string">'++) { var '</span> + ($ruleErr) + <span class="hljs-string">' = vErrors['</span> + ($i) + <span class="hljs-string">']; if ('</span> + ($ruleErr) + <span class="hljs-string">'.dataPath === undefined) '</span> + ($ruleErr) + <span class="hljs-string">'.dataPath = (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">'; if ('</span> + ($ruleErr) + <span class="hljs-string">'.schemaPath === undefined) { '</span> + ($ruleErr) + <span class="hljs-string">'.schemaPath = "'</span> + ($errSchemaPath) + <span class="hljs-string">'"; } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' '</span> + ($ruleErr) + <span class="hljs-string">'.schema = '</span> + ($schemaValue) + <span class="hljs-string">'; '</span> + ($ruleErr) + <span class="hljs-string">'.data = '</span> + ($data) + <span class="hljs-string">'; '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> ($rDef.errors === <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' '</span> + (def_customError) + <span class="hljs-string">' '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' if ('</span> + ($errs) + <span class="hljs-string">' == errors) { '</span> + (def_customError) + <span class="hljs-string">' } else {  for (var '</span> + ($i) + <span class="hljs-string">'='</span> + ($errs) + <span class="hljs-string">'; '</span> + ($i) + <span class="hljs-string">'&lt;errors; '</span> + ($i) + <span class="hljs-string">'++) { var '</span> + ($ruleErr) + <span class="hljs-string">' = vErrors['</span> + ($i) + <span class="hljs-string">']; if ('</span> + ($ruleErr) + <span class="hljs-string">'.dataPath === undefined) '</span> + ($ruleErr) + <span class="hljs-string">'.dataPath = (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">'; if ('</span> + ($ruleErr) + <span class="hljs-string">'.schemaPath === undefined) { '</span> + ($ruleErr) + <span class="hljs-string">'.schemaPath = "'</span> + ($errSchemaPath) + <span class="hljs-string">'"; } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' '</span> + ($ruleErr) + <span class="hljs-string">'.schema = '</span> + ($schemaValue) + <span class="hljs-string">'; '</span> + ($ruleErr) + <span class="hljs-string">'.data = '</span> + ($data) + <span class="hljs-string">'; '</span>;
          }
          out += <span class="hljs-string">' } } '</span>;
        }
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($macro) {
      out += <span class="hljs-string">'   var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
      <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'custom'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { keyword: \''</span> + ($rule.keyword) + <span class="hljs-string">'\' } '</span>;
        <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' , message: \'should pass "'</span> + ($rule.keyword) + <span class="hljs-string">'" keyword validation\' '</span>;
        }
        <span class="hljs-keyword">if</span> (it.opts.verbose) {
          out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
        }
        out += <span class="hljs-string">' } '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' {} '</span>;
      }
      out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
      <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
        <span class="hljs-comment">/* istanbul ignore if */</span>
        <span class="hljs-keyword">if</span> (it.async) {
          out += <span class="hljs-string">' throw new ValidationError(vErrors); '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' validate.errors = vErrors; return false; '</span>;
        }
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> ($rDef.errors === <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' '</span> + (def_customError) + <span class="hljs-string">' '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' if (Array.isArray('</span> + ($ruleErrs) + <span class="hljs-string">')) { if (vErrors === null) vErrors = '</span> + ($ruleErrs) + <span class="hljs-string">'; else vErrors = vErrors.concat('</span> + ($ruleErrs) + <span class="hljs-string">'); errors = vErrors.length;  for (var '</span> + ($i) + <span class="hljs-string">'='</span> + ($errs) + <span class="hljs-string">'; '</span> + ($i) + <span class="hljs-string">'&lt;errors; '</span> + ($i) + <span class="hljs-string">'++) { var '</span> + ($ruleErr) + <span class="hljs-string">' = vErrors['</span> + ($i) + <span class="hljs-string">']; if ('</span> + ($ruleErr) + <span class="hljs-string">'.dataPath === undefined) '</span> + ($ruleErr) + <span class="hljs-string">'.dataPath = (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">';  '</span> + ($ruleErr) + <span class="hljs-string">'.schemaPath = "'</span> + ($errSchemaPath) + <span class="hljs-string">'";  '</span>;
        <span class="hljs-keyword">if</span> (it.opts.verbose) {
          out += <span class="hljs-string">' '</span> + ($ruleErr) + <span class="hljs-string">'.schema = '</span> + ($schemaValue) + <span class="hljs-string">'; '</span> + ($ruleErr) + <span class="hljs-string">'.data = '</span> + ($data) + <span class="hljs-string">'; '</span>;
        }
        out += <span class="hljs-string">' } } else { '</span> + (def_customError) + <span class="hljs-string">' } '</span>;
      }
    }
    out += <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' else { '</span>;
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">23</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_dependencies</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $schemaDeps = {},
    $propertyDeps = {},
    $ownProperties = it.opts.ownProperties;
  <span class="hljs-keyword">for</span> ($property <span class="hljs-keyword">in</span> $schema) {
    <span class="hljs-keyword">if</span> ($property == <span class="hljs-string">'__proto__'</span>) <span class="hljs-keyword">continue</span>;
    <span class="hljs-keyword">var</span> $sch = $schema[$property];
    <span class="hljs-keyword">var</span> $deps = <span class="hljs-built_in">Array</span>.isArray($sch) ? $propertyDeps : $schemaDeps;
    $deps[$property] = $sch;
  }
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors;'</span>;
  <span class="hljs-keyword">var</span> $currentErrorPath = it.errorPath;
  out += <span class="hljs-string">'var missing'</span> + ($lvl) + <span class="hljs-string">';'</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> $property <span class="hljs-keyword">in</span> $propertyDeps) {
    $deps = $propertyDeps[$property];
    <span class="hljs-keyword">if</span> ($deps.length) {
      out += <span class="hljs-string">' if ( '</span> + ($data) + (it.util.getProperty($property)) + <span class="hljs-string">' !== undefined '</span>;
      <span class="hljs-keyword">if</span> ($ownProperties) {
        out += <span class="hljs-string">' &amp;&amp; Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($property)) + <span class="hljs-string">'\') '</span>;
      }
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' &amp;&amp; ( '</span>;
        <span class="hljs-keyword">var</span> arr1 = $deps;
        <span class="hljs-keyword">if</span> (arr1) {
          <span class="hljs-keyword">var</span> $propertyKey, $i = <span class="hljs-number">-1</span>,
            l1 = arr1.length - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span> ($i &lt; l1) {
            $propertyKey = arr1[$i += <span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> ($i) {
              out += <span class="hljs-string">' || '</span>;
            }
            <span class="hljs-keyword">var</span> $prop = it.util.getProperty($propertyKey),
              $useData = $data + $prop;
            out += <span class="hljs-string">' ( ( '</span> + ($useData) + <span class="hljs-string">' === undefined '</span>;
            <span class="hljs-keyword">if</span> ($ownProperties) {
              out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
            }
            out += <span class="hljs-string">') &amp;&amp; (missing'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + <span class="hljs-string">') ) '</span>;
          }
        }
        out += <span class="hljs-string">')) {  '</span>;
        <span class="hljs-keyword">var</span> $propertyPath = <span class="hljs-string">'missing'</span> + $lvl,
          $missingProperty = <span class="hljs-string">'\' + '</span> + $propertyPath + <span class="hljs-string">' + \''</span>;
        <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
          it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, <span class="hljs-literal">true</span>) : $currentErrorPath + <span class="hljs-string">' + '</span> + $propertyPath;
        }
        <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
        $$outStack.push(out);
        out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'dependencies'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { property: \''</span> + (it.util.escapeQuotes($property)) + <span class="hljs-string">'\', missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\', depsCount: '</span> + ($deps.length) + <span class="hljs-string">', deps: \''</span> + (it.util.escapeQuotes($deps.length == <span class="hljs-number">1</span> ? $deps[<span class="hljs-number">0</span>] : $deps.join(<span class="hljs-string">", "</span>))) + <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \'should have '</span>;
            <span class="hljs-keyword">if</span> ($deps.length == <span class="hljs-number">1</span>) {
              out += <span class="hljs-string">'property '</span> + (it.util.escapeQuotes($deps[<span class="hljs-number">0</span>]));
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">'properties '</span> + (it.util.escapeQuotes($deps.join(<span class="hljs-string">", "</span>)));
            }
            out += <span class="hljs-string">' when property '</span> + (it.util.escapeQuotes($property)) + <span class="hljs-string">' is present\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        <span class="hljs-keyword">var</span> __err = out;
        out = $$outStack.pop();
        <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (it.async) {
            out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
          }
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' ) { '</span>;
        <span class="hljs-keyword">var</span> arr2 = $deps;
        <span class="hljs-keyword">if</span> (arr2) {
          <span class="hljs-keyword">var</span> $propertyKey, i2 = <span class="hljs-number">-1</span>,
            l2 = arr2.length - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span> (i2 &lt; l2) {
            $propertyKey = arr2[i2 += <span class="hljs-number">1</span>];
            <span class="hljs-keyword">var</span> $prop = it.util.getProperty($propertyKey),
              $missingProperty = it.util.escapeQuotes($propertyKey),
              $useData = $data + $prop;
            <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
              it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);
            }
            out += <span class="hljs-string">' if ( '</span> + ($useData) + <span class="hljs-string">' === undefined '</span>;
            <span class="hljs-keyword">if</span> ($ownProperties) {
              out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
            }
            out += <span class="hljs-string">') {  var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
            <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
              out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'dependencies'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { property: \''</span> + (it.util.escapeQuotes($property)) + <span class="hljs-string">'\', missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\', depsCount: '</span> + ($deps.length) + <span class="hljs-string">', deps: \''</span> + (it.util.escapeQuotes($deps.length == <span class="hljs-number">1</span> ? $deps[<span class="hljs-number">0</span>] : $deps.join(<span class="hljs-string">", "</span>))) + <span class="hljs-string">'\' } '</span>;
              <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
                out += <span class="hljs-string">' , message: \'should have '</span>;
                <span class="hljs-keyword">if</span> ($deps.length == <span class="hljs-number">1</span>) {
                  out += <span class="hljs-string">'property '</span> + (it.util.escapeQuotes($deps[<span class="hljs-number">0</span>]));
                } <span class="hljs-keyword">else</span> {
                  out += <span class="hljs-string">'properties '</span> + (it.util.escapeQuotes($deps.join(<span class="hljs-string">", "</span>)));
                }
                out += <span class="hljs-string">' when property '</span> + (it.util.escapeQuotes($property)) + <span class="hljs-string">' is present\' '</span>;
              }
              <span class="hljs-keyword">if</span> (it.opts.verbose) {
                out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
              }
              out += <span class="hljs-string">' } '</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">' {} '</span>;
            }
            out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } '</span>;
          }
        }
      }
      out += <span class="hljs-string">' }   '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        $closingBraces += <span class="hljs-string">'}'</span>;
        out += <span class="hljs-string">' else { '</span>;
      }
    }
  }
  it.errorPath = $currentErrorPath;
  <span class="hljs-keyword">var</span> $currentBaseId = $it.baseId;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> $property <span class="hljs-keyword">in</span> $schemaDeps) {
    <span class="hljs-keyword">var</span> $sch = $schemaDeps[$property];
    <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all))) {
      out += <span class="hljs-string">' '</span> + ($nextValid) + <span class="hljs-string">' = true; if ( '</span> + ($data) + (it.util.getProperty($property)) + <span class="hljs-string">' !== undefined '</span>;
      <span class="hljs-keyword">if</span> ($ownProperties) {
        out += <span class="hljs-string">' &amp;&amp; Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($property)) + <span class="hljs-string">'\') '</span>;
      }
      out += <span class="hljs-string">') { '</span>;
      $it.schema = $sch;
      $it.schemaPath = $schemaPath + it.util.getProperty($property);
      $it.errSchemaPath = $errSchemaPath + <span class="hljs-string">'/'</span> + it.util.escapeFragment($property);
      out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
      $it.baseId = $currentBaseId;
      out += <span class="hljs-string">' }  '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
        $closingBraces += <span class="hljs-string">'}'</span>;
      }
    }
  }
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">'   '</span> + ($closingBraces) + <span class="hljs-string">' if ('</span> + ($errs) + <span class="hljs-string">' == errors) {'</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">24</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_enum</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">var</span> $i = <span class="hljs-string">'i'</span> + $lvl,
    $vSchema = <span class="hljs-string">'schema'</span> + $lvl;
  <span class="hljs-keyword">if</span> (!$isData) {
    out += <span class="hljs-string">' var '</span> + ($vSchema) + <span class="hljs-string">' = validate.schema'</span> + ($schemaPath) + <span class="hljs-string">';'</span>;
  }
  out += <span class="hljs-string">'var '</span> + ($valid) + <span class="hljs-string">';'</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' if (schema'</span> + ($lvl) + <span class="hljs-string">' === undefined) '</span> + ($valid) + <span class="hljs-string">' = true; else if (!Array.isArray(schema'</span> + ($lvl) + <span class="hljs-string">')) '</span> + ($valid) + <span class="hljs-string">' = false; else {'</span>;
  }
  out += <span class="hljs-string">''</span> + ($valid) + <span class="hljs-string">' = false;for (var '</span> + ($i) + <span class="hljs-string">'=0; '</span> + ($i) + <span class="hljs-string">'&lt;'</span> + ($vSchema) + <span class="hljs-string">'.length; '</span> + ($i) + <span class="hljs-string">'++) if (equal('</span> + ($data) + <span class="hljs-string">', '</span> + ($vSchema) + <span class="hljs-string">'['</span> + ($i) + <span class="hljs-string">'])) { '</span> + ($valid) + <span class="hljs-string">' = true; break; }'</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">'  }  '</span>;
  }
  out += <span class="hljs-string">' if (!'</span> + ($valid) + <span class="hljs-string">') {   '</span>;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'enum'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { allowedValues: schema'</span> + ($lvl) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should be equal to one of the allowed values\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">' }'</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">25</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_format</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">if</span> (it.opts.format === <span class="hljs-literal">false</span>) {
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (true) { '</span>;
    }
    <span class="hljs-keyword">return</span> out;
  }
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">var</span> $unknownFormats = it.opts.unknownFormats,
    $allowUnknown = <span class="hljs-built_in">Array</span>.isArray($unknownFormats);
  <span class="hljs-keyword">if</span> ($isData) {
    <span class="hljs-keyword">var</span> $format = <span class="hljs-string">'format'</span> + $lvl,
      $isObject = <span class="hljs-string">'isObject'</span> + $lvl,
      $formatType = <span class="hljs-string">'formatType'</span> + $lvl;
    out += <span class="hljs-string">' var '</span> + ($format) + <span class="hljs-string">' = formats['</span> + ($schemaValue) + <span class="hljs-string">']; var '</span> + ($isObject) + <span class="hljs-string">' = typeof '</span> + ($format) + <span class="hljs-string">' == \'object\' &amp;&amp; !('</span> + ($format) + <span class="hljs-string">' instanceof RegExp) &amp;&amp; '</span> + ($format) + <span class="hljs-string">'.validate; var '</span> + ($formatType) + <span class="hljs-string">' = '</span> + ($isObject) + <span class="hljs-string">' &amp;&amp; '</span> + ($format) + <span class="hljs-string">'.type || \'string\'; if ('</span> + ($isObject) + <span class="hljs-string">') { '</span>;
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' var async'</span> + ($lvl) + <span class="hljs-string">' = '</span> + ($format) + <span class="hljs-string">'.async; '</span>;
    }
    out += <span class="hljs-string">' '</span> + ($format) + <span class="hljs-string">' = '</span> + ($format) + <span class="hljs-string">'.validate; } if (  '</span>;
    <span class="hljs-keyword">if</span> ($isData) {
      out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'string\') || '</span>;
    }
    out += <span class="hljs-string">' ('</span>;
    <span class="hljs-keyword">if</span> ($unknownFormats != <span class="hljs-string">'ignore'</span>) {
      out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' &amp;&amp; !'</span> + ($format) + <span class="hljs-string">' '</span>;
      <span class="hljs-keyword">if</span> ($allowUnknown) {
        out += <span class="hljs-string">' &amp;&amp; self._opts.unknownFormats.indexOf('</span> + ($schemaValue) + <span class="hljs-string">') == -1 '</span>;
      }
      out += <span class="hljs-string">') || '</span>;
    }
    out += <span class="hljs-string">' ('</span> + ($format) + <span class="hljs-string">' &amp;&amp; '</span> + ($formatType) + <span class="hljs-string">' == \''</span> + ($ruleType) + <span class="hljs-string">'\' &amp;&amp; !(typeof '</span> + ($format) + <span class="hljs-string">' == \'function\' ? '</span>;
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' (async'</span> + ($lvl) + <span class="hljs-string">' ? await '</span> + ($format) + <span class="hljs-string">'('</span> + ($data) + <span class="hljs-string">') : '</span> + ($format) + <span class="hljs-string">'('</span> + ($data) + <span class="hljs-string">')) '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' '</span> + ($format) + <span class="hljs-string">'('</span> + ($data) + <span class="hljs-string">') '</span>;
    }
    out += <span class="hljs-string">' : '</span> + ($format) + <span class="hljs-string">'.test('</span> + ($data) + <span class="hljs-string">'))))) {'</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> $format = it.formats[$schema];
    <span class="hljs-keyword">if</span> (!$format) {
      <span class="hljs-keyword">if</span> ($unknownFormats == <span class="hljs-string">'ignore'</span>) {
        it.logger.warn(<span class="hljs-string">'unknown format "'</span> + $schema + <span class="hljs-string">'" ignored in schema at path "'</span> + it.errSchemaPath + <span class="hljs-string">'"'</span>);
        <span class="hljs-keyword">if</span> ($breakOnError) {
          out += <span class="hljs-string">' if (true) { '</span>;
        }
        <span class="hljs-keyword">return</span> out;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($allowUnknown &amp;&amp; $unknownFormats.indexOf($schema) &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> ($breakOnError) {
          out += <span class="hljs-string">' if (true) { '</span>;
        }
        <span class="hljs-keyword">return</span> out;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'unknown format "'</span> + $schema + <span class="hljs-string">'" is used in schema at path "'</span> + it.errSchemaPath + <span class="hljs-string">'"'</span>);
      }
    }
    <span class="hljs-keyword">var</span> $isObject = <span class="hljs-keyword">typeof</span> $format == <span class="hljs-string">'object'</span> &amp;&amp; !($format <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) &amp;&amp; $format.validate;
    <span class="hljs-keyword">var</span> $formatType = $isObject &amp;&amp; $format.type || <span class="hljs-string">'string'</span>;
    <span class="hljs-keyword">if</span> ($isObject) {
      <span class="hljs-keyword">var</span> $<span class="hljs-keyword">async</span> = $format.async === <span class="hljs-literal">true</span>;
      $format = $format.validate;
    }
    <span class="hljs-keyword">if</span> ($formatType != $ruleType) {
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' if (true) { '</span>;
      }
      <span class="hljs-keyword">return</span> out;
    }
    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span>) {
      <span class="hljs-keyword">if</span> (!it.async) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'async format in sync schema'</span>);
      <span class="hljs-keyword">var</span> $formatRef = <span class="hljs-string">'formats'</span> + it.util.getProperty($schema) + <span class="hljs-string">'.validate'</span>;
      out += <span class="hljs-string">' if (!(await '</span> + ($formatRef) + <span class="hljs-string">'('</span> + ($data) + <span class="hljs-string">'))) { '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' if (! '</span>;
      <span class="hljs-keyword">var</span> $formatRef = <span class="hljs-string">'formats'</span> + it.util.getProperty($schema);
      <span class="hljs-keyword">if</span> ($isObject) $formatRef += <span class="hljs-string">'.validate'</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> $format == <span class="hljs-string">'function'</span>) {
        out += <span class="hljs-string">' '</span> + ($formatRef) + <span class="hljs-string">'('</span> + ($data) + <span class="hljs-string">') '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' '</span> + ($formatRef) + <span class="hljs-string">'.test('</span> + ($data) + <span class="hljs-string">') '</span>;
      }
      out += <span class="hljs-string">') { '</span>;
    }
  }
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'format'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { format:  '</span>;
    <span class="hljs-keyword">if</span> ($isData) {
      out += <span class="hljs-string">''</span> + ($schemaValue);
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">''</span> + (it.util.toQuotedString($schema));
    }
    out += <span class="hljs-string">'  } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should match format "'</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue) + <span class="hljs-string">' + \''</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + (it.util.escapeQuotes($schema));
      }
      out += <span class="hljs-string">'"\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + (it.util.toQuotedString($schema));
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">' } '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">26</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_if</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $thenSch = it.schema[<span class="hljs-string">'then'</span>],
    $elseSch = it.schema[<span class="hljs-string">'else'</span>],
    $thenPresent = $thenSch !== <span class="hljs-literal">undefined</span> &amp;&amp; (it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $thenSch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($thenSch).length &gt; <span class="hljs-number">0</span>) || $thenSch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($thenSch, it.RULES.all)),
    $elsePresent = $elseSch !== <span class="hljs-literal">undefined</span> &amp;&amp; (it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $elseSch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($elseSch).length &gt; <span class="hljs-number">0</span>) || $elseSch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($elseSch, it.RULES.all)),
    $currentBaseId = $it.baseId;
  <span class="hljs-keyword">if</span> ($thenPresent || $elsePresent) {
    <span class="hljs-keyword">var</span> $ifClause;
    $it.createErrors = <span class="hljs-literal">false</span>;
    $it.schema = $schema;
    $it.schemaPath = $schemaPath;
    $it.errSchemaPath = $errSchemaPath;
    out += <span class="hljs-string">' var '</span> + ($errs) + <span class="hljs-string">' = errors; var '</span> + ($valid) + <span class="hljs-string">' = true;  '</span>;
    <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
    it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
    out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
    $it.baseId = $currentBaseId;
    $it.createErrors = <span class="hljs-literal">true</span>;
    out += <span class="hljs-string">'  errors = '</span> + ($errs) + <span class="hljs-string">'; if (vErrors !== null) { if ('</span> + ($errs) + <span class="hljs-string">') vErrors.length = '</span> + ($errs) + <span class="hljs-string">'; else vErrors = null; }  '</span>;
    it.compositeRule = $it.compositeRule = $wasComposite;
    <span class="hljs-keyword">if</span> ($thenPresent) {
      out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') {  '</span>;
      $it.schema = it.schema[<span class="hljs-string">'then'</span>];
      $it.schemaPath = it.schemaPath + <span class="hljs-string">'.then'</span>;
      $it.errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/then'</span>;
      out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
      $it.baseId = $currentBaseId;
      out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($nextValid) + <span class="hljs-string">'; '</span>;
      <span class="hljs-keyword">if</span> ($thenPresent &amp;&amp; $elsePresent) {
        $ifClause = <span class="hljs-string">'ifClause'</span> + $lvl;
        out += <span class="hljs-string">' var '</span> + ($ifClause) + <span class="hljs-string">' = \'then\'; '</span>;
      } <span class="hljs-keyword">else</span> {
        $ifClause = <span class="hljs-string">'\'then\''</span>;
      }
      out += <span class="hljs-string">' } '</span>;
      <span class="hljs-keyword">if</span> ($elsePresent) {
        out += <span class="hljs-string">' else { '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
    }
    <span class="hljs-keyword">if</span> ($elsePresent) {
      $it.schema = it.schema[<span class="hljs-string">'else'</span>];
      $it.schemaPath = it.schemaPath + <span class="hljs-string">'.else'</span>;
      $it.errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/else'</span>;
      out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
      $it.baseId = $currentBaseId;
      out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($nextValid) + <span class="hljs-string">'; '</span>;
      <span class="hljs-keyword">if</span> ($thenPresent &amp;&amp; $elsePresent) {
        $ifClause = <span class="hljs-string">'ifClause'</span> + $lvl;
        out += <span class="hljs-string">' var '</span> + ($ifClause) + <span class="hljs-string">' = \'else\'; '</span>;
      } <span class="hljs-keyword">else</span> {
        $ifClause = <span class="hljs-string">'\'else\''</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    }
    out += <span class="hljs-string">' if (!'</span> + ($valid) + <span class="hljs-string">') {   var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'if'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { failingKeyword: '</span> + ($ifClause) + <span class="hljs-string">' } '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'should match "\' + '</span> + ($ifClause) + <span class="hljs-string">' + \'" schema\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(vErrors); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = vErrors; return false; '</span>;
      }
    }
    out += <span class="hljs-string">' }   '</span>;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' else { '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (true) { '</span>;
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">27</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29"></a>
</div>
<p>all requires must be explicit because browserify won't work with dynamic requires</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-string">'$ref'</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./ref'</span>),
  <span class="hljs-attr">allOf</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./allOf'</span>),
  <span class="hljs-attr">anyOf</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./anyOf'</span>),
  <span class="hljs-string">'$comment'</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./comment'</span>),
  <span class="hljs-attr">const</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./const'</span>),
  <span class="hljs-attr">contains</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./contains'</span>),
  <span class="hljs-attr">dependencies</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./dependencies'</span>),
  <span class="hljs-string">'enum'</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./enum'</span>),
  <span class="hljs-attr">format</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./format'</span>),
  <span class="hljs-string">'if'</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./if'</span>),
  <span class="hljs-attr">items</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./items'</span>),
  <span class="hljs-attr">maximum</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limit'</span>),
  <span class="hljs-attr">minimum</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limit'</span>),
  <span class="hljs-attr">maxItems</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limitItems'</span>),
  <span class="hljs-attr">minItems</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limitItems'</span>),
  <span class="hljs-attr">maxLength</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limitLength'</span>),
  <span class="hljs-attr">minLength</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limitLength'</span>),
  <span class="hljs-attr">maxProperties</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limitProperties'</span>),
  <span class="hljs-attr">minProperties</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./_limitProperties'</span>),
  <span class="hljs-attr">multipleOf</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./multipleOf'</span>),
  <span class="hljs-attr">not</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./not'</span>),
  <span class="hljs-attr">oneOf</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./oneOf'</span>),
  <span class="hljs-attr">pattern</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./pattern'</span>),
  <span class="hljs-attr">properties</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./properties'</span>),
  <span class="hljs-attr">propertyNames</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./propertyNames'</span>),
  <span class="hljs-attr">required</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./required'</span>),
  <span class="hljs-attr">uniqueItems</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./uniqueItems'</span>),
  <span class="hljs-attr">validate</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./validate'</span>)
};

},{<span class="hljs-string">"./_limit"</span>:<span class="hljs-number">13</span>,<span class="hljs-string">"./_limitItems"</span>:<span class="hljs-number">14</span>,<span class="hljs-string">"./_limitLength"</span>:<span class="hljs-number">15</span>,<span class="hljs-string">"./_limitProperties"</span>:<span class="hljs-number">16</span>,<span class="hljs-string">"./allOf"</span>:<span class="hljs-number">17</span>,<span class="hljs-string">"./anyOf"</span>:<span class="hljs-number">18</span>,<span class="hljs-string">"./comment"</span>:<span class="hljs-number">19</span>,<span class="hljs-string">"./const"</span>:<span class="hljs-number">20</span>,<span class="hljs-string">"./contains"</span>:<span class="hljs-number">21</span>,<span class="hljs-string">"./dependencies"</span>:<span class="hljs-number">23</span>,<span class="hljs-string">"./enum"</span>:<span class="hljs-number">24</span>,<span class="hljs-string">"./format"</span>:<span class="hljs-number">25</span>,<span class="hljs-string">"./if"</span>:<span class="hljs-number">26</span>,<span class="hljs-string">"./items"</span>:<span class="hljs-number">28</span>,<span class="hljs-string">"./multipleOf"</span>:<span class="hljs-number">29</span>,<span class="hljs-string">"./not"</span>:<span class="hljs-number">30</span>,<span class="hljs-string">"./oneOf"</span>:<span class="hljs-number">31</span>,<span class="hljs-string">"./pattern"</span>:<span class="hljs-number">32</span>,<span class="hljs-string">"./properties"</span>:<span class="hljs-number">33</span>,<span class="hljs-string">"./propertyNames"</span>:<span class="hljs-number">34</span>,<span class="hljs-string">"./ref"</span>:<span class="hljs-number">35</span>,<span class="hljs-string">"./required"</span>:<span class="hljs-number">36</span>,<span class="hljs-string">"./uniqueItems"</span>:<span class="hljs-number">37</span>,<span class="hljs-string">"./validate"</span>:<span class="hljs-number">38</span>}],<span class="hljs-number">28</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_items</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $idx = <span class="hljs-string">'i'</span> + $lvl,
    $dataNxt = $it.dataLevel = it.dataLevel + <span class="hljs-number">1</span>,
    $nextData = <span class="hljs-string">'data'</span> + $dataNxt,
    $currentBaseId = it.baseId;
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors;var '</span> + ($valid) + <span class="hljs-string">';'</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray($schema)) {
    <span class="hljs-keyword">var</span> $additionalItems = it.schema.additionalItems;
    <span class="hljs-keyword">if</span> ($additionalItems === <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($data) + <span class="hljs-string">'.length &lt;= '</span> + ($schema.length) + <span class="hljs-string">'; '</span>;
      <span class="hljs-keyword">var</span> $currErrSchemaPath = $errSchemaPath;
      $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/additionalItems'</span>;
      out += <span class="hljs-string">'  if (!'</span> + ($valid) + <span class="hljs-string">') {   '</span>;
      <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
      $$outStack.push(out);
      out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
      <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'additionalItems'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { limit: '</span> + ($schema.length) + <span class="hljs-string">' } '</span>;
        <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' , message: \'should NOT have more than '</span> + ($schema.length) + <span class="hljs-string">' items\' '</span>;
        }
        <span class="hljs-keyword">if</span> (it.opts.verbose) {
          out += <span class="hljs-string">' , schema: false , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
        }
        out += <span class="hljs-string">' } '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' {} '</span>;
      }
      <span class="hljs-keyword">var</span> __err = out;
      out = $$outStack.pop();
      <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
        <span class="hljs-comment">/* istanbul ignore if */</span>
        <span class="hljs-keyword">if</span> (it.async) {
          out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
      $errSchemaPath = $currErrSchemaPath;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        $closingBraces += <span class="hljs-string">'}'</span>;
        out += <span class="hljs-string">' else { '</span>;
      }
    }
    <span class="hljs-keyword">var</span> arr1 = $schema;
    <span class="hljs-keyword">if</span> (arr1) {
      <span class="hljs-keyword">var</span> $sch, $i = <span class="hljs-number">-1</span>,
        l1 = arr1.length - <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span> ($i &lt; l1) {
        $sch = arr1[$i += <span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all))) {
          out += <span class="hljs-string">' '</span> + ($nextValid) + <span class="hljs-string">' = true; if ('</span> + ($data) + <span class="hljs-string">'.length &gt; '</span> + ($i) + <span class="hljs-string">') { '</span>;
          <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>;
          $it.schema = $sch;
          $it.schemaPath = $schemaPath + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>;
          $it.errSchemaPath = $errSchemaPath + <span class="hljs-string">'/'</span> + $i;
          $it.errorPath = it.util.getPathExpr(it.errorPath, $i, it.opts.jsonPointers, <span class="hljs-literal">true</span>);
          $it.dataPathArr[$dataNxt] = $i;
          <span class="hljs-keyword">var</span> $code = it.validate($it);
          $it.baseId = $currentBaseId;
          <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
            out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' }  '</span>;
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
            $closingBraces += <span class="hljs-string">'}'</span>;
          }
        }
      }
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> $additionalItems == <span class="hljs-string">'object'</span> &amp;&amp; (it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $additionalItems == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($additionalItems).length &gt; <span class="hljs-number">0</span>) || $additionalItems === <span class="hljs-literal">false</span> : it.util.schemaHasRules($additionalItems, it.RULES.all))) {
      $it.schema = $additionalItems;
      $it.schemaPath = it.schemaPath + <span class="hljs-string">'.additionalItems'</span>;
      $it.errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/additionalItems'</span>;
      out += <span class="hljs-string">' '</span> + ($nextValid) + <span class="hljs-string">' = true; if ('</span> + ($data) + <span class="hljs-string">'.length &gt; '</span> + ($schema.length) + <span class="hljs-string">') {  for (var '</span> + ($idx) + <span class="hljs-string">' = '</span> + ($schema.length) + <span class="hljs-string">'; '</span> + ($idx) + <span class="hljs-string">' &lt; '</span> + ($data) + <span class="hljs-string">'.length; '</span> + ($idx) + <span class="hljs-string">'++) { '</span>;
      $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, <span class="hljs-literal">true</span>);
      <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $idx + <span class="hljs-string">']'</span>;
      $it.dataPathArr[$dataNxt] = $idx;
      <span class="hljs-keyword">var</span> $code = it.validate($it);
      $it.baseId = $currentBaseId;
      <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
        out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
      }
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') break; '</span>;
      }
      out += <span class="hljs-string">' } }  '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
        $closingBraces += <span class="hljs-string">'}'</span>;
      }
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($schema).length &gt; <span class="hljs-number">0</span>) || $schema === <span class="hljs-literal">false</span> : it.util.schemaHasRules($schema, it.RULES.all))) {
    $it.schema = $schema;
    $it.schemaPath = $schemaPath;
    $it.errSchemaPath = $errSchemaPath;
    out += <span class="hljs-string">'  for (var '</span> + ($idx) + <span class="hljs-string">' = '</span> + (<span class="hljs-number">0</span>) + <span class="hljs-string">'; '</span> + ($idx) + <span class="hljs-string">' &lt; '</span> + ($data) + <span class="hljs-string">'.length; '</span> + ($idx) + <span class="hljs-string">'++) { '</span>;
    $it.errorPath = it.util.getPathExpr(it.errorPath, $idx, it.opts.jsonPointers, <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $idx + <span class="hljs-string">']'</span>;
    $it.dataPathArr[$dataNxt] = $idx;
    <span class="hljs-keyword">var</span> $code = it.validate($it);
    $it.baseId = $currentBaseId;
    <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
      out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
    }
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') break; '</span>;
    }
    out += <span class="hljs-string">' }'</span>;
  }
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' '</span> + ($closingBraces) + <span class="hljs-string">' if ('</span> + ($errs) + <span class="hljs-string">' == errors) {'</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">29</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_multipleOf</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">if</span> (!($isData || <span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'number'</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($keyword + <span class="hljs-string">' must be number'</span>);
  }
  out += <span class="hljs-string">'var division'</span> + ($lvl) + <span class="hljs-string">';if ('</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' '</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; ( typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'number\' || '</span>;
  }
  out += <span class="hljs-string">' (division'</span> + ($lvl) + <span class="hljs-string">' = '</span> + ($data) + <span class="hljs-string">' / '</span> + ($schemaValue) + <span class="hljs-string">', '</span>;
  <span class="hljs-keyword">if</span> (it.opts.multipleOfPrecision) {
    out += <span class="hljs-string">' Math.abs(Math.round(division'</span> + ($lvl) + <span class="hljs-string">') - division'</span> + ($lvl) + <span class="hljs-string">') &gt; 1e-'</span> + (it.opts.multipleOfPrecision) + <span class="hljs-string">' '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' division'</span> + ($lvl) + <span class="hljs-string">' !== parseInt(division'</span> + ($lvl) + <span class="hljs-string">') '</span>;
  }
  out += <span class="hljs-string">' ) '</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">'  )  '</span>;
  }
  out += <span class="hljs-string">' ) {   '</span>;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'multipleOf'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { multipleOf: '</span> + ($schemaValue) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should be multiple of '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schemaValue) + <span class="hljs-string">'\''</span>;
      }
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + ($schema);
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">'} '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">30</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_not</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($schema).length &gt; <span class="hljs-number">0</span>) || $schema === <span class="hljs-literal">false</span> : it.util.schemaHasRules($schema, it.RULES.all))) {
    $it.schema = $schema;
    $it.schemaPath = $schemaPath;
    $it.errSchemaPath = $errSchemaPath;
    out += <span class="hljs-string">' var '</span> + ($errs) + <span class="hljs-string">' = errors;  '</span>;
    <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
    it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
    $it.createErrors = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">var</span> $allErrorsOption;
    <span class="hljs-keyword">if</span> ($it.opts.allErrors) {
      $allErrorsOption = $it.opts.allErrors;
      $it.opts.allErrors = <span class="hljs-literal">false</span>;
    }
    out += <span class="hljs-string">' '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
    $it.createErrors = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">if</span> ($allErrorsOption) $it.opts.allErrors = $allErrorsOption;
    it.compositeRule = $it.compositeRule = $wasComposite;
    out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') {   '</span>;
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'not'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: {} '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'should NOT be valid\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    <span class="hljs-keyword">var</span> __err = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    }
    out += <span class="hljs-string">' } else {  errors = '</span> + ($errs) + <span class="hljs-string">'; if (vErrors !== null) { if ('</span> + ($errs) + <span class="hljs-string">') vErrors.length = '</span> + ($errs) + <span class="hljs-string">'; else vErrors = null; } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.allErrors) {
      out += <span class="hljs-string">' } '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">'  var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'not'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: {} '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'should NOT be valid\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (false) { '</span>;
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">31</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_oneOf</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $currentBaseId = $it.baseId,
    $prevValid = <span class="hljs-string">'prevValid'</span> + $lvl,
    $passingSchemas = <span class="hljs-string">'passingSchemas'</span> + $lvl;
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors , '</span> + ($prevValid) + <span class="hljs-string">' = false , '</span> + ($valid) + <span class="hljs-string">' = false , '</span> + ($passingSchemas) + <span class="hljs-string">' = null; '</span>;
  <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
  it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> arr1 = $schema;
  <span class="hljs-keyword">if</span> (arr1) {
    <span class="hljs-keyword">var</span> $sch, $i = <span class="hljs-number">-1</span>,
      l1 = arr1.length - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">while</span> ($i &lt; l1) {
      $sch = arr1[$i += <span class="hljs-number">1</span>];
      <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all))) {
        $it.schema = $sch;
        $it.schemaPath = $schemaPath + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>;
        $it.errSchemaPath = $errSchemaPath + <span class="hljs-string">'/'</span> + $i;
        out += <span class="hljs-string">'  '</span> + (it.validate($it)) + <span class="hljs-string">' '</span>;
        $it.baseId = $currentBaseId;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' var '</span> + ($nextValid) + <span class="hljs-string">' = true; '</span>;
      }
      <span class="hljs-keyword">if</span> ($i) {
        out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">' &amp;&amp; '</span> + ($prevValid) + <span class="hljs-string">') { '</span> + ($valid) + <span class="hljs-string">' = false; '</span> + ($passingSchemas) + <span class="hljs-string">' = ['</span> + ($passingSchemas) + <span class="hljs-string">', '</span> + ($i) + <span class="hljs-string">']; } else { '</span>;
        $closingBraces += <span class="hljs-string">'}'</span>;
      }
      out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($prevValid) + <span class="hljs-string">' = true; '</span> + ($passingSchemas) + <span class="hljs-string">' = '</span> + ($i) + <span class="hljs-string">'; }'</span>;
    }
  }
  it.compositeRule = $it.compositeRule = $wasComposite;
  out += <span class="hljs-string">''</span> + ($closingBraces) + <span class="hljs-string">'if (!'</span> + ($valid) + <span class="hljs-string">') {   var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'oneOf'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { passingSchemas: '</span> + ($passingSchemas) + <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should match exactly one schema in oneOf\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(vErrors); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = vErrors; return false; '</span>;
    }
  }
  out += <span class="hljs-string">'} else {  errors = '</span> + ($errs) + <span class="hljs-string">'; if (vErrors !== null) { if ('</span> + ($errs) + <span class="hljs-string">') vErrors.length = '</span> + ($errs) + <span class="hljs-string">'; else vErrors = null; }'</span>;
  <span class="hljs-keyword">if</span> (it.opts.allErrors) {
    out += <span class="hljs-string">' } '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">32</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_pattern</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">var</span> $regexp = $isData ? <span class="hljs-string">'(new RegExp('</span> + $schemaValue + <span class="hljs-string">'))'</span> : it.usePattern($schema);
  out += <span class="hljs-string">'if ( '</span>;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' ('</span> + ($schemaValue) + <span class="hljs-string">' !== undefined &amp;&amp; typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'string\') || '</span>;
  }
  out += <span class="hljs-string">' !'</span> + ($regexp) + <span class="hljs-string">'.test('</span> + ($data) + <span class="hljs-string">') ) {   '</span>;
  <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
  $$outStack.push(out);
  out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
  <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
    out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'pattern'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { pattern:  '</span>;
    <span class="hljs-keyword">if</span> ($isData) {
      out += <span class="hljs-string">''</span> + ($schemaValue);
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">''</span> + (it.util.toQuotedString($schema));
    }
    out += <span class="hljs-string">'  } '</span>;
    <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' , message: \'should match pattern "'</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'\' + '</span> + ($schemaValue) + <span class="hljs-string">' + \''</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + (it.util.escapeQuotes($schema));
      }
      out += <span class="hljs-string">'"\' '</span>;
    }
    <span class="hljs-keyword">if</span> (it.opts.verbose) {
      out += <span class="hljs-string">' , schema:  '</span>;
      <span class="hljs-keyword">if</span> ($isData) {
        out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">''</span> + (it.util.toQuotedString($schema));
      }
      out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' {} '</span>;
  }
  <span class="hljs-keyword">var</span> __err = out;
  out = $$outStack.pop();
  <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
    <span class="hljs-comment">/* istanbul ignore if */</span>
    <span class="hljs-keyword">if</span> (it.async) {
      out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
  }
  out += <span class="hljs-string">'} '</span>;
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' else { '</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">33</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_properties</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  <span class="hljs-keyword">var</span> $key = <span class="hljs-string">'key'</span> + $lvl,
    $idx = <span class="hljs-string">'idx'</span> + $lvl,
    $dataNxt = $it.dataLevel = it.dataLevel + <span class="hljs-number">1</span>,
    $nextData = <span class="hljs-string">'data'</span> + $dataNxt,
    $dataProperties = <span class="hljs-string">'dataProperties'</span> + $lvl;
  <span class="hljs-keyword">var</span> $schemaKeys = <span class="hljs-built_in">Object</span>.keys($schema || {}).filter(notProto),
    $pProperties = it.schema.patternProperties || {},
    $pPropertyKeys = <span class="hljs-built_in">Object</span>.keys($pProperties).filter(notProto),
    $aProperties = it.schema.additionalProperties,
    $someProperties = $schemaKeys.length || $pPropertyKeys.length,
    $noAdditional = $aProperties === <span class="hljs-literal">false</span>,
    $additionalIsSchema = <span class="hljs-keyword">typeof</span> $aProperties == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($aProperties).length,
    $removeAdditional = it.opts.removeAdditional,
    $checkAdditional = $noAdditional || $additionalIsSchema || $removeAdditional,
    $ownProperties = it.opts.ownProperties,
    $currentBaseId = it.baseId;
  <span class="hljs-keyword">var</span> $required = it.schema.required;
  <span class="hljs-keyword">if</span> ($required &amp;&amp; !(it.opts.$data &amp;&amp; $required.$data) &amp;&amp; $required.length &lt; it.opts.loopRequired) {
    <span class="hljs-keyword">var</span> $requiredHash = it.util.toHash($required);
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">notProto</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">return</span> p !== <span class="hljs-string">'__proto__'</span>;
  }
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors;var '</span> + ($nextValid) + <span class="hljs-string">' = true;'</span>;
  <span class="hljs-keyword">if</span> ($ownProperties) {
    out += <span class="hljs-string">' var '</span> + ($dataProperties) + <span class="hljs-string">' = undefined;'</span>;
  }
  <span class="hljs-keyword">if</span> ($checkAdditional) {
    <span class="hljs-keyword">if</span> ($ownProperties) {
      out += <span class="hljs-string">' '</span> + ($dataProperties) + <span class="hljs-string">' = '</span> + ($dataProperties) + <span class="hljs-string">' || Object.keys('</span> + ($data) + <span class="hljs-string">'); for (var '</span> + ($idx) + <span class="hljs-string">'=0; '</span> + ($idx) + <span class="hljs-string">'&lt;'</span> + ($dataProperties) + <span class="hljs-string">'.length; '</span> + ($idx) + <span class="hljs-string">'++) { var '</span> + ($key) + <span class="hljs-string">' = '</span> + ($dataProperties) + <span class="hljs-string">'['</span> + ($idx) + <span class="hljs-string">']; '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' for (var '</span> + ($key) + <span class="hljs-string">' in '</span> + ($data) + <span class="hljs-string">') { '</span>;
    }
    <span class="hljs-keyword">if</span> ($someProperties) {
      out += <span class="hljs-string">' var isAdditional'</span> + ($lvl) + <span class="hljs-string">' = !(false '</span>;
      <span class="hljs-keyword">if</span> ($schemaKeys.length) {
        <span class="hljs-keyword">if</span> ($schemaKeys.length &gt; <span class="hljs-number">8</span>) {
          out += <span class="hljs-string">' || validate.schema'</span> + ($schemaPath) + <span class="hljs-string">'.hasOwnProperty('</span> + ($key) + <span class="hljs-string">') '</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">var</span> arr1 = $schemaKeys;
          <span class="hljs-keyword">if</span> (arr1) {
            <span class="hljs-keyword">var</span> $propertyKey, i1 = <span class="hljs-number">-1</span>,
              l1 = arr1.length - <span class="hljs-number">1</span>;
            <span class="hljs-keyword">while</span> (i1 &lt; l1) {
              $propertyKey = arr1[i1 += <span class="hljs-number">1</span>];
              out += <span class="hljs-string">' || '</span> + ($key) + <span class="hljs-string">' == '</span> + (it.util.toQuotedString($propertyKey)) + <span class="hljs-string">' '</span>;
            }
          }
        }
      }
      <span class="hljs-keyword">if</span> ($pPropertyKeys.length) {
        <span class="hljs-keyword">var</span> arr2 = $pPropertyKeys;
        <span class="hljs-keyword">if</span> (arr2) {
          <span class="hljs-keyword">var</span> $pProperty, $i = <span class="hljs-number">-1</span>,
            l2 = arr2.length - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span> ($i &lt; l2) {
            $pProperty = arr2[$i += <span class="hljs-number">1</span>];
            out += <span class="hljs-string">' || '</span> + (it.usePattern($pProperty)) + <span class="hljs-string">'.test('</span> + ($key) + <span class="hljs-string">') '</span>;
          }
        }
      }
      out += <span class="hljs-string">' ); if (isAdditional'</span> + ($lvl) + <span class="hljs-string">') { '</span>;
    }
    <span class="hljs-keyword">if</span> ($removeAdditional == <span class="hljs-string">'all'</span>) {
      out += <span class="hljs-string">' delete '</span> + ($data) + <span class="hljs-string">'['</span> + ($key) + <span class="hljs-string">']; '</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> $currentErrorPath = it.errorPath;
      <span class="hljs-keyword">var</span> $additionalProperty = <span class="hljs-string">'\' + '</span> + $key + <span class="hljs-string">' + \''</span>;
      <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
        it.errorPath = it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);
      }
      <span class="hljs-keyword">if</span> ($noAdditional) {
        <span class="hljs-keyword">if</span> ($removeAdditional) {
          out += <span class="hljs-string">' delete '</span> + ($data) + <span class="hljs-string">'['</span> + ($key) + <span class="hljs-string">']; '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' '</span> + ($nextValid) + <span class="hljs-string">' = false; '</span>;
          <span class="hljs-keyword">var</span> $currErrSchemaPath = $errSchemaPath;
          $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/additionalProperties'</span>;
          <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
          $$outStack.push(out);
          out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
          <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'additionalProperties'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { additionalProperty: \''</span> + ($additionalProperty) + <span class="hljs-string">'\' } '</span>;
            <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
              out += <span class="hljs-string">' , message: \''</span>;
              <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
                out += <span class="hljs-string">'is an invalid additional property'</span>;
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">'should NOT have additional properties'</span>;
              }
              out += <span class="hljs-string">'\' '</span>;
            }
            <span class="hljs-keyword">if</span> (it.opts.verbose) {
              out += <span class="hljs-string">' , schema: false , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
            }
            out += <span class="hljs-string">' } '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' {} '</span>;
          }
          <span class="hljs-keyword">var</span> __err = out;
          out = $$outStack.pop();
          <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
            <span class="hljs-comment">/* istanbul ignore if */</span>
            <span class="hljs-keyword">if</span> (it.async) {
              out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
            }
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
          }
          $errSchemaPath = $currErrSchemaPath;
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' break; '</span>;
          }
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($additionalIsSchema) {
        <span class="hljs-keyword">if</span> ($removeAdditional == <span class="hljs-string">'failing'</span>) {
          out += <span class="hljs-string">' var '</span> + ($errs) + <span class="hljs-string">' = errors;  '</span>;
          <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
          it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
          $it.schema = $aProperties;
          $it.schemaPath = it.schemaPath + <span class="hljs-string">'.additionalProperties'</span>;
          $it.errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/additionalProperties'</span>;
          $it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);
          <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $key + <span class="hljs-string">']'</span>;
          $it.dataPathArr[$dataNxt] = $key;
          <span class="hljs-keyword">var</span> $code = it.validate($it);
          $it.baseId = $currentBaseId;
          <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
            out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') { errors = '</span> + ($errs) + <span class="hljs-string">'; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete '</span> + ($data) + <span class="hljs-string">'['</span> + ($key) + <span class="hljs-string">']; }  '</span>;
          it.compositeRule = $it.compositeRule = $wasComposite;
        } <span class="hljs-keyword">else</span> {
          $it.schema = $aProperties;
          $it.schemaPath = it.schemaPath + <span class="hljs-string">'.additionalProperties'</span>;
          $it.errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/additionalProperties'</span>;
          $it.errorPath = it.opts._errorDataPathProperty ? it.errorPath : it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);
          <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $key + <span class="hljs-string">']'</span>;
          $it.dataPathArr[$dataNxt] = $key;
          <span class="hljs-keyword">var</span> $code = it.validate($it);
          $it.baseId = $currentBaseId;
          <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
            out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
          }
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') break; '</span>;
          }
        }
      }
      it.errorPath = $currentErrorPath;
    }
    <span class="hljs-keyword">if</span> ($someProperties) {
      out += <span class="hljs-string">' } '</span>;
    }
    out += <span class="hljs-string">' }  '</span>;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
      $closingBraces += <span class="hljs-string">'}'</span>;
    }
  }
  <span class="hljs-keyword">var</span> $useDefaults = it.opts.useDefaults &amp;&amp; !it.compositeRule;
  <span class="hljs-keyword">if</span> ($schemaKeys.length) {
    <span class="hljs-keyword">var</span> arr3 = $schemaKeys;
    <span class="hljs-keyword">if</span> (arr3) {
      <span class="hljs-keyword">var</span> $propertyKey, i3 = <span class="hljs-number">-1</span>,
        l3 = arr3.length - <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span> (i3 &lt; l3) {
        $propertyKey = arr3[i3 += <span class="hljs-number">1</span>];
        <span class="hljs-keyword">var</span> $sch = $schema[$propertyKey];
        <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all))) {
          <span class="hljs-keyword">var</span> $prop = it.util.getProperty($propertyKey),
            $passData = $data + $prop,
            $hasDefault = $useDefaults &amp;&amp; $sch.default !== <span class="hljs-literal">undefined</span>;
          $it.schema = $sch;
          $it.schemaPath = $schemaPath + $prop;
          $it.errSchemaPath = $errSchemaPath + <span class="hljs-string">'/'</span> + it.util.escapeFragment($propertyKey);
          $it.errorPath = it.util.getPath(it.errorPath, $propertyKey, it.opts.jsonPointers);
          $it.dataPathArr[$dataNxt] = it.util.toQuotedString($propertyKey);
          <span class="hljs-keyword">var</span> $code = it.validate($it);
          $it.baseId = $currentBaseId;
          <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
            $code = it.util.varReplace($code, $nextData, $passData);
            <span class="hljs-keyword">var</span> $useData = $passData;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> $useData = $nextData;
            out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span>;
          }
          <span class="hljs-keyword">if</span> ($hasDefault) {
            out += <span class="hljs-string">' '</span> + ($code) + <span class="hljs-string">' '</span>;
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> ($requiredHash &amp;&amp; $requiredHash[$propertyKey]) {
              out += <span class="hljs-string">' if ( '</span> + ($useData) + <span class="hljs-string">' === undefined '</span>;
              <span class="hljs-keyword">if</span> ($ownProperties) {
                out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
              }
              out += <span class="hljs-string">') { '</span> + ($nextValid) + <span class="hljs-string">' = false; '</span>;
              <span class="hljs-keyword">var</span> $currentErrorPath = it.errorPath,
                $currErrSchemaPath = $errSchemaPath,
                $missingProperty = it.util.escapeQuotes($propertyKey);
              <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
                it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);
              }
              $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/required'</span>;
              <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
              $$outStack.push(out);
              out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
              <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
                out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'required'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\' } '</span>;
                <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
                  out += <span class="hljs-string">' , message: \''</span>;
                  <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
                    out += <span class="hljs-string">'is a required property'</span>;
                  } <span class="hljs-keyword">else</span> {
                    out += <span class="hljs-string">'should have required property \\\''</span> + ($missingProperty) + <span class="hljs-string">'\\\''</span>;
                  }
                  out += <span class="hljs-string">'\' '</span>;
                }
                <span class="hljs-keyword">if</span> (it.opts.verbose) {
                  out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
                }
                out += <span class="hljs-string">' } '</span>;
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">' {} '</span>;
              }
              <span class="hljs-keyword">var</span> __err = out;
              out = $$outStack.pop();
              <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
                <span class="hljs-comment">/* istanbul ignore if */</span>
                <span class="hljs-keyword">if</span> (it.async) {
                  out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
                } <span class="hljs-keyword">else</span> {
                  out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
                }
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
              }
              $errSchemaPath = $currErrSchemaPath;
              it.errorPath = $currentErrorPath;
              out += <span class="hljs-string">' } else { '</span>;
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-keyword">if</span> ($breakOnError) {
                out += <span class="hljs-string">' if ( '</span> + ($useData) + <span class="hljs-string">' === undefined '</span>;
                <span class="hljs-keyword">if</span> ($ownProperties) {
                  out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
                }
                out += <span class="hljs-string">') { '</span> + ($nextValid) + <span class="hljs-string">' = true; } else { '</span>;
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">' if ('</span> + ($useData) + <span class="hljs-string">' !== undefined '</span>;
                <span class="hljs-keyword">if</span> ($ownProperties) {
                  out += <span class="hljs-string">' &amp;&amp;   Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
                }
                out += <span class="hljs-string">' ) { '</span>;
              }
            }
            out += <span class="hljs-string">' '</span> + ($code) + <span class="hljs-string">' } '</span>;
          }
        }
        <span class="hljs-keyword">if</span> ($breakOnError) {
          out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
          $closingBraces += <span class="hljs-string">'}'</span>;
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> ($pPropertyKeys.length) {
    <span class="hljs-keyword">var</span> arr4 = $pPropertyKeys;
    <span class="hljs-keyword">if</span> (arr4) {
      <span class="hljs-keyword">var</span> $pProperty, i4 = <span class="hljs-number">-1</span>,
        l4 = arr4.length - <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span> (i4 &lt; l4) {
        $pProperty = arr4[i4 += <span class="hljs-number">1</span>];
        <span class="hljs-keyword">var</span> $sch = $pProperties[$pProperty];
        <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $sch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($sch).length &gt; <span class="hljs-number">0</span>) || $sch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($sch, it.RULES.all))) {
          $it.schema = $sch;
          $it.schemaPath = it.schemaPath + <span class="hljs-string">'.patternProperties'</span> + it.util.getProperty($pProperty);
          $it.errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/patternProperties/'</span> + it.util.escapeFragment($pProperty);
          <span class="hljs-keyword">if</span> ($ownProperties) {
            out += <span class="hljs-string">' '</span> + ($dataProperties) + <span class="hljs-string">' = '</span> + ($dataProperties) + <span class="hljs-string">' || Object.keys('</span> + ($data) + <span class="hljs-string">'); for (var '</span> + ($idx) + <span class="hljs-string">'=0; '</span> + ($idx) + <span class="hljs-string">'&lt;'</span> + ($dataProperties) + <span class="hljs-string">'.length; '</span> + ($idx) + <span class="hljs-string">'++) { var '</span> + ($key) + <span class="hljs-string">' = '</span> + ($dataProperties) + <span class="hljs-string">'['</span> + ($idx) + <span class="hljs-string">']; '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' for (var '</span> + ($key) + <span class="hljs-string">' in '</span> + ($data) + <span class="hljs-string">') { '</span>;
          }
          out += <span class="hljs-string">' if ('</span> + (it.usePattern($pProperty)) + <span class="hljs-string">'.test('</span> + ($key) + <span class="hljs-string">')) { '</span>;
          $it.errorPath = it.util.getPathExpr(it.errorPath, $key, it.opts.jsonPointers);
          <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $key + <span class="hljs-string">']'</span>;
          $it.dataPathArr[$dataNxt] = $key;
          <span class="hljs-keyword">var</span> $code = it.validate($it);
          $it.baseId = $currentBaseId;
          <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
            out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
          }
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') break; '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' else '</span> + ($nextValid) + <span class="hljs-string">' = true; '</span>;
          }
          out += <span class="hljs-string">' }  '</span>;
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
            $closingBraces += <span class="hljs-string">'}'</span>;
          }
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' '</span> + ($closingBraces) + <span class="hljs-string">' if ('</span> + ($errs) + <span class="hljs-string">' == errors) {'</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">34</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_propertyNames</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $errs = <span class="hljs-string">'errs__'</span> + $lvl;
  <span class="hljs-keyword">var</span> $it = it.util.copy(it);
  <span class="hljs-keyword">var</span> $closingBraces = <span class="hljs-string">''</span>;
  $it.level++;
  <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
  out += <span class="hljs-string">'var '</span> + ($errs) + <span class="hljs-string">' = errors;'</span>;
  <span class="hljs-keyword">if</span> ((it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $schema == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($schema).length &gt; <span class="hljs-number">0</span>) || $schema === <span class="hljs-literal">false</span> : it.util.schemaHasRules($schema, it.RULES.all))) {
    $it.schema = $schema;
    $it.schemaPath = $schemaPath;
    $it.errSchemaPath = $errSchemaPath;
    <span class="hljs-keyword">var</span> $key = <span class="hljs-string">'key'</span> + $lvl,
      $idx = <span class="hljs-string">'idx'</span> + $lvl,
      $i = <span class="hljs-string">'i'</span> + $lvl,
      $invalidName = <span class="hljs-string">'\' + '</span> + $key + <span class="hljs-string">' + \''</span>,
      $dataNxt = $it.dataLevel = it.dataLevel + <span class="hljs-number">1</span>,
      $nextData = <span class="hljs-string">'data'</span> + $dataNxt,
      $dataProperties = <span class="hljs-string">'dataProperties'</span> + $lvl,
      $ownProperties = it.opts.ownProperties,
      $currentBaseId = it.baseId;
    <span class="hljs-keyword">if</span> ($ownProperties) {
      out += <span class="hljs-string">' var '</span> + ($dataProperties) + <span class="hljs-string">' = undefined; '</span>;
    }
    <span class="hljs-keyword">if</span> ($ownProperties) {
      out += <span class="hljs-string">' '</span> + ($dataProperties) + <span class="hljs-string">' = '</span> + ($dataProperties) + <span class="hljs-string">' || Object.keys('</span> + ($data) + <span class="hljs-string">'); for (var '</span> + ($idx) + <span class="hljs-string">'=0; '</span> + ($idx) + <span class="hljs-string">'&lt;'</span> + ($dataProperties) + <span class="hljs-string">'.length; '</span> + ($idx) + <span class="hljs-string">'++) { var '</span> + ($key) + <span class="hljs-string">' = '</span> + ($dataProperties) + <span class="hljs-string">'['</span> + ($idx) + <span class="hljs-string">']; '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' for (var '</span> + ($key) + <span class="hljs-string">' in '</span> + ($data) + <span class="hljs-string">') { '</span>;
    }
    out += <span class="hljs-string">' var startErrs'</span> + ($lvl) + <span class="hljs-string">' = errors; '</span>;
    <span class="hljs-keyword">var</span> $passData = $key;
    <span class="hljs-keyword">var</span> $wasComposite = it.compositeRule;
    it.compositeRule = $it.compositeRule = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">var</span> $code = it.validate($it);
    $it.baseId = $currentBaseId;
    <span class="hljs-keyword">if</span> (it.util.varOccurences($code, $nextData) &lt; <span class="hljs-number">2</span>) {
      out += <span class="hljs-string">' '</span> + (it.util.varReplace($code, $nextData, $passData)) + <span class="hljs-string">' '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var '</span> + ($nextData) + <span class="hljs-string">' = '</span> + ($passData) + <span class="hljs-string">'; '</span> + ($code) + <span class="hljs-string">' '</span>;
    }
    it.compositeRule = $it.compositeRule = $wasComposite;
    out += <span class="hljs-string">' if (!'</span> + ($nextValid) + <span class="hljs-string">') { for (var '</span> + ($i) + <span class="hljs-string">'=startErrs'</span> + ($lvl) + <span class="hljs-string">'; '</span> + ($i) + <span class="hljs-string">'&lt;errors; '</span> + ($i) + <span class="hljs-string">'++) { vErrors['</span> + ($i) + <span class="hljs-string">'].propertyName = '</span> + ($key) + <span class="hljs-string">'; }   var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'propertyNames'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { propertyName: \''</span> + ($invalidName) + <span class="hljs-string">'\' } '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'property name \\\''</span> + ($invalidName) + <span class="hljs-string">'\\\' is invalid\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(vErrors); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = vErrors; return false; '</span>;
      }
    }
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' break; '</span>;
    }
    out += <span class="hljs-string">' } }'</span>;
  }
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' '</span> + ($closingBraces) + <span class="hljs-string">' if ('</span> + ($errs) + <span class="hljs-string">' == errors) {'</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">35</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_ref</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $<span class="hljs-keyword">async</span>, $refCode;
  <span class="hljs-keyword">if</span> ($schema == <span class="hljs-string">'#'</span> || $schema == <span class="hljs-string">'#/'</span>) {
    <span class="hljs-keyword">if</span> (it.isRoot) {
      $<span class="hljs-keyword">async</span> = it.async;
      $refCode = <span class="hljs-string">'validate'</span>;
    } <span class="hljs-keyword">else</span> {
      $<span class="hljs-keyword">async</span> = it.root.schema.$<span class="hljs-keyword">async</span> === <span class="hljs-literal">true</span>;
      $refCode = <span class="hljs-string">'root.refVal[0]'</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> $refVal = it.resolveRef(it.baseId, $schema, it.isRoot);
    <span class="hljs-keyword">if</span> ($refVal === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-keyword">var</span> $message = it.MissingRefError.message(it.baseId, $schema);
      <span class="hljs-keyword">if</span> (it.opts.missingRefs == <span class="hljs-string">'fail'</span>) {
        it.logger.error($message);
        <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
        $$outStack.push(out);
        out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'$ref'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { ref: \''</span> + (it.util.escapeQuotes($schema)) + <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \'can\\\'t resolve reference '</span> + (it.util.escapeQuotes($schema)) + <span class="hljs-string">'\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: '</span> + (it.util.toQuotedString($schema)) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        <span class="hljs-keyword">var</span> __err = out;
        out = $$outStack.pop();
        <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (it.async) {
            out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
          }
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
        }
        <span class="hljs-keyword">if</span> ($breakOnError) {
          out += <span class="hljs-string">' if (false) { '</span>;
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (it.opts.missingRefs == <span class="hljs-string">'ignore'</span>) {
        it.logger.warn($message);
        <span class="hljs-keyword">if</span> ($breakOnError) {
          out += <span class="hljs-string">' if (true) { '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> it.MissingRefError(it.baseId, $schema, $message);
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($refVal.inline) {
      <span class="hljs-keyword">var</span> $it = it.util.copy(it);
      $it.level++;
      <span class="hljs-keyword">var</span> $nextValid = <span class="hljs-string">'valid'</span> + $it.level;
      $it.schema = $refVal.schema;
      $it.schemaPath = <span class="hljs-string">''</span>;
      $it.errSchemaPath = $schema;
      <span class="hljs-keyword">var</span> $code = it.validate($it).replace(<span class="hljs-regexp">/validate\.schema/g</span>, $refVal.code);
      out += <span class="hljs-string">' '</span> + ($code) + <span class="hljs-string">' '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' if ('</span> + ($nextValid) + <span class="hljs-string">') { '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      $<span class="hljs-keyword">async</span> = $refVal.$<span class="hljs-keyword">async</span> === <span class="hljs-literal">true</span> || (it.async &amp;&amp; $refVal.$<span class="hljs-keyword">async</span> !== <span class="hljs-literal">false</span>);
      $refCode = $refVal.code;
    }
  }
  <span class="hljs-keyword">if</span> ($refCode) {
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">if</span> (it.opts.passContext) {
      out += <span class="hljs-string">' '</span> + ($refCode) + <span class="hljs-string">'.call(this, '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' '</span> + ($refCode) + <span class="hljs-string">'( '</span>;
    }
    out += <span class="hljs-string">' '</span> + ($data) + <span class="hljs-string">', (dataPath || \'\')'</span>;
    <span class="hljs-keyword">if</span> (it.errorPath != <span class="hljs-string">'""'</span>) {
      out += <span class="hljs-string">' + '</span> + (it.errorPath);
    }
    <span class="hljs-keyword">var</span> $parentData = $dataLvl ? <span class="hljs-string">'data'</span> + (($dataLvl - <span class="hljs-number">1</span>) || <span class="hljs-string">''</span>) : <span class="hljs-string">'parentData'</span>,
      $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : <span class="hljs-string">'parentDataProperty'</span>;
    out += <span class="hljs-string">' , '</span> + ($parentData) + <span class="hljs-string">' , '</span> + ($parentDataProperty) + <span class="hljs-string">', rootData)  '</span>;
    <span class="hljs-keyword">var</span> __callValidate = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span>) {
      <span class="hljs-keyword">if</span> (!it.async) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'async schema referenced by sync schema'</span>);
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' var '</span> + ($valid) + <span class="hljs-string">'; '</span>;
      }
      out += <span class="hljs-string">' try { await '</span> + (__callValidate) + <span class="hljs-string">'; '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = true; '</span>;
      }
      out += <span class="hljs-string">' } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' '</span> + ($valid) + <span class="hljs-string">' = false; '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' if ('</span> + ($valid) + <span class="hljs-string">') { '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' if (!'</span> + (__callValidate) + <span class="hljs-string">') { if (vErrors === null) vErrors = '</span> + ($refCode) + <span class="hljs-string">'.errors; else vErrors = vErrors.concat('</span> + ($refCode) + <span class="hljs-string">'.errors); errors = vErrors.length; } '</span>;
      <span class="hljs-keyword">if</span> ($breakOnError) {
        out += <span class="hljs-string">' else { '</span>;
      }
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">36</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_required</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">var</span> $vSchema = <span class="hljs-string">'schema'</span> + $lvl;
  <span class="hljs-keyword">if</span> (!$isData) {
    <span class="hljs-keyword">if</span> ($schema.length &lt; it.opts.loopRequired &amp;&amp; it.schema.properties &amp;&amp; <span class="hljs-built_in">Object</span>.keys(it.schema.properties).length) {
      <span class="hljs-keyword">var</span> $required = [];
      <span class="hljs-keyword">var</span> arr1 = $schema;
      <span class="hljs-keyword">if</span> (arr1) {
        <span class="hljs-keyword">var</span> $property, i1 = <span class="hljs-number">-1</span>,
          l1 = arr1.length - <span class="hljs-number">1</span>;
        <span class="hljs-keyword">while</span> (i1 &lt; l1) {
          $property = arr1[i1 += <span class="hljs-number">1</span>];
          <span class="hljs-keyword">var</span> $propertySch = it.schema.properties[$property];
          <span class="hljs-keyword">if</span> (!($propertySch &amp;&amp; (it.opts.strictKeywords ? (<span class="hljs-keyword">typeof</span> $propertySch == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">Object</span>.keys($propertySch).length &gt; <span class="hljs-number">0</span>) || $propertySch === <span class="hljs-literal">false</span> : it.util.schemaHasRules($propertySch, it.RULES.all)))) {
            $required[$required.length] = $property;
          }
        }
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">var</span> $required = $schema;
    }
  }
  <span class="hljs-keyword">if</span> ($isData || $required.length) {
    <span class="hljs-keyword">var</span> $currentErrorPath = it.errorPath,
      $loopRequired = $isData || $required.length &gt;= it.opts.loopRequired,
      $ownProperties = it.opts.ownProperties;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' var missing'</span> + ($lvl) + <span class="hljs-string">'; '</span>;
      <span class="hljs-keyword">if</span> ($loopRequired) {
        <span class="hljs-keyword">if</span> (!$isData) {
          out += <span class="hljs-string">' var '</span> + ($vSchema) + <span class="hljs-string">' = validate.schema'</span> + ($schemaPath) + <span class="hljs-string">'; '</span>;
        }
        <span class="hljs-keyword">var</span> $i = <span class="hljs-string">'i'</span> + $lvl,
          $propertyPath = <span class="hljs-string">'schema'</span> + $lvl + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>,
          $missingProperty = <span class="hljs-string">'\' + '</span> + $propertyPath + <span class="hljs-string">' + \''</span>;
        <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
          it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);
        }
        out += <span class="hljs-string">' var '</span> + ($valid) + <span class="hljs-string">' = true; '</span>;
        <span class="hljs-keyword">if</span> ($isData) {
          out += <span class="hljs-string">' if (schema'</span> + ($lvl) + <span class="hljs-string">' === undefined) '</span> + ($valid) + <span class="hljs-string">' = true; else if (!Array.isArray(schema'</span> + ($lvl) + <span class="hljs-string">')) '</span> + ($valid) + <span class="hljs-string">' = false; else {'</span>;
        }
        out += <span class="hljs-string">' for (var '</span> + ($i) + <span class="hljs-string">' = 0; '</span> + ($i) + <span class="hljs-string">' &lt; '</span> + ($vSchema) + <span class="hljs-string">'.length; '</span> + ($i) + <span class="hljs-string">'++) { '</span> + ($valid) + <span class="hljs-string">' = '</span> + ($data) + <span class="hljs-string">'['</span> + ($vSchema) + <span class="hljs-string">'['</span> + ($i) + <span class="hljs-string">']] !== undefined '</span>;
        <span class="hljs-keyword">if</span> ($ownProperties) {
          out += <span class="hljs-string">' &amp;&amp;   Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', '</span> + ($vSchema) + <span class="hljs-string">'['</span> + ($i) + <span class="hljs-string">']) '</span>;
        }
        out += <span class="hljs-string">'; if (!'</span> + ($valid) + <span class="hljs-string">') break; } '</span>;
        <span class="hljs-keyword">if</span> ($isData) {
          out += <span class="hljs-string">'  }  '</span>;
        }
        out += <span class="hljs-string">'  if (!'</span> + ($valid) + <span class="hljs-string">') {   '</span>;
        <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
        $$outStack.push(out);
        out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'required'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \''</span>;
            <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
              out += <span class="hljs-string">'is a required property'</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">'should have required property \\\''</span> + ($missingProperty) + <span class="hljs-string">'\\\''</span>;
            }
            out += <span class="hljs-string">'\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        <span class="hljs-keyword">var</span> __err = out;
        out = $$outStack.pop();
        <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (it.async) {
            out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
          }
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
        }
        out += <span class="hljs-string">' } else { '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' if ( '</span>;
        <span class="hljs-keyword">var</span> arr2 = $required;
        <span class="hljs-keyword">if</span> (arr2) {
          <span class="hljs-keyword">var</span> $propertyKey, $i = <span class="hljs-number">-1</span>,
            l2 = arr2.length - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span> ($i &lt; l2) {
            $propertyKey = arr2[$i += <span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> ($i) {
              out += <span class="hljs-string">' || '</span>;
            }
            <span class="hljs-keyword">var</span> $prop = it.util.getProperty($propertyKey),
              $useData = $data + $prop;
            out += <span class="hljs-string">' ( ( '</span> + ($useData) + <span class="hljs-string">' === undefined '</span>;
            <span class="hljs-keyword">if</span> ($ownProperties) {
              out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
            }
            out += <span class="hljs-string">') &amp;&amp; (missing'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.toQuotedString(it.opts.jsonPointers ? $propertyKey : $prop)) + <span class="hljs-string">') ) '</span>;
          }
        }
        out += <span class="hljs-string">') {  '</span>;
        <span class="hljs-keyword">var</span> $propertyPath = <span class="hljs-string">'missing'</span> + $lvl,
          $missingProperty = <span class="hljs-string">'\' + '</span> + $propertyPath + <span class="hljs-string">' + \''</span>;
        <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
          it.errorPath = it.opts.jsonPointers ? it.util.getPathExpr($currentErrorPath, $propertyPath, <span class="hljs-literal">true</span>) : $currentErrorPath + <span class="hljs-string">' + '</span> + $propertyPath;
        }
        <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
        $$outStack.push(out);
        out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'required'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \''</span>;
            <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
              out += <span class="hljs-string">'is a required property'</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">'should have required property \\\''</span> + ($missingProperty) + <span class="hljs-string">'\\\''</span>;
            }
            out += <span class="hljs-string">'\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        <span class="hljs-keyword">var</span> __err = out;
        out = $$outStack.pop();
        <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (it.async) {
            out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
          }
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
        }
        out += <span class="hljs-string">' } else { '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> ($loopRequired) {
        <span class="hljs-keyword">if</span> (!$isData) {
          out += <span class="hljs-string">' var '</span> + ($vSchema) + <span class="hljs-string">' = validate.schema'</span> + ($schemaPath) + <span class="hljs-string">'; '</span>;
        }
        <span class="hljs-keyword">var</span> $i = <span class="hljs-string">'i'</span> + $lvl,
          $propertyPath = <span class="hljs-string">'schema'</span> + $lvl + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>,
          $missingProperty = <span class="hljs-string">'\' + '</span> + $propertyPath + <span class="hljs-string">' + \''</span>;
        <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
          it.errorPath = it.util.getPathExpr($currentErrorPath, $propertyPath, it.opts.jsonPointers);
        }
        <span class="hljs-keyword">if</span> ($isData) {
          out += <span class="hljs-string">' if ('</span> + ($vSchema) + <span class="hljs-string">' &amp;&amp; !Array.isArray('</span> + ($vSchema) + <span class="hljs-string">')) {  var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
          <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'required'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\' } '</span>;
            <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
              out += <span class="hljs-string">' , message: \''</span>;
              <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
                out += <span class="hljs-string">'is a required property'</span>;
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">'should have required property \\\''</span> + ($missingProperty) + <span class="hljs-string">'\\\''</span>;
              }
              out += <span class="hljs-string">'\' '</span>;
            }
            <span class="hljs-keyword">if</span> (it.opts.verbose) {
              out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
            }
            out += <span class="hljs-string">' } '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' {} '</span>;
          }
          out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ('</span> + ($vSchema) + <span class="hljs-string">' !== undefined) { '</span>;
        }
        out += <span class="hljs-string">' for (var '</span> + ($i) + <span class="hljs-string">' = 0; '</span> + ($i) + <span class="hljs-string">' &lt; '</span> + ($vSchema) + <span class="hljs-string">'.length; '</span> + ($i) + <span class="hljs-string">'++) { if ('</span> + ($data) + <span class="hljs-string">'['</span> + ($vSchema) + <span class="hljs-string">'['</span> + ($i) + <span class="hljs-string">']] === undefined '</span>;
        <span class="hljs-keyword">if</span> ($ownProperties) {
          out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', '</span> + ($vSchema) + <span class="hljs-string">'['</span> + ($i) + <span class="hljs-string">']) '</span>;
        }
        out += <span class="hljs-string">') {  var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'required'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \''</span>;
            <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
              out += <span class="hljs-string">'is a required property'</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">'should have required property \\\''</span> + ($missingProperty) + <span class="hljs-string">'\\\''</span>;
            }
            out += <span class="hljs-string">'\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } '</span>;
        <span class="hljs-keyword">if</span> ($isData) {
          out += <span class="hljs-string">'  }  '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> arr3 = $required;
        <span class="hljs-keyword">if</span> (arr3) {
          <span class="hljs-keyword">var</span> $propertyKey, i3 = <span class="hljs-number">-1</span>,
            l3 = arr3.length - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span> (i3 &lt; l3) {
            $propertyKey = arr3[i3 += <span class="hljs-number">1</span>];
            <span class="hljs-keyword">var</span> $prop = it.util.getProperty($propertyKey),
              $missingProperty = it.util.escapeQuotes($propertyKey),
              $useData = $data + $prop;
            <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
              it.errorPath = it.util.getPath($currentErrorPath, $propertyKey, it.opts.jsonPointers);
            }
            out += <span class="hljs-string">' if ( '</span> + ($useData) + <span class="hljs-string">' === undefined '</span>;
            <span class="hljs-keyword">if</span> ($ownProperties) {
              out += <span class="hljs-string">' || ! Object.prototype.hasOwnProperty.call('</span> + ($data) + <span class="hljs-string">', \''</span> + (it.util.escapeQuotes($propertyKey)) + <span class="hljs-string">'\') '</span>;
            }
            out += <span class="hljs-string">') {  var err =   '</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
            <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
              out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'required'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { missingProperty: \''</span> + ($missingProperty) + <span class="hljs-string">'\' } '</span>;
              <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
                out += <span class="hljs-string">' , message: \''</span>;
                <span class="hljs-keyword">if</span> (it.opts._errorDataPathProperty) {
                  out += <span class="hljs-string">'is a required property'</span>;
                } <span class="hljs-keyword">else</span> {
                  out += <span class="hljs-string">'should have required property \\\''</span> + ($missingProperty) + <span class="hljs-string">'\\\''</span>;
                }
                out += <span class="hljs-string">'\' '</span>;
              }
              <span class="hljs-keyword">if</span> (it.opts.verbose) {
                out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
              }
              out += <span class="hljs-string">' } '</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">' {} '</span>;
            }
            out += <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } '</span>;
          }
        }
      }
    }
    it.errorPath = $currentErrorPath;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' if (true) {'</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">37</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_uniqueItems</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">' '</span>;
  <span class="hljs-keyword">var</span> $lvl = it.level;
  <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
  <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
  <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
  <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
  <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
  <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
  <span class="hljs-keyword">var</span> $isData = it.opts.$data &amp;&amp; $schema &amp;&amp; $schema.$data,
    $schemaValue;
  <span class="hljs-keyword">if</span> ($isData) {
    out += <span class="hljs-string">' var schema'</span> + ($lvl) + <span class="hljs-string">' = '</span> + (it.util.getData($schema.$data, $dataLvl, it.dataPathArr)) + <span class="hljs-string">'; '</span>;
    $schemaValue = <span class="hljs-string">'schema'</span> + $lvl;
  } <span class="hljs-keyword">else</span> {
    $schemaValue = $schema;
  }
  <span class="hljs-keyword">if</span> (($schema || $isData) &amp;&amp; it.opts.uniqueItems !== <span class="hljs-literal">false</span>) {
    <span class="hljs-keyword">if</span> ($isData) {
      out += <span class="hljs-string">' var '</span> + ($valid) + <span class="hljs-string">'; if ('</span> + ($schemaValue) + <span class="hljs-string">' === false || '</span> + ($schemaValue) + <span class="hljs-string">' === undefined) '</span> + ($valid) + <span class="hljs-string">' = true; else if (typeof '</span> + ($schemaValue) + <span class="hljs-string">' != \'boolean\') '</span> + ($valid) + <span class="hljs-string">' = false; else { '</span>;
    }
    out += <span class="hljs-string">' var i = '</span> + ($data) + <span class="hljs-string">'.length , '</span> + ($valid) + <span class="hljs-string">' = true , j; if (i &gt; 1) { '</span>;
    <span class="hljs-keyword">var</span> $itemType = it.schema.items &amp;&amp; it.schema.items.type,
      $typeIsArray = <span class="hljs-built_in">Array</span>.isArray($itemType);
    <span class="hljs-keyword">if</span> (!$itemType || $itemType == <span class="hljs-string">'object'</span> || $itemType == <span class="hljs-string">'array'</span> || ($typeIsArray &amp;&amp; ($itemType.indexOf(<span class="hljs-string">'object'</span>) &gt;= <span class="hljs-number">0</span> || $itemType.indexOf(<span class="hljs-string">'array'</span>) &gt;= <span class="hljs-number">0</span>))) {
      out += <span class="hljs-string">' outer: for (;i--;) { for (j = i; j--;) { if (equal('</span> + ($data) + <span class="hljs-string">'[i], '</span> + ($data) + <span class="hljs-string">'[j])) { '</span> + ($valid) + <span class="hljs-string">' = false; break outer; } } } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var itemIndices = {}, item; for (;i--;) { var item = '</span> + ($data) + <span class="hljs-string">'[i]; '</span>;
      <span class="hljs-keyword">var</span> $method = <span class="hljs-string">'checkDataType'</span> + ($typeIsArray ? <span class="hljs-string">'s'</span> : <span class="hljs-string">''</span>);
      out += <span class="hljs-string">' if ('</span> + (it.util[$method]($itemType, <span class="hljs-string">'item'</span>, it.opts.strictNumbers, <span class="hljs-literal">true</span>)) + <span class="hljs-string">') continue; '</span>;
      <span class="hljs-keyword">if</span> ($typeIsArray) {
        out += <span class="hljs-string">' if (typeof item == \'string\') item = \'"\' + item; '</span>;
      }
      out += <span class="hljs-string">' if (typeof itemIndices[item] == \'number\') { '</span> + ($valid) + <span class="hljs-string">' = false; j = itemIndices[item]; break; } itemIndices[item] = i; } '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> ($isData) {
      out += <span class="hljs-string">'  }  '</span>;
    }
    out += <span class="hljs-string">' if (!'</span> + ($valid) + <span class="hljs-string">') {   '</span>;
    <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
    $$outStack.push(out);
    out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
    <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
      out += <span class="hljs-string">' { keyword: \''</span> + (<span class="hljs-string">'uniqueItems'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { i: i, j: j } '</span>;
      <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' , message: \'should NOT have duplicate items (items ## \' + j + \' and \' + i + \' are identical)\' '</span>;
      }
      <span class="hljs-keyword">if</span> (it.opts.verbose) {
        out += <span class="hljs-string">' , schema:  '</span>;
        <span class="hljs-keyword">if</span> ($isData) {
          out += <span class="hljs-string">'validate.schema'</span> + ($schemaPath);
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">''</span> + ($schema);
        }
        out += <span class="hljs-string">'         , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
      }
      out += <span class="hljs-string">' } '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' {} '</span>;
    }
    <span class="hljs-keyword">var</span> __err = out;
    out = $$outStack.pop();
    <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
      <span class="hljs-comment">/* istanbul ignore if */</span>
      <span class="hljs-keyword">if</span> (it.async) {
        out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
    }
    out += <span class="hljs-string">' } '</span>;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' else { '</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' if (true) { '</span>;
    }
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">38</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generate_validate</span>(<span class="hljs-params">it, $keyword, $ruleType</span>) </span>{
  <span class="hljs-keyword">var</span> out = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> $<span class="hljs-keyword">async</span> = it.schema.$<span class="hljs-keyword">async</span> === <span class="hljs-literal">true</span>,
    $refKeywords = it.util.schemaHasRulesExcept(it.schema, it.RULES.all, <span class="hljs-string">'$ref'</span>),
    $id = it.self._getId(it.schema);
  <span class="hljs-keyword">if</span> (it.opts.strictKeywords) {
    <span class="hljs-keyword">var</span> $unknownKwd = it.util.schemaUnknownRules(it.schema, it.RULES.keywords);
    <span class="hljs-keyword">if</span> ($unknownKwd) {
      <span class="hljs-keyword">var</span> $keywordsMsg = <span class="hljs-string">'unknown keyword: '</span> + $unknownKwd;
      <span class="hljs-keyword">if</span> (it.opts.strictKeywords === <span class="hljs-string">'log'</span>) it.logger.warn($keywordsMsg);
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($keywordsMsg);
    }
  }
  <span class="hljs-keyword">if</span> (it.isTop) {
    out += <span class="hljs-string">' var validate = '</span>;
    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span>) {
      it.async = <span class="hljs-literal">true</span>;
      out += <span class="hljs-string">'async '</span>;
    }
    out += <span class="hljs-string">'function(data, dataPath, parentData, parentDataProperty, rootData) { \'use strict\'; '</span>;
    <span class="hljs-keyword">if</span> ($id &amp;&amp; (it.opts.sourceCode || it.opts.processCode)) {
      out += <span class="hljs-string">' '</span> + (<span class="hljs-string">'/\*# sourceURL='</span> + $id + <span class="hljs-string">' */'</span>) + <span class="hljs-string">' '</span>;
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> it.schema == <span class="hljs-string">'boolean'</span> || !($refKeywords || it.schema.$ref)) {
    <span class="hljs-keyword">var</span> $keyword = <span class="hljs-string">'false schema'</span>;
    <span class="hljs-keyword">var</span> $lvl = it.level;
    <span class="hljs-keyword">var</span> $dataLvl = it.dataLevel;
    <span class="hljs-keyword">var</span> $schema = it.schema[$keyword];
    <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + it.util.getProperty($keyword);
    <span class="hljs-keyword">var</span> $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/'</span> + $keyword;
    <span class="hljs-keyword">var</span> $breakOnError = !it.opts.allErrors;
    <span class="hljs-keyword">var</span> $errorKeyword;
    <span class="hljs-keyword">var</span> $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
    <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl;
    <span class="hljs-keyword">if</span> (it.schema === <span class="hljs-literal">false</span>) {
      <span class="hljs-keyword">if</span> (it.isTop) {
        $breakOnError = <span class="hljs-literal">true</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' var '</span> + ($valid) + <span class="hljs-string">' = false; '</span>;
      }
      <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
      $$outStack.push(out);
      out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
      <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
        out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'false schema'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: {} '</span>;
        <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' , message: \'boolean schema is false\' '</span>;
        }
        <span class="hljs-keyword">if</span> (it.opts.verbose) {
          out += <span class="hljs-string">' , schema: false , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
        }
        out += <span class="hljs-string">' } '</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' {} '</span>;
      }
      <span class="hljs-keyword">var</span> __err = out;
      out = $$outStack.pop();
      <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
        <span class="hljs-comment">/* istanbul ignore if */</span>
        <span class="hljs-keyword">if</span> (it.async) {
          out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">if</span> (it.isTop) {
        <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span>) {
          out += <span class="hljs-string">' return data; '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' validate.errors = null; return true; '</span>;
        }
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">' var '</span> + ($valid) + <span class="hljs-string">' = true; '</span>;
      }
    }
    <span class="hljs-keyword">if</span> (it.isTop) {
      out += <span class="hljs-string">' }; return validate; '</span>;
    }
    <span class="hljs-keyword">return</span> out;
  }
  <span class="hljs-keyword">if</span> (it.isTop) {
    <span class="hljs-keyword">var</span> $top = it.isTop,
      $lvl = it.level = <span class="hljs-number">0</span>,
      $dataLvl = it.dataLevel = <span class="hljs-number">0</span>,
      $data = <span class="hljs-string">'data'</span>;
    it.rootId = it.resolve.fullPath(it.self._getId(it.root.schema));
    it.baseId = it.baseId || it.rootId;
    <span class="hljs-keyword">delete</span> it.isTop;
    it.dataPathArr = [<span class="hljs-string">""</span>];
    <span class="hljs-keyword">if</span> (it.schema.default !== <span class="hljs-literal">undefined</span> &amp;&amp; it.opts.useDefaults &amp;&amp; it.opts.strictDefaults) {
      <span class="hljs-keyword">var</span> $defaultMsg = <span class="hljs-string">'default is ignored in the schema root'</span>;
      <span class="hljs-keyword">if</span> (it.opts.strictDefaults === <span class="hljs-string">'log'</span>) it.logger.warn($defaultMsg);
      <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($defaultMsg);
    }
    out += <span class="hljs-string">' var vErrors = null; '</span>;
    out += <span class="hljs-string">' var errors = 0;     '</span>;
    out += <span class="hljs-string">' if (rootData === undefined) rootData = data; '</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> $lvl = it.level,
      $dataLvl = it.dataLevel,
      $data = <span class="hljs-string">'data'</span> + ($dataLvl || <span class="hljs-string">''</span>);
    <span class="hljs-keyword">if</span> ($id) it.baseId = it.resolve.url(it.baseId, $id);
    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span> &amp;&amp; !it.async) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'async schema in sync schema'</span>);
    out += <span class="hljs-string">' var errs_'</span> + ($lvl) + <span class="hljs-string">' = errors;'</span>;
  }
  <span class="hljs-keyword">var</span> $valid = <span class="hljs-string">'valid'</span> + $lvl,
    $breakOnError = !it.opts.allErrors,
    $closingBraces1 = <span class="hljs-string">''</span>,
    $closingBraces2 = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">var</span> $errorKeyword;
  <span class="hljs-keyword">var</span> $typeSchema = it.schema.type,
    $typeIsArray = <span class="hljs-built_in">Array</span>.isArray($typeSchema);
  <span class="hljs-keyword">if</span> ($typeSchema &amp;&amp; it.opts.nullable &amp;&amp; it.schema.nullable === <span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">if</span> ($typeIsArray) {
      <span class="hljs-keyword">if</span> ($typeSchema.indexOf(<span class="hljs-string">'null'</span>) == <span class="hljs-number">-1</span>) $typeSchema = $typeSchema.concat(<span class="hljs-string">'null'</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($typeSchema != <span class="hljs-string">'null'</span>) {
      $typeSchema = [$typeSchema, <span class="hljs-string">'null'</span>];
      $typeIsArray = <span class="hljs-literal">true</span>;
    }
  }
  <span class="hljs-keyword">if</span> ($typeIsArray &amp;&amp; $typeSchema.length == <span class="hljs-number">1</span>) {
    $typeSchema = $typeSchema[<span class="hljs-number">0</span>];
    $typeIsArray = <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">if</span> (it.schema.$ref &amp;&amp; $refKeywords) {
    <span class="hljs-keyword">if</span> (it.opts.extendRefs == <span class="hljs-string">'fail'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'$ref: validation keywords used in schema at path "'</span> + it.errSchemaPath + <span class="hljs-string">'" (see option extendRefs)'</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (it.opts.extendRefs !== <span class="hljs-literal">true</span>) {
      $refKeywords = <span class="hljs-literal">false</span>;
      it.logger.warn(<span class="hljs-string">'$ref: keywords ignored in schema at path "'</span> + it.errSchemaPath + <span class="hljs-string">'"'</span>);
    }
  }
  <span class="hljs-keyword">if</span> (it.schema.$comment &amp;&amp; it.opts.$comment) {
    out += <span class="hljs-string">' '</span> + (it.RULES.all.$comment.code(it, <span class="hljs-string">'$comment'</span>));
  }
  <span class="hljs-keyword">if</span> ($typeSchema) {
    <span class="hljs-keyword">if</span> (it.opts.coerceTypes) {
      <span class="hljs-keyword">var</span> $coerceToTypes = it.util.coerceToTypes(it.opts.coerceTypes, $typeSchema);
    }
    <span class="hljs-keyword">var</span> $rulesGroup = it.RULES.types[$typeSchema];
    <span class="hljs-keyword">if</span> ($coerceToTypes || $typeIsArray || $rulesGroup === <span class="hljs-literal">true</span> || ($rulesGroup &amp;&amp; !$shouldUseGroup($rulesGroup))) {
      <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + <span class="hljs-string">'.type'</span>,
        $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/type'</span>;
      <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + <span class="hljs-string">'.type'</span>,
        $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/type'</span>,
        $method = $typeIsArray ? <span class="hljs-string">'checkDataTypes'</span> : <span class="hljs-string">'checkDataType'</span>;
      out += <span class="hljs-string">' if ('</span> + (it.util[$method]($typeSchema, $data, it.opts.strictNumbers, <span class="hljs-literal">true</span>)) + <span class="hljs-string">') { '</span>;
      <span class="hljs-keyword">if</span> ($coerceToTypes) {
        <span class="hljs-keyword">var</span> $dataType = <span class="hljs-string">'dataType'</span> + $lvl,
          $coerced = <span class="hljs-string">'coerced'</span> + $lvl;
        out += <span class="hljs-string">' var '</span> + ($dataType) + <span class="hljs-string">' = typeof '</span> + ($data) + <span class="hljs-string">'; var '</span> + ($coerced) + <span class="hljs-string">' = undefined; '</span>;
        <span class="hljs-keyword">if</span> (it.opts.coerceTypes == <span class="hljs-string">'array'</span>) {
          out += <span class="hljs-string">' if ('</span> + ($dataType) + <span class="hljs-string">' == \'object\' &amp;&amp; Array.isArray('</span> + ($data) + <span class="hljs-string">') &amp;&amp; '</span> + ($data) + <span class="hljs-string">'.length == 1) { '</span> + ($data) + <span class="hljs-string">' = '</span> + ($data) + <span class="hljs-string">'[0]; '</span> + ($dataType) + <span class="hljs-string">' = typeof '</span> + ($data) + <span class="hljs-string">'; if ('</span> + (it.util.checkDataType(it.schema.type, $data, it.opts.strictNumbers)) + <span class="hljs-string">') '</span> + ($coerced) + <span class="hljs-string">' = '</span> + ($data) + <span class="hljs-string">'; } '</span>;
        }
        out += <span class="hljs-string">' if ('</span> + ($coerced) + <span class="hljs-string">' !== undefined) ; '</span>;
        <span class="hljs-keyword">var</span> arr1 = $coerceToTypes;
        <span class="hljs-keyword">if</span> (arr1) {
          <span class="hljs-keyword">var</span> $type, $i = <span class="hljs-number">-1</span>,
            l1 = arr1.length - <span class="hljs-number">1</span>;
          <span class="hljs-keyword">while</span> ($i &lt; l1) {
            $type = arr1[$i += <span class="hljs-number">1</span>];
            <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'string'</span>) {
              out += <span class="hljs-string">' else if ('</span> + ($dataType) + <span class="hljs-string">' == \'number\' || '</span> + ($dataType) + <span class="hljs-string">' == \'boolean\') '</span> + ($coerced) + <span class="hljs-string">' = \'\' + '</span> + ($data) + <span class="hljs-string">'; else if ('</span> + ($data) + <span class="hljs-string">' === null) '</span> + ($coerced) + <span class="hljs-string">' = \'\'; '</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'number'</span> || $type == <span class="hljs-string">'integer'</span>) {
              out += <span class="hljs-string">' else if ('</span> + ($dataType) + <span class="hljs-string">' == \'boolean\' || '</span> + ($data) + <span class="hljs-string">' === null || ('</span> + ($dataType) + <span class="hljs-string">' == \'string\' &amp;&amp; '</span> + ($data) + <span class="hljs-string">' &amp;&amp; '</span> + ($data) + <span class="hljs-string">' == +'</span> + ($data) + <span class="hljs-string">' '</span>;
              <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'integer'</span>) {
                out += <span class="hljs-string">' &amp;&amp; !('</span> + ($data) + <span class="hljs-string">' % 1)'</span>;
              }
              out += <span class="hljs-string">')) '</span> + ($coerced) + <span class="hljs-string">' = +'</span> + ($data) + <span class="hljs-string">'; '</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'boolean'</span>) {
              out += <span class="hljs-string">' else if ('</span> + ($data) + <span class="hljs-string">' === \'false\' || '</span> + ($data) + <span class="hljs-string">' === 0 || '</span> + ($data) + <span class="hljs-string">' === null) '</span> + ($coerced) + <span class="hljs-string">' = false; else if ('</span> + ($data) + <span class="hljs-string">' === \'true\' || '</span> + ($data) + <span class="hljs-string">' === 1) '</span> + ($coerced) + <span class="hljs-string">' = true; '</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($type == <span class="hljs-string">'null'</span>) {
              out += <span class="hljs-string">' else if ('</span> + ($data) + <span class="hljs-string">' === \'\' || '</span> + ($data) + <span class="hljs-string">' === 0 || '</span> + ($data) + <span class="hljs-string">' === false) '</span> + ($coerced) + <span class="hljs-string">' = null; '</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (it.opts.coerceTypes == <span class="hljs-string">'array'</span> &amp;&amp; $type == <span class="hljs-string">'array'</span>) {
              out += <span class="hljs-string">' else if ('</span> + ($dataType) + <span class="hljs-string">' == \'string\' || '</span> + ($dataType) + <span class="hljs-string">' == \'number\' || '</span> + ($dataType) + <span class="hljs-string">' == \'boolean\' || '</span> + ($data) + <span class="hljs-string">' == null) '</span> + ($coerced) + <span class="hljs-string">' = ['</span> + ($data) + <span class="hljs-string">']; '</span>;
            }
          }
        }
        out += <span class="hljs-string">' else {   '</span>;
        <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
        $$outStack.push(out);
        out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'type'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { type: \''</span>;
          <span class="hljs-keyword">if</span> ($typeIsArray) {
            out += <span class="hljs-string">''</span> + ($typeSchema.join(<span class="hljs-string">","</span>));
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">''</span> + ($typeSchema);
          }
          out += <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \'should be '</span>;
            <span class="hljs-keyword">if</span> ($typeIsArray) {
              out += <span class="hljs-string">''</span> + ($typeSchema.join(<span class="hljs-string">","</span>));
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">''</span> + ($typeSchema);
            }
            out += <span class="hljs-string">'\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        <span class="hljs-keyword">var</span> __err = out;
        out = $$outStack.pop();
        <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (it.async) {
            out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
          }
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
        }
        out += <span class="hljs-string">' } if ('</span> + ($coerced) + <span class="hljs-string">' !== undefined) {  '</span>;
        <span class="hljs-keyword">var</span> $parentData = $dataLvl ? <span class="hljs-string">'data'</span> + (($dataLvl - <span class="hljs-number">1</span>) || <span class="hljs-string">''</span>) : <span class="hljs-string">'parentData'</span>,
          $parentDataProperty = $dataLvl ? it.dataPathArr[$dataLvl] : <span class="hljs-string">'parentDataProperty'</span>;
        out += <span class="hljs-string">' '</span> + ($data) + <span class="hljs-string">' = '</span> + ($coerced) + <span class="hljs-string">'; '</span>;
        <span class="hljs-keyword">if</span> (!$dataLvl) {
          out += <span class="hljs-string">'if ('</span> + ($parentData) + <span class="hljs-string">' !== undefined)'</span>;
        }
        out += <span class="hljs-string">' '</span> + ($parentData) + <span class="hljs-string">'['</span> + ($parentDataProperty) + <span class="hljs-string">'] = '</span> + ($coerced) + <span class="hljs-string">'; } '</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
        $$outStack.push(out);
        out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
        <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
          out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'type'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { type: \''</span>;
          <span class="hljs-keyword">if</span> ($typeIsArray) {
            out += <span class="hljs-string">''</span> + ($typeSchema.join(<span class="hljs-string">","</span>));
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">''</span> + ($typeSchema);
          }
          out += <span class="hljs-string">'\' } '</span>;
          <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
            out += <span class="hljs-string">' , message: \'should be '</span>;
            <span class="hljs-keyword">if</span> ($typeIsArray) {
              out += <span class="hljs-string">''</span> + ($typeSchema.join(<span class="hljs-string">","</span>));
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">''</span> + ($typeSchema);
            }
            out += <span class="hljs-string">'\' '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.verbose) {
            out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
          }
          out += <span class="hljs-string">' } '</span>;
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' {} '</span>;
        }
        <span class="hljs-keyword">var</span> __err = out;
        out = $$outStack.pop();
        <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
          <span class="hljs-comment">/* istanbul ignore if */</span>
          <span class="hljs-keyword">if</span> (it.async) {
            out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
          } <span class="hljs-keyword">else</span> {
            out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
          }
        } <span class="hljs-keyword">else</span> {
          out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
        }
      }
      out += <span class="hljs-string">' } '</span>;
    }
  }
  <span class="hljs-keyword">if</span> (it.schema.$ref &amp;&amp; !$refKeywords) {
    out += <span class="hljs-string">' '</span> + (it.RULES.all.$ref.code(it, <span class="hljs-string">'$ref'</span>)) + <span class="hljs-string">' '</span>;
    <span class="hljs-keyword">if</span> ($breakOnError) {
      out += <span class="hljs-string">' } if (errors === '</span>;
      <span class="hljs-keyword">if</span> ($top) {
        out += <span class="hljs-string">'0'</span>;
      } <span class="hljs-keyword">else</span> {
        out += <span class="hljs-string">'errs_'</span> + ($lvl);
      }
      out += <span class="hljs-string">') { '</span>;
      $closingBraces2 += <span class="hljs-string">'}'</span>;
    }
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> arr2 = it.RULES;
    <span class="hljs-keyword">if</span> (arr2) {
      <span class="hljs-keyword">var</span> $rulesGroup, i2 = <span class="hljs-number">-1</span>,
        l2 = arr2.length - <span class="hljs-number">1</span>;
      <span class="hljs-keyword">while</span> (i2 &lt; l2) {
        $rulesGroup = arr2[i2 += <span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> ($shouldUseGroup($rulesGroup)) {
          <span class="hljs-keyword">if</span> ($rulesGroup.type) {
            out += <span class="hljs-string">' if ('</span> + (it.util.checkDataType($rulesGroup.type, $data, it.opts.strictNumbers)) + <span class="hljs-string">') { '</span>;
          }
          <span class="hljs-keyword">if</span> (it.opts.useDefaults) {
            <span class="hljs-keyword">if</span> ($rulesGroup.type == <span class="hljs-string">'object'</span> &amp;&amp; it.schema.properties) {
              <span class="hljs-keyword">var</span> $schema = it.schema.properties,
                $schemaKeys = <span class="hljs-built_in">Object</span>.keys($schema);
              <span class="hljs-keyword">var</span> arr3 = $schemaKeys;
              <span class="hljs-keyword">if</span> (arr3) {
                <span class="hljs-keyword">var</span> $propertyKey, i3 = <span class="hljs-number">-1</span>,
                  l3 = arr3.length - <span class="hljs-number">1</span>;
                <span class="hljs-keyword">while</span> (i3 &lt; l3) {
                  $propertyKey = arr3[i3 += <span class="hljs-number">1</span>];
                  <span class="hljs-keyword">var</span> $sch = $schema[$propertyKey];
                  <span class="hljs-keyword">if</span> ($sch.default !== <span class="hljs-literal">undefined</span>) {
                    <span class="hljs-keyword">var</span> $passData = $data + it.util.getProperty($propertyKey);
                    <span class="hljs-keyword">if</span> (it.compositeRule) {
                      <span class="hljs-keyword">if</span> (it.opts.strictDefaults) {
                        <span class="hljs-keyword">var</span> $defaultMsg = <span class="hljs-string">'default is ignored for: '</span> + $passData;
                        <span class="hljs-keyword">if</span> (it.opts.strictDefaults === <span class="hljs-string">'log'</span>) it.logger.warn($defaultMsg);
                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($defaultMsg);
                      }
                    } <span class="hljs-keyword">else</span> {
                      out += <span class="hljs-string">' if ('</span> + ($passData) + <span class="hljs-string">' === undefined '</span>;
                      <span class="hljs-keyword">if</span> (it.opts.useDefaults == <span class="hljs-string">'empty'</span>) {
                        out += <span class="hljs-string">' || '</span> + ($passData) + <span class="hljs-string">' === null || '</span> + ($passData) + <span class="hljs-string">' === \'\' '</span>;
                      }
                      out += <span class="hljs-string">' ) '</span> + ($passData) + <span class="hljs-string">' = '</span>;
                      <span class="hljs-keyword">if</span> (it.opts.useDefaults == <span class="hljs-string">'shared'</span>) {
                        out += <span class="hljs-string">' '</span> + (it.useDefault($sch.default)) + <span class="hljs-string">' '</span>;
                      } <span class="hljs-keyword">else</span> {
                        out += <span class="hljs-string">' '</span> + (<span class="hljs-built_in">JSON</span>.stringify($sch.default)) + <span class="hljs-string">' '</span>;
                      }
                      out += <span class="hljs-string">'; '</span>;
                    }
                  }
                }
              }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ($rulesGroup.type == <span class="hljs-string">'array'</span> &amp;&amp; <span class="hljs-built_in">Array</span>.isArray(it.schema.items)) {
              <span class="hljs-keyword">var</span> arr4 = it.schema.items;
              <span class="hljs-keyword">if</span> (arr4) {
                <span class="hljs-keyword">var</span> $sch, $i = <span class="hljs-number">-1</span>,
                  l4 = arr4.length - <span class="hljs-number">1</span>;
                <span class="hljs-keyword">while</span> ($i &lt; l4) {
                  $sch = arr4[$i += <span class="hljs-number">1</span>];
                  <span class="hljs-keyword">if</span> ($sch.default !== <span class="hljs-literal">undefined</span>) {
                    <span class="hljs-keyword">var</span> $passData = $data + <span class="hljs-string">'['</span> + $i + <span class="hljs-string">']'</span>;
                    <span class="hljs-keyword">if</span> (it.compositeRule) {
                      <span class="hljs-keyword">if</span> (it.opts.strictDefaults) {
                        <span class="hljs-keyword">var</span> $defaultMsg = <span class="hljs-string">'default is ignored for: '</span> + $passData;
                        <span class="hljs-keyword">if</span> (it.opts.strictDefaults === <span class="hljs-string">'log'</span>) it.logger.warn($defaultMsg);
                        <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>($defaultMsg);
                      }
                    } <span class="hljs-keyword">else</span> {
                      out += <span class="hljs-string">' if ('</span> + ($passData) + <span class="hljs-string">' === undefined '</span>;
                      <span class="hljs-keyword">if</span> (it.opts.useDefaults == <span class="hljs-string">'empty'</span>) {
                        out += <span class="hljs-string">' || '</span> + ($passData) + <span class="hljs-string">' === null || '</span> + ($passData) + <span class="hljs-string">' === \'\' '</span>;
                      }
                      out += <span class="hljs-string">' ) '</span> + ($passData) + <span class="hljs-string">' = '</span>;
                      <span class="hljs-keyword">if</span> (it.opts.useDefaults == <span class="hljs-string">'shared'</span>) {
                        out += <span class="hljs-string">' '</span> + (it.useDefault($sch.default)) + <span class="hljs-string">' '</span>;
                      } <span class="hljs-keyword">else</span> {
                        out += <span class="hljs-string">' '</span> + (<span class="hljs-built_in">JSON</span>.stringify($sch.default)) + <span class="hljs-string">' '</span>;
                      }
                      out += <span class="hljs-string">'; '</span>;
                    }
                  }
                }
              }
            }
          }
          <span class="hljs-keyword">var</span> arr5 = $rulesGroup.rules;
          <span class="hljs-keyword">if</span> (arr5) {
            <span class="hljs-keyword">var</span> $rule, i5 = <span class="hljs-number">-1</span>,
              l5 = arr5.length - <span class="hljs-number">1</span>;
            <span class="hljs-keyword">while</span> (i5 &lt; l5) {
              $rule = arr5[i5 += <span class="hljs-number">1</span>];
              <span class="hljs-keyword">if</span> ($shouldUseRule($rule)) {
                <span class="hljs-keyword">var</span> $code = $rule.code(it, $rule.keyword, $rulesGroup.type);
                <span class="hljs-keyword">if</span> ($code) {
                  out += <span class="hljs-string">' '</span> + ($code) + <span class="hljs-string">' '</span>;
                  <span class="hljs-keyword">if</span> ($breakOnError) {
                    $closingBraces1 += <span class="hljs-string">'}'</span>;
                  }
                }
              }
            }
          }
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' '</span> + ($closingBraces1) + <span class="hljs-string">' '</span>;
            $closingBraces1 = <span class="hljs-string">''</span>;
          }
          <span class="hljs-keyword">if</span> ($rulesGroup.type) {
            out += <span class="hljs-string">' } '</span>;
            <span class="hljs-keyword">if</span> ($typeSchema &amp;&amp; $typeSchema === $rulesGroup.type &amp;&amp; !$coerceToTypes) {
              out += <span class="hljs-string">' else { '</span>;
              <span class="hljs-keyword">var</span> $schemaPath = it.schemaPath + <span class="hljs-string">'.type'</span>,
                $errSchemaPath = it.errSchemaPath + <span class="hljs-string">'/type'</span>;
              <span class="hljs-keyword">var</span> $$outStack = $$outStack || [];
              $$outStack.push(out);
              out = <span class="hljs-string">''</span>; <span class="hljs-comment">/* istanbul ignore else */</span>
              <span class="hljs-keyword">if</span> (it.createErrors !== <span class="hljs-literal">false</span>) {
                out += <span class="hljs-string">' { keyword: \''</span> + ($errorKeyword || <span class="hljs-string">'type'</span>) + <span class="hljs-string">'\' , dataPath: (dataPath || \'\') + '</span> + (it.errorPath) + <span class="hljs-string">' , schemaPath: '</span> + (it.util.toQuotedString($errSchemaPath)) + <span class="hljs-string">' , params: { type: \''</span>;
                <span class="hljs-keyword">if</span> ($typeIsArray) {
                  out += <span class="hljs-string">''</span> + ($typeSchema.join(<span class="hljs-string">","</span>));
                } <span class="hljs-keyword">else</span> {
                  out += <span class="hljs-string">''</span> + ($typeSchema);
                }
                out += <span class="hljs-string">'\' } '</span>;
                <span class="hljs-keyword">if</span> (it.opts.messages !== <span class="hljs-literal">false</span>) {
                  out += <span class="hljs-string">' , message: \'should be '</span>;
                  <span class="hljs-keyword">if</span> ($typeIsArray) {
                    out += <span class="hljs-string">''</span> + ($typeSchema.join(<span class="hljs-string">","</span>));
                  } <span class="hljs-keyword">else</span> {
                    out += <span class="hljs-string">''</span> + ($typeSchema);
                  }
                  out += <span class="hljs-string">'\' '</span>;
                }
                <span class="hljs-keyword">if</span> (it.opts.verbose) {
                  out += <span class="hljs-string">' , schema: validate.schema'</span> + ($schemaPath) + <span class="hljs-string">' , parentSchema: validate.schema'</span> + (it.schemaPath) + <span class="hljs-string">' , data: '</span> + ($data) + <span class="hljs-string">' '</span>;
                }
                out += <span class="hljs-string">' } '</span>;
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">' {} '</span>;
              }
              <span class="hljs-keyword">var</span> __err = out;
              out = $$outStack.pop();
              <span class="hljs-keyword">if</span> (!it.compositeRule &amp;&amp; $breakOnError) {
                <span class="hljs-comment">/* istanbul ignore if */</span>
                <span class="hljs-keyword">if</span> (it.async) {
                  out += <span class="hljs-string">' throw new ValidationError(['</span> + (__err) + <span class="hljs-string">']); '</span>;
                } <span class="hljs-keyword">else</span> {
                  out += <span class="hljs-string">' validate.errors = ['</span> + (__err) + <span class="hljs-string">']; return false; '</span>;
                }
              } <span class="hljs-keyword">else</span> {
                out += <span class="hljs-string">' var err = '</span> + (__err) + <span class="hljs-string">';  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; '</span>;
              }
              out += <span class="hljs-string">' } '</span>;
            }
          }
          <span class="hljs-keyword">if</span> ($breakOnError) {
            out += <span class="hljs-string">' if (errors === '</span>;
            <span class="hljs-keyword">if</span> ($top) {
              out += <span class="hljs-string">'0'</span>;
            } <span class="hljs-keyword">else</span> {
              out += <span class="hljs-string">'errs_'</span> + ($lvl);
            }
            out += <span class="hljs-string">') { '</span>;
            $closingBraces2 += <span class="hljs-string">'}'</span>;
          }
        }
      }
    }
  }
  <span class="hljs-keyword">if</span> ($breakOnError) {
    out += <span class="hljs-string">' '</span> + ($closingBraces2) + <span class="hljs-string">' '</span>;
  }
  <span class="hljs-keyword">if</span> ($top) {
    <span class="hljs-keyword">if</span> ($<span class="hljs-keyword">async</span>) {
      out += <span class="hljs-string">' if (errors === 0) return data;           '</span>;
      out += <span class="hljs-string">' else throw new ValidationError(vErrors); '</span>;
    } <span class="hljs-keyword">else</span> {
      out += <span class="hljs-string">' validate.errors = vErrors; '</span>;
      out += <span class="hljs-string">' return errors === 0;       '</span>;
    }
    out += <span class="hljs-string">' }; return validate;'</span>;
  } <span class="hljs-keyword">else</span> {
    out += <span class="hljs-string">' var '</span> + ($valid) + <span class="hljs-string">' = errors === errs_'</span> + ($lvl) + <span class="hljs-string">';'</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$shouldUseGroup</span>(<span class="hljs-params">$rulesGroup</span>) </span>{
    <span class="hljs-keyword">var</span> rules = $rulesGroup.rules;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; rules.length; i++)
      <span class="hljs-keyword">if</span> ($shouldUseRule(rules[i])) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$shouldUseRule</span>(<span class="hljs-params">$rule</span>) </span>{
    <span class="hljs-keyword">return</span> it.schema[$rule.keyword] !== <span class="hljs-literal">undefined</span> || ($rule.implements &amp;&amp; $ruleImplementsSomeKeyword($rule));
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$ruleImplementsSomeKeyword</span>(<span class="hljs-params">$rule</span>) </span>{
    <span class="hljs-keyword">var</span> impl = $rule.implements;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; impl.length; i++)
      <span class="hljs-keyword">if</span> (it.schema[impl[i]] !== <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> out;
}

},{}],<span class="hljs-number">39</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> IDENTIFIER = <span class="hljs-regexp">/^[a-z_$][a-z0-9_$-]*$/i</span>;
<span class="hljs-keyword">var</span> customRuleCode = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./dotjs/custom'</span>);
<span class="hljs-keyword">var</span> definitionSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./definition_schema'</span>);

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">add</span>: addKeyword,
  <span class="hljs-attr">get</span>: getKeyword,
  <span class="hljs-attr">remove</span>: removeKeyword,
  <span class="hljs-attr">validate</span>: validateKeyword
};


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-30" id="section-30"></a>
</div>
<div class="dox">
<div class="summary">
<p>Define custom keyword</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">keyword</span>
<span class="dox_type">String</span>
<span>custom keyword, should be unique (including different from all standard, custom and macro keywords).
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">definition</span>
<span class="dox_type">Object</span>
<span>keyword definition object with properties <code>type</code> (type(s) which the keyword applies to), <code>validate</code> or <code>compile</code>.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Ajv</span>
<span>this for method chaining
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addKeyword</span>(<span class="hljs-params">keyword, definition</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-comment">/* eslint no-shadow: 0 */</span>
  <span class="hljs-keyword">var</span> RULES = <span class="hljs-keyword">this</span>.RULES;
  <span class="hljs-keyword">if</span> (RULES.keywords[keyword])
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Keyword '</span> + keyword + <span class="hljs-string">' is already defined'</span>);

  <span class="hljs-keyword">if</span> (!IDENTIFIER.test(keyword))
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Keyword '</span> + keyword + <span class="hljs-string">' is not a valid identifier'</span>);

  <span class="hljs-keyword">if</span> (definition) {
    <span class="hljs-keyword">this</span>.validateKeyword(definition, <span class="hljs-literal">true</span>);

    <span class="hljs-keyword">var</span> dataType = definition.type;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(dataType)) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;dataType.length; i++)
        _addRule(keyword, dataType[i], definition);
    } <span class="hljs-keyword">else</span> {
      _addRule(keyword, dataType, definition);
    }

    <span class="hljs-keyword">var</span> metaSchema = definition.metaSchema;
    <span class="hljs-keyword">if</span> (metaSchema) {
      <span class="hljs-keyword">if</span> (definition.$data &amp;&amp; <span class="hljs-keyword">this</span>._opts.$data) {
        metaSchema = {
          <span class="hljs-attr">anyOf</span>: [
            metaSchema,
            { <span class="hljs-string">'$ref'</span>: <span class="hljs-string">'https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#'</span> }
          ]
        };
      }
      definition.validateSchema = <span class="hljs-keyword">this</span>.compile(metaSchema, <span class="hljs-literal">true</span>);
    }
  }

  RULES.keywords[keyword] = RULES.all[keyword] = <span class="hljs-literal">true</span>;


  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_addRule</span>(<span class="hljs-params">keyword, dataType, definition</span>) </span>{
    <span class="hljs-keyword">var</span> ruleGroup;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;RULES.length; i++) {
      <span class="hljs-keyword">var</span> rg = RULES[i];
      <span class="hljs-keyword">if</span> (rg.type == dataType) {
        ruleGroup = rg;
        <span class="hljs-keyword">break</span>;
      }
    }

    <span class="hljs-keyword">if</span> (!ruleGroup) {
      ruleGroup = { <span class="hljs-attr">type</span>: dataType, <span class="hljs-attr">rules</span>: [] };
      RULES.push(ruleGroup);
    }

    <span class="hljs-keyword">var</span> rule = {
      <span class="hljs-attr">keyword</span>: keyword,
      <span class="hljs-attr">definition</span>: definition,
      <span class="hljs-attr">custom</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">code</span>: customRuleCode,
      <span class="hljs-attr">implements</span>: definition.implements
    };
    ruleGroup.rules.push(rule);
    RULES.custom[keyword] = rule;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-31" id="section-31"></a>
</div>
<div class="dox">
<div class="summary">
<p>Get keyword</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">keyword</span>
<span class="dox_type">String</span>
<span>pre-defined or custom keyword.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Object</span>
<span class="dox_type">Boolean</span>
<span>custom keyword definition, <code>true</code> if it is a predefined keyword, <code>false</code> otherwise.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getKeyword</span>(<span class="hljs-params">keyword</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> rule = <span class="hljs-keyword">this</span>.RULES.custom[keyword];
  <span class="hljs-keyword">return</span> rule ? rule.definition : <span class="hljs-keyword">this</span>.RULES.keywords[keyword] || <span class="hljs-literal">false</span>;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-32" id="section-32"></a>
</div>
<div class="dox">
<div class="summary">
<p>Remove keyword</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">keyword</span>
<span class="dox_type">String</span>
<span>pre-defined or custom keyword.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Ajv</span>
<span>this for method chaining
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeKeyword</span>(<span class="hljs-params">keyword</span>) </span>{
  <span class="hljs-comment">/* jshint validthis: true */</span>
  <span class="hljs-keyword">var</span> RULES = <span class="hljs-keyword">this</span>.RULES;
  <span class="hljs-keyword">delete</span> RULES.keywords[keyword];
  <span class="hljs-keyword">delete</span> RULES.all[keyword];
  <span class="hljs-keyword">delete</span> RULES.custom[keyword];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;RULES.length; i++) {
    <span class="hljs-keyword">var</span> rules = RULES[i].rules;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j=<span class="hljs-number">0</span>; j&lt;rules.length; j++) {
      <span class="hljs-keyword">if</span> (rules[j].keyword == keyword) {
        rules.splice(j, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">break</span>;
      }
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-33" id="section-33"></a>
</div>
<div class="dox">
<div class="summary">
<p>Validate keyword definition</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">definition</span>
<span class="dox_type">Object</span>
<span>keyword definition object.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">throwError</span>
<span class="dox_type">Boolean</span>
<span>true to throw exception if definition is invalid
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">boolean</span>
<span>validation result
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateKeyword</span>(<span class="hljs-params">definition, throwError</span>) </span>{
  validateKeyword.errors = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">var</span> v = <span class="hljs-keyword">this</span>._validateKeyword = <span class="hljs-keyword">this</span>._validateKeyword
                                  || <span class="hljs-keyword">this</span>.compile(definitionSchema, <span class="hljs-literal">true</span>);

  <span class="hljs-keyword">if</span> (v(definition)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  validateKeyword.errors = v.errors;
  <span class="hljs-keyword">if</span> (throwError)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'custom keyword definition is invalid: '</span>  + <span class="hljs-keyword">this</span>.errorsText(v.errors));
  <span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

},{<span class="hljs-string">"./definition_schema"</span>:<span class="hljs-number">12</span>,<span class="hljs-string">"./dotjs/custom"</span>:<span class="hljs-number">22</span>}],<span class="hljs-number">40</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-built_in">module</span>.exports={
    <span class="hljs-string">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
    <span class="hljs-string">"$id"</span>: <span class="hljs-string">"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"</span>,
    <span class="hljs-string">"description"</span>: <span class="hljs-string">"Meta-schema for $data reference (JSON Schema extension proposal)"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
    <span class="hljs-string">"required"</span>: [ <span class="hljs-string">"$data"</span> ],
    <span class="hljs-string">"properties"</span>: {
        <span class="hljs-string">"$data"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"anyOf"</span>: [
                { <span class="hljs-string">"format"</span>: <span class="hljs-string">"relative-json-pointer"</span> }, 
                { <span class="hljs-string">"format"</span>: <span class="hljs-string">"json-pointer"</span> }
            ]
        }
    },
    <span class="hljs-string">"additionalProperties"</span>: <span class="hljs-literal">false</span>
}

},{}],<span class="hljs-number">41</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-built_in">module</span>.exports={
    <span class="hljs-string">"$schema"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
    <span class="hljs-string">"$id"</span>: <span class="hljs-string">"http://json-schema.org/draft-07/schema#"</span>,
    <span class="hljs-string">"title"</span>: <span class="hljs-string">"Core schema meta-schema"</span>,
    <span class="hljs-string">"definitions"</span>: {
        <span class="hljs-string">"schemaArray"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
            <span class="hljs-string">"minItems"</span>: <span class="hljs-number">1</span>,
            <span class="hljs-string">"items"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> }
        },
        <span class="hljs-string">"nonNegativeInteger"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"integer"</span>,
            <span class="hljs-string">"minimum"</span>: <span class="hljs-number">0</span>
        },
        <span class="hljs-string">"nonNegativeIntegerDefault0"</span>: {
            <span class="hljs-string">"allOf"</span>: [
                { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeInteger"</span> },
                { <span class="hljs-string">"default"</span>: <span class="hljs-number">0</span> }
            ]
        },
        <span class="hljs-string">"simpleTypes"</span>: {
            <span class="hljs-string">"enum"</span>: [
                <span class="hljs-string">"array"</span>,
                <span class="hljs-string">"boolean"</span>,
                <span class="hljs-string">"integer"</span>,
                <span class="hljs-string">"null"</span>,
                <span class="hljs-string">"number"</span>,
                <span class="hljs-string">"object"</span>,
                <span class="hljs-string">"string"</span>
            ]
        },
        <span class="hljs-string">"stringArray"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
            <span class="hljs-string">"items"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span> },
            <span class="hljs-string">"uniqueItems"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"default"</span>: []
        }
    },
    <span class="hljs-string">"type"</span>: [<span class="hljs-string">"object"</span>, <span class="hljs-string">"boolean"</span>],
    <span class="hljs-string">"properties"</span>: {
        <span class="hljs-string">"$id"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"format"</span>: <span class="hljs-string">"uri-reference"</span>
        },
        <span class="hljs-string">"$schema"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"format"</span>: <span class="hljs-string">"uri"</span>
        },
        <span class="hljs-string">"$ref"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"format"</span>: <span class="hljs-string">"uri-reference"</span>
        },
        <span class="hljs-string">"$comment"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>
        },
        <span class="hljs-string">"title"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>
        },
        <span class="hljs-string">"description"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>
        },
        <span class="hljs-string">"default"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"readOnly"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"boolean"</span>,
            <span class="hljs-string">"default"</span>: <span class="hljs-literal">false</span>
        },
        <span class="hljs-string">"examples"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
            <span class="hljs-string">"items"</span>: <span class="hljs-literal">true</span>
        },
        <span class="hljs-string">"multipleOf"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"number"</span>,
            <span class="hljs-string">"exclusiveMinimum"</span>: <span class="hljs-number">0</span>
        },
        <span class="hljs-string">"maximum"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"number"</span>
        },
        <span class="hljs-string">"exclusiveMaximum"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"number"</span>
        },
        <span class="hljs-string">"minimum"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"number"</span>
        },
        <span class="hljs-string">"exclusiveMinimum"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"number"</span>
        },
        <span class="hljs-string">"maxLength"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeInteger"</span> },
        <span class="hljs-string">"minLength"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeIntegerDefault0"</span> },
        <span class="hljs-string">"pattern"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,
            <span class="hljs-string">"format"</span>: <span class="hljs-string">"regex"</span>
        },
        <span class="hljs-string">"additionalItems"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
        <span class="hljs-string">"items"</span>: {
            <span class="hljs-string">"anyOf"</span>: [
                { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
                { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/schemaArray"</span> }
            ],
            <span class="hljs-string">"default"</span>: <span class="hljs-literal">true</span>
        },
        <span class="hljs-string">"maxItems"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeInteger"</span> },
        <span class="hljs-string">"minItems"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeIntegerDefault0"</span> },
        <span class="hljs-string">"uniqueItems"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"boolean"</span>,
            <span class="hljs-string">"default"</span>: <span class="hljs-literal">false</span>
        },
        <span class="hljs-string">"contains"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
        <span class="hljs-string">"maxProperties"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeInteger"</span> },
        <span class="hljs-string">"minProperties"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/nonNegativeIntegerDefault0"</span> },
        <span class="hljs-string">"required"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/stringArray"</span> },
        <span class="hljs-string">"additionalProperties"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
        <span class="hljs-string">"definitions"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-string">"additionalProperties"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
            <span class="hljs-string">"default"</span>: {}
        },
        <span class="hljs-string">"properties"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-string">"additionalProperties"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
            <span class="hljs-string">"default"</span>: {}
        },
        <span class="hljs-string">"patternProperties"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-string">"additionalProperties"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
            <span class="hljs-string">"propertyNames"</span>: { <span class="hljs-string">"format"</span>: <span class="hljs-string">"regex"</span> },
            <span class="hljs-string">"default"</span>: {}
        },
        <span class="hljs-string">"dependencies"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
            <span class="hljs-string">"additionalProperties"</span>: {
                <span class="hljs-string">"anyOf"</span>: [
                    { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
                    { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/stringArray"</span> }
                ]
            }
        },
        <span class="hljs-string">"propertyNames"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> },
        <span class="hljs-string">"const"</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">"enum"</span>: {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
            <span class="hljs-string">"items"</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-string">"minItems"</span>: <span class="hljs-number">1</span>,
            <span class="hljs-string">"uniqueItems"</span>: <span class="hljs-literal">true</span>
        },
        <span class="hljs-string">"type"</span>: {
            <span class="hljs-string">"anyOf"</span>: [
                { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/simpleTypes"</span> },
                {
                    <span class="hljs-string">"type"</span>: <span class="hljs-string">"array"</span>,
                    <span class="hljs-string">"items"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/simpleTypes"</span> },
                    <span class="hljs-string">"minItems"</span>: <span class="hljs-number">1</span>,
                    <span class="hljs-string">"uniqueItems"</span>: <span class="hljs-literal">true</span>
                }
            ]
        },
        <span class="hljs-string">"format"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-string">"contentMediaType"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-string">"contentEncoding"</span>: { <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span> },
        <span class="hljs-string">"if"</span>: {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span>},
        <span class="hljs-string">"then"</span>: {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span>},
        <span class="hljs-string">"else"</span>: {<span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span>},
        <span class="hljs-string">"allOf"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/schemaArray"</span> },
        <span class="hljs-string">"anyOf"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/schemaArray"</span> },
        <span class="hljs-string">"oneOf"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#/definitions/schemaArray"</span> },
        <span class="hljs-string">"not"</span>: { <span class="hljs-string">"$ref"</span>: <span class="hljs-string">"#"</span> }
    },
    <span class="hljs-string">"default"</span>: <span class="hljs-literal">true</span>
}

},{}],<span class="hljs-number">42</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-34" id="section-34"></a>
</div>
<p>do not edit .js files directly - edit src/index.jst</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">


<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">equal</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">if</span> (a === b) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

  <span class="hljs-keyword">if</span> (a &amp;&amp; b &amp;&amp; <span class="hljs-keyword">typeof</span> a == <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> b == <span class="hljs-string">'object'</span>) {
    <span class="hljs-keyword">if</span> (a.constructor !== b.constructor) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">var</span> length, i, keys;
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(a)) {
      length = a.length;
      <span class="hljs-keyword">if</span> (length != b.length) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">for</span> (i = length; i-- !== <span class="hljs-number">0</span>;)
        <span class="hljs-keyword">if</span> (!equal(a[i], b[i])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }



    <span class="hljs-keyword">if</span> (a.constructor === <span class="hljs-built_in">RegExp</span>) <span class="hljs-keyword">return</span> a.source === b.source &amp;&amp; a.flags === b.flags;
    <span class="hljs-keyword">if</span> (a.valueOf !== <span class="hljs-built_in">Object</span>.prototype.valueOf) <span class="hljs-keyword">return</span> a.valueOf() === b.valueOf();
    <span class="hljs-keyword">if</span> (a.toString !== <span class="hljs-built_in">Object</span>.prototype.toString) <span class="hljs-keyword">return</span> a.toString() === b.toString();

    keys = <span class="hljs-built_in">Object</span>.keys(a);
    length = keys.length;
    <span class="hljs-keyword">if</span> (length !== <span class="hljs-built_in">Object</span>.keys(b).length) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">for</span> (i = length; i-- !== <span class="hljs-number">0</span>;)
      <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">Object</span>.prototype.hasOwnProperty.call(b, keys[i])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">for</span> (i = length; i-- !== <span class="hljs-number">0</span>;) {
      <span class="hljs-keyword">var</span> key = keys[i];

      <span class="hljs-keyword">if</span> (!equal(a[key], b[key])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-35" id="section-35"></a>
</div>
<p>true if both NaN, false otherwise</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">return</span> a!==a &amp;&amp; b!==b;
};

},{}],<span class="hljs-number">43</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, opts</span>) </span>{
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opts === <span class="hljs-string">'function'</span>) opts = { <span class="hljs-attr">cmp</span>: opts };
    <span class="hljs-keyword">var</span> cycles = (<span class="hljs-keyword">typeof</span> opts.cycles === <span class="hljs-string">'boolean'</span>) ? opts.cycles : <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">var</span> cmp = opts.cmp &amp;&amp; (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">f</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">node</span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
                <span class="hljs-keyword">var</span> aobj = { <span class="hljs-attr">key</span>: a, <span class="hljs-attr">value</span>: node[a] };
                <span class="hljs-keyword">var</span> bobj = { <span class="hljs-attr">key</span>: b, <span class="hljs-attr">value</span>: node[b] };
                <span class="hljs-keyword">return</span> f(aobj, bobj);
            };
        };
    })(opts.cmp);

    <span class="hljs-keyword">var</span> seen = [];
    <span class="hljs-keyword">return</span> (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">stringify</span> (<span class="hljs-params">node</span>) </span>{
        <span class="hljs-keyword">if</span> (node &amp;&amp; node.toJSON &amp;&amp; <span class="hljs-keyword">typeof</span> node.toJSON === <span class="hljs-string">'function'</span>) {
            node = node.toJSON();
        }

        <span class="hljs-keyword">if</span> (node === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node == <span class="hljs-string">'number'</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">isFinite</span>(node) ? <span class="hljs-string">''</span> + node : <span class="hljs-string">'null'</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> node !== <span class="hljs-string">'object'</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(node);

        <span class="hljs-keyword">var</span> i, out;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(node)) {
            out = <span class="hljs-string">'['</span>;
            <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; node.length; i++) {
                <span class="hljs-keyword">if</span> (i) out += <span class="hljs-string">','</span>;
                out += stringify(node[i]) || <span class="hljs-string">'null'</span>;
            }
            <span class="hljs-keyword">return</span> out + <span class="hljs-string">']'</span>;
        }

        <span class="hljs-keyword">if</span> (node === <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'null'</span>;

        <span class="hljs-keyword">if</span> (seen.indexOf(node) !== <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">if</span> (cycles) <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(<span class="hljs-string">'__cycle__'</span>);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">'Converting circular structure to JSON'</span>);
        }

        <span class="hljs-keyword">var</span> seenIndex = seen.push(node) - <span class="hljs-number">1</span>;
        <span class="hljs-keyword">var</span> keys = <span class="hljs-built_in">Object</span>.keys(node).sort(cmp &amp;&amp; cmp(node));
        out = <span class="hljs-string">''</span>;
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; keys.length; i++) {
            <span class="hljs-keyword">var</span> key = keys[i];
            <span class="hljs-keyword">var</span> value = stringify(node[key]);

            <span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">continue</span>;
            <span class="hljs-keyword">if</span> (out) out += <span class="hljs-string">','</span>;
            out += <span class="hljs-built_in">JSON</span>.stringify(key) + <span class="hljs-string">':'</span> + value;
        }
        seen.splice(seenIndex, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-string">'{'</span> + out + <span class="hljs-string">'}'</span>;
    })(data);
};

},{}],<span class="hljs-number">44</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> traverse = <span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">schema, opts, cb</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-36" id="section-36"></a>
</div>
<p>Legacy support for v0.3.1 and earlier.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opts == <span class="hljs-string">'function'</span>) {
    cb = opts;
    opts = {};
  }

  cb = opts.cb || cb;
  <span class="hljs-keyword">var</span> pre = (<span class="hljs-keyword">typeof</span> cb == <span class="hljs-string">'function'</span>) ? cb : cb.pre || <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};
  <span class="hljs-keyword">var</span> post = cb.post || <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{};

  _traverse(opts, pre, post, schema, <span class="hljs-string">''</span>, schema);
};


traverse.keywords = {
  <span class="hljs-attr">additionalItems</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">items</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">contains</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">additionalProperties</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">propertyNames</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">not</span>: <span class="hljs-literal">true</span>
};

traverse.arrayKeywords = {
  <span class="hljs-attr">items</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">allOf</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">anyOf</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">oneOf</span>: <span class="hljs-literal">true</span>
};

traverse.propsKeywords = {
  <span class="hljs-attr">definitions</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">properties</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">patternProperties</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">dependencies</span>: <span class="hljs-literal">true</span>
};

traverse.skipKeywords = {
  <span class="hljs-attr">default</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">enum</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">const</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">maximum</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">minimum</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">exclusiveMaximum</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">exclusiveMinimum</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">multipleOf</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">maxLength</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">minLength</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">pattern</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">format</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">maxItems</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">minItems</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">uniqueItems</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">maxProperties</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">minProperties</span>: <span class="hljs-literal">true</span>
};


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_traverse</span>(<span class="hljs-params">opts, pre, post, schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex</span>) </span>{
  <span class="hljs-keyword">if</span> (schema &amp;&amp; <span class="hljs-keyword">typeof</span> schema == <span class="hljs-string">'object'</span> &amp;&amp; !<span class="hljs-built_in">Array</span>.isArray(schema)) {
    pre(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> schema) {
      <span class="hljs-keyword">var</span> sch = schema[key];
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(sch)) {
        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> traverse.arrayKeywords) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;sch.length; i++)
            _traverse(opts, pre, post, sch[i], jsonPtr + <span class="hljs-string">'/'</span> + key + <span class="hljs-string">'/'</span> + i, rootSchema, jsonPtr, key, schema, i);
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> traverse.propsKeywords) {
        <span class="hljs-keyword">if</span> (sch &amp;&amp; <span class="hljs-keyword">typeof</span> sch == <span class="hljs-string">'object'</span>) {
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> prop <span class="hljs-keyword">in</span> sch)
            _traverse(opts, pre, post, sch[prop], jsonPtr + <span class="hljs-string">'/'</span> + key + <span class="hljs-string">'/'</span> + escapeJsonPtr(prop), rootSchema, jsonPtr, key, schema, prop);
        }
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> traverse.keywords || (opts.allKeys &amp;&amp; !(key <span class="hljs-keyword">in</span> traverse.skipKeywords))) {
        _traverse(opts, pre, post, sch, jsonPtr + <span class="hljs-string">'/'</span> + key, rootSchema, jsonPtr, key, schema);
      }
    }
    post(schema, jsonPtr, rootSchema, parentJsonPtr, parentKeyword, parentSchema, keyIndex);
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeJsonPtr</span>(<span class="hljs-params">str</span>) </span>{
  <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/~/g</span>, <span class="hljs-string">'~0'</span>).replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">'~1'</span>);
}

},{}],<span class="hljs-number">45</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-37" id="section-37"></a>
</div>
<div class="dox">
<div class="summary">
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-keyword">var</span> maxInt = <span class="hljs-number">2147483647</span>; <span class="hljs-comment">// aka. 0x7FFFFFFF or 2^31-1</span>

<span class="hljs-comment">/** Bootstring parameters */</span>
<span class="hljs-keyword">var</span> base = <span class="hljs-number">36</span>;
<span class="hljs-keyword">var</span> tMin = <span class="hljs-number">1</span>;
<span class="hljs-keyword">var</span> tMax = <span class="hljs-number">26</span>;
<span class="hljs-keyword">var</span> skew = <span class="hljs-number">38</span>;
<span class="hljs-keyword">var</span> damp = <span class="hljs-number">700</span>;
<span class="hljs-keyword">var</span> initialBias = <span class="hljs-number">72</span>;
<span class="hljs-keyword">var</span> initialN = <span class="hljs-number">128</span>; <span class="hljs-comment">// 0x80</span>
<span class="hljs-keyword">var</span> delimiter = <span class="hljs-string">'-'</span>; <span class="hljs-comment">// '\x2D'</span>

<span class="hljs-comment">/** Regular expressions */</span>
<span class="hljs-keyword">var</span> regexPunycode = <span class="hljs-regexp">/^xn--/</span>;
<span class="hljs-keyword">var</span> regexNonASCII = <span class="hljs-regexp">/[^\0-\x7E]/</span>; <span class="hljs-comment">// non-ASCII chars</span>
<span class="hljs-keyword">var</span> regexSeparators = <span class="hljs-regexp">/[\x2E\u3002\uFF0E\uFF61]/g</span>; <span class="hljs-comment">// RFC 3490 separators</span>

<span class="hljs-comment">/** Error messages */</span>
<span class="hljs-keyword">var</span> errors = {
	<span class="hljs-string">'overflow'</span>: <span class="hljs-string">'Overflow: input needs wider integers to process'</span>,
	<span class="hljs-string">'not-basic'</span>: <span class="hljs-string">'Illegal input &gt;= 0x80 (not a basic code point)'</span>,
	<span class="hljs-string">'invalid-input'</span>: <span class="hljs-string">'Invalid input'</span>
};

<span class="hljs-comment">/** Convenience shortcuts */</span>
<span class="hljs-keyword">var</span> baseMinusTMin = base - tMin;
<span class="hljs-keyword">var</span> floor = <span class="hljs-built_in">Math</span>.floor;
<span class="hljs-keyword">var</span> stringFromCharCode = <span class="hljs-built_in">String</span>.fromCharCode;

<span class="hljs-comment">/*--------------------------------------------------------------------------*/</span>

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-38" id="section-38"></a>
</div>
<div class="dox">
<div class="summary">
<p>A generic error utility function.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">type</span>
<span class="dox_type">String</span>
<span>The error type.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error$1</span>(<span class="hljs-params">type</span>) </span>{
	<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(errors[type]);
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-39" id="section-39"></a>
</div>
<div class="dox">
<div class="summary">
<p>A generic <code>Array#map</code> utility function.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">array</span>
<span class="dox_type">Array</span>
<span>The array to iterate over.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">Function</span>
<span>The function that gets called for every array item.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">map</span>(<span class="hljs-params">array, fn</span>) </span>{
	<span class="hljs-keyword">var</span> result = [];
	<span class="hljs-keyword">var</span> length = array.length;
	<span class="hljs-keyword">while</span> (length--) {
		result[length] = fn(array[length]);
	}
	<span class="hljs-keyword">return</span> result;
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-40" id="section-40"></a>
</div>
<div class="dox">
<div class="summary">
<p>A simple <code>Array#map</code>-like wrapper to work with domain name strings or email
addresses.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">domain</span>
<span class="dox_type">String</span>
<span>The domain name or email address.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">callback</span>
<span class="dox_type">Function</span>
<span>The function that gets called for every character.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapDomain</span>(<span class="hljs-params">string, fn</span>) </span>{
	<span class="hljs-keyword">var</span> parts = string.split(<span class="hljs-string">'@'</span>);
	<span class="hljs-keyword">var</span> result = <span class="hljs-string">''</span>;
	<span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">1</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-41" id="section-41"></a>
</div>
<p>In email addresses, only the domain name should be punycoded. Leave
the local part (i.e. everything up to <code>@</code>) intact.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		result = parts[<span class="hljs-number">0</span>] + <span class="hljs-string">'@'</span>;
		string = parts[<span class="hljs-number">1</span>];
	}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-42" id="section-42"></a>
</div>
<p>Avoid <code>split(regex)</code> for IE8 compatibility. See #17.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	string = string.replace(regexSeparators, <span class="hljs-string">'\x2E'</span>);
	<span class="hljs-keyword">var</span> labels = string.split(<span class="hljs-string">'.'</span>);
	<span class="hljs-keyword">var</span> encoded = map(labels, fn).join(<span class="hljs-string">'.'</span>);
	<span class="hljs-keyword">return</span> result + encoded;
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-43" id="section-43"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates an array containing the numeric code points of each Unicode
character in the string. While JavaScript uses UCS-2 internally,
this function will convert a pair of surrogate halves (each of which
UCS-2 exposes as separate characters) into a single code point,
matching UTF-16.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`punycode.ucs2.encode`</span>
</div>
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<a href="&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</a>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">string</span>
<span class="dox_type">String</span>
<span>The Unicode input string (UCS-2).
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2decode</span>(<span class="hljs-params">string</span>) </span>{
	<span class="hljs-keyword">var</span> output = [];
	<span class="hljs-keyword">var</span> counter = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">var</span> length = string.length;
	<span class="hljs-keyword">while</span> (counter &lt; length) {
		<span class="hljs-keyword">var</span> value = string.charCodeAt(counter++);
		<span class="hljs-keyword">if</span> (value &gt;= <span class="hljs-number">0xD800</span> &amp;&amp; value &lt;= <span class="hljs-number">0xDBFF</span> &amp;&amp; counter &lt; length) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-44" id="section-44"></a>
</div>
<p>It's a high surrogate, and there is a next character.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			<span class="hljs-keyword">var</span> extra = string.charCodeAt(counter++);
			<span class="hljs-keyword">if</span> ((extra &amp; <span class="hljs-number">0xFC00</span>) == <span class="hljs-number">0xDC00</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-45" id="section-45"></a>
</div>
<p>Low surrogate.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">				output.push(((value &amp; <span class="hljs-number">0x3FF</span>) &lt;&lt; <span class="hljs-number">10</span>) + (extra &amp; <span class="hljs-number">0x3FF</span>) + <span class="hljs-number">0x10000</span>);
			} <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-46" id="section-46"></a>
</div>
<p>It's an unmatched surrogate; only append this code unit, in case the
next code unit is the high surrogate of a surrogate pair.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">				output.push(value);
				counter--;
			}
		} <span class="hljs-keyword">else</span> {
			output.push(value);
		}
	}
	<span class="hljs-keyword">return</span> output;
}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-47" id="section-47"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates a string based on an array of numeric code points.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`punycode.ucs2.decode`</span>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">codePoints</span>
<span class="dox_type">Array</span>
<span>The array of numeric code points.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ucs2encode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ucs2encode</span>(<span class="hljs-params">array</span>) </span>{
	<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCodePoint.apply(<span class="hljs-built_in">String</span>, toConsumableArray(array));
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-48" id="section-48"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a basic code point into a digit/integer.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`digitToBasic()`</span>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">codePoint</span>
<span class="dox_type">Number</span>
<span>The basic numeric code point value.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> basicToDigit = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">basicToDigit</span>(<span class="hljs-params">codePoint</span>) </span>{
	<span class="hljs-keyword">if</span> (codePoint - <span class="hljs-number">0x30</span> &lt; <span class="hljs-number">0x0A</span>) {
		<span class="hljs-keyword">return</span> codePoint - <span class="hljs-number">0x16</span>;
	}
	<span class="hljs-keyword">if</span> (codePoint - <span class="hljs-number">0x41</span> &lt; <span class="hljs-number">0x1A</span>) {
		<span class="hljs-keyword">return</span> codePoint - <span class="hljs-number">0x41</span>;
	}
	<span class="hljs-keyword">if</span> (codePoint - <span class="hljs-number">0x61</span> &lt; <span class="hljs-number">0x1A</span>) {
		<span class="hljs-keyword">return</span> codePoint - <span class="hljs-number">0x61</span>;
	}
	<span class="hljs-keyword">return</span> base;
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-49" id="section-49"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a digit/integer into a basic code point.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<span class="dox_type">`basicToDigit()`</span>
</div>
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">digit</span>
<span class="dox_type">Number</span>
<span>The numeric value of a basic code point.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> digitToBasic = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">digitToBasic</span>(<span class="hljs-params">digit, flag</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-50" id="section-50"></a>
</div>
<p>0..25 map to ASCII a..z or A..Z
26..35 map to ASCII 0..9</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">return</span> digit + <span class="hljs-number">22</span> + <span class="hljs-number">75</span> * (digit &lt; <span class="hljs-number">26</span>) - ((flag != <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">5</span>);
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-51" id="section-51"></a>
</div>
<div class="dox">
<div class="summary">
<p>Bias adaptation function as per section 3.4 of RFC 3492.
https://tools.ietf.org/html/rfc3492#section-3.4</p>
</div>
<div class="body">
</div>
<div class="details">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> adapt = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adapt</span>(<span class="hljs-params">delta, numPoints, firstTime</span>) </span>{
	<span class="hljs-keyword">var</span> k = <span class="hljs-number">0</span>;
	delta = firstTime ? floor(delta / damp) : delta &gt;&gt; <span class="hljs-number">1</span>;
	delta += floor(delta / numPoints);
	<span class="hljs-keyword">for</span> (; <span class="hljs-comment">/* no initialization */</span>delta &gt; baseMinusTMin * tMax &gt;&gt; <span class="hljs-number">1</span>; k += base) {
		delta = floor(delta / baseMinusTMin);
	}
	<span class="hljs-keyword">return</span> floor(k + (baseMinusTMin + <span class="hljs-number">1</span>) * delta / (delta + skew));
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-52" id="section-52"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a Punycode string of ASCII-only symbols to a string of Unicode
symbols.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The Punycode string of ASCII-only symbols.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> decode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span>(<span class="hljs-params">input</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-53" id="section-53"></a>
</div>
<p>Don't use UCS-2.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> output = [];
	<span class="hljs-keyword">var</span> inputLength = input.length;
	<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">var</span> n = initialN;
	<span class="hljs-keyword">var</span> bias = initialBias;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-54" id="section-54"></a>
</div>
<p>Handle the basic code points: let <code>basic</code> be the number of input code
points before the last delimiter, or <code>0</code> if there is none, then copy
the first basic code points to the output.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-keyword">var</span> basic = input.lastIndexOf(delimiter);
	<span class="hljs-keyword">if</span> (basic &lt; <span class="hljs-number">0</span>) {
		basic = <span class="hljs-number">0</span>;
	}

	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; basic; ++j) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-55" id="section-55"></a>
</div>
<p>if it's not a basic code point</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">if</span> (input.charCodeAt(j) &gt;= <span class="hljs-number">0x80</span>) {
			error$<span class="hljs-number">1</span>(<span class="hljs-string">'not-basic'</span>);
		}
		output.push(input.charCodeAt(j));
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-56" id="section-56"></a>
</div>
<p>Main decoding loop: start just after the last delimiter if any basic code
points were copied; start at the beginning otherwise.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> index = basic &gt; <span class="hljs-number">0</span> ? basic + <span class="hljs-number">1</span> : <span class="hljs-number">0</span>; index &lt; inputLength;) <span class="hljs-comment">/* no final expression */</span>{

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-57" id="section-57"></a>
</div>
<p><code>index</code> is the index of the next character to be consumed.
Decode a generalized variable-length integer into <code>delta</code>,
which gets added to <code>i</code>. The overflow checking is easier
if we increase <code>i</code> as we go, then subtract off its starting
value at the end to obtain <code>delta</code>.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">var</span> oldi = i;
		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> w = <span class="hljs-number">1</span>, k = base;; <span class="hljs-comment">/* no condition */</span>k += base) {

			<span class="hljs-keyword">if</span> (index &gt;= inputLength) {
				error$<span class="hljs-number">1</span>(<span class="hljs-string">'invalid-input'</span>);
			}

			<span class="hljs-keyword">var</span> digit = basicToDigit(input.charCodeAt(index++));

			<span class="hljs-keyword">if</span> (digit &gt;= base || digit &gt; floor((maxInt - i) / w)) {
				error$<span class="hljs-number">1</span>(<span class="hljs-string">'overflow'</span>);
			}

			i += digit * w;
			<span class="hljs-keyword">var</span> t = k &lt;= bias ? tMin : k &gt;= bias + tMax ? tMax : k - bias;

			<span class="hljs-keyword">if</span> (digit &lt; t) {
				<span class="hljs-keyword">break</span>;
			}

			<span class="hljs-keyword">var</span> baseMinusT = base - t;
			<span class="hljs-keyword">if</span> (w &gt; floor(maxInt / baseMinusT)) {
				error$<span class="hljs-number">1</span>(<span class="hljs-string">'overflow'</span>);
			}

			w *= baseMinusT;
		}

		<span class="hljs-keyword">var</span> out = output.length + <span class="hljs-number">1</span>;
		bias = adapt(i - oldi, out, oldi == <span class="hljs-number">0</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-58" id="section-58"></a>
</div>
<p><code>i</code> was supposed to wrap around from <code>out</code> to <code>0</code>,
incrementing <code>n</code> each time, so we'll fix that now:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">if</span> (floor(i / out) &gt; maxInt - n) {
			error$<span class="hljs-number">1</span>(<span class="hljs-string">'overflow'</span>);
		}

		n += floor(i / out);
		i %= out;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-59" id="section-59"></a>
</div>
<p>Insert <code>n</code> at position <code>i</code> of the output.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		output.splice(i++, <span class="hljs-number">0</span>, n);
	}

	<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCodePoint.apply(<span class="hljs-built_in">String</span>, output);
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-60" id="section-60"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a string of Unicode symbols (e.g. a domain name label) to a
Punycode string of ASCII-only symbols.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The string of Unicode symbols.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> encode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params">input</span>) </span>{
	<span class="hljs-keyword">var</span> output = [];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-61" id="section-61"></a>
</div>
<p>Convert the input in UCS-2 to an array of Unicode code points.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	input = ucs2decode(input);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-62" id="section-62"></a>
</div>
<p>Cache the length.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> inputLength = input.length;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-63" id="section-63"></a>
</div>
<p>Initialize the state.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> n = initialN;
	<span class="hljs-keyword">var</span> delta = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">var</span> bias = initialBias;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-64" id="section-64"></a>
</div>
<p>Handle the basic code points.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">var</span> _iteratorNormalCompletion = <span class="hljs-literal">true</span>;
	<span class="hljs-keyword">var</span> _didIteratorError = <span class="hljs-literal">false</span>;
	<span class="hljs-keyword">var</span> _iteratorError = <span class="hljs-literal">undefined</span>;

	<span class="hljs-keyword">try</span> {
		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _iterator = input[<span class="hljs-built_in">Symbol</span>.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = <span class="hljs-literal">true</span>) {
			<span class="hljs-keyword">var</span> _currentValue2 = _step.value;

			<span class="hljs-keyword">if</span> (_currentValue2 &lt; <span class="hljs-number">0x80</span>) {
				output.push(stringFromCharCode(_currentValue2));
			}
		}
	} <span class="hljs-keyword">catch</span> (err) {
		_didIteratorError = <span class="hljs-literal">true</span>;
		_iteratorError = err;
	} <span class="hljs-keyword">finally</span> {
		<span class="hljs-keyword">try</span> {
			<span class="hljs-keyword">if</span> (!_iteratorNormalCompletion &amp;&amp; _iterator.return) {
				_iterator.return();
			}
		} <span class="hljs-keyword">finally</span> {
			<span class="hljs-keyword">if</span> (_didIteratorError) {
				<span class="hljs-keyword">throw</span> _iteratorError;
			}
		}
	}

	<span class="hljs-keyword">var</span> basicLength = output.length;
	<span class="hljs-keyword">var</span> handledCPCount = basicLength;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-65" id="section-65"></a>
</div>
<p><code>handledCPCount</code> is the number of code points that have been handled;
<code>basicLength</code> is the number of basic code points.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-66" id="section-66"></a>
</div>
<p>Finish the basic string with a delimiter unless it's empty.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">if</span> (basicLength) {
		output.push(delimiter);
	}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-67" id="section-67"></a>
</div>
<p>Main encoding loop:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-keyword">while</span> (handledCPCount &lt; inputLength) {

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-68" id="section-68"></a>
</div>
<p>All non-basic code points &lt; n have been handled already. Find the next
larger one:</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">var</span> m = maxInt;
		<span class="hljs-keyword">var</span> _iteratorNormalCompletion2 = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">var</span> _didIteratorError2 = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">var</span> _iteratorError2 = <span class="hljs-literal">undefined</span>;

		<span class="hljs-keyword">try</span> {
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _iterator2 = input[<span class="hljs-built_in">Symbol</span>.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = <span class="hljs-literal">true</span>) {
				<span class="hljs-keyword">var</span> currentValue = _step2.value;

				<span class="hljs-keyword">if</span> (currentValue &gt;= n &amp;&amp; currentValue &lt; m) {
					m = currentValue;
				}
			}

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-69" id="section-69"></a>
</div>
<p>Increase <code>delta</code> enough to advance the decoder's &lt;n,i&gt; state to &lt;m,0&gt;,
but guard against overflow.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		} <span class="hljs-keyword">catch</span> (err) {
			_didIteratorError2 = <span class="hljs-literal">true</span>;
			_iteratorError2 = err;
		} <span class="hljs-keyword">finally</span> {
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span> (!_iteratorNormalCompletion2 &amp;&amp; _iterator2.return) {
					_iterator2.return();
				}
			} <span class="hljs-keyword">finally</span> {
				<span class="hljs-keyword">if</span> (_didIteratorError2) {
					<span class="hljs-keyword">throw</span> _iteratorError2;
				}
			}
		}

		<span class="hljs-keyword">var</span> handledCPCountPlusOne = handledCPCount + <span class="hljs-number">1</span>;
		<span class="hljs-keyword">if</span> (m - n &gt; floor((maxInt - delta) / handledCPCountPlusOne)) {
			error$<span class="hljs-number">1</span>(<span class="hljs-string">'overflow'</span>);
		}

		delta += (m - n) * handledCPCountPlusOne;
		n = m;

		<span class="hljs-keyword">var</span> _iteratorNormalCompletion3 = <span class="hljs-literal">true</span>;
		<span class="hljs-keyword">var</span> _didIteratorError3 = <span class="hljs-literal">false</span>;
		<span class="hljs-keyword">var</span> _iteratorError3 = <span class="hljs-literal">undefined</span>;

		<span class="hljs-keyword">try</span> {
			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _iterator3 = input[<span class="hljs-built_in">Symbol</span>.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = <span class="hljs-literal">true</span>) {
				<span class="hljs-keyword">var</span> _currentValue = _step3.value;

				<span class="hljs-keyword">if</span> (_currentValue &lt; n &amp;&amp; ++delta &gt; maxInt) {
					error$<span class="hljs-number">1</span>(<span class="hljs-string">'overflow'</span>);
				}
				<span class="hljs-keyword">if</span> (_currentValue == n) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-70" id="section-70"></a>
</div>
<p>Represent delta as a generalized variable-length integer.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">					<span class="hljs-keyword">var</span> q = delta;
					<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k = base;; <span class="hljs-comment">/* no condition */</span>k += base) {
						<span class="hljs-keyword">var</span> t = k &lt;= bias ? tMin : k &gt;= bias + tMax ? tMax : k - bias;
						<span class="hljs-keyword">if</span> (q &lt; t) {
							<span class="hljs-keyword">break</span>;
						}
						<span class="hljs-keyword">var</span> qMinusT = q - t;
						<span class="hljs-keyword">var</span> baseMinusT = base - t;
						output.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, <span class="hljs-number">0</span>)));
						q = floor(qMinusT / baseMinusT);
					}

					output.push(stringFromCharCode(digitToBasic(q, <span class="hljs-number">0</span>)));
					bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);
					delta = <span class="hljs-number">0</span>;
					++handledCPCount;
				}
			}
		} <span class="hljs-keyword">catch</span> (err) {
			_didIteratorError3 = <span class="hljs-literal">true</span>;
			_iteratorError3 = err;
		} <span class="hljs-keyword">finally</span> {
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span> (!_iteratorNormalCompletion3 &amp;&amp; _iterator3.return) {
					_iterator3.return();
				}
			} <span class="hljs-keyword">finally</span> {
				<span class="hljs-keyword">if</span> (_didIteratorError3) {
					<span class="hljs-keyword">throw</span> _iteratorError3;
				}
			}
		}

		++delta;
		++n;
	}
	<span class="hljs-keyword">return</span> output.join(<span class="hljs-string">''</span>);
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-71" id="section-71"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a Punycode string representing a domain name or an email address
to Unicode. Only the Punycoded parts of the input will be converted, i.e.
it doesn't matter if you call it on a string that has already been
converted to Unicode.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The Punycoded domain name or email address to convert to Unicode.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> toUnicode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toUnicode</span>(<span class="hljs-params">input</span>) </span>{
	<span class="hljs-keyword">return</span> mapDomain(input, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
		<span class="hljs-keyword">return</span> regexPunycode.test(string) ? decode(string.slice(<span class="hljs-number">4</span>).toLowerCase()) : string;
	});
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-72" id="section-72"></a>
</div>
<div class="dox">
<div class="summary">
<p>Converts a Unicode string representing a domain name or an email address to
Punycode. Only the non-ASCII parts of the domain name will be converted,
i.e. it doesn't matter if you call it with a domain that's already in
ASCII.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">input</span>
<span class="dox_type">String</span>
<span>The domain name or email address to convert, as a Unicode string.
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> toASCII = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toASCII</span>(<span class="hljs-params">input</span>) </span>{
	<span class="hljs-keyword">return</span> mapDomain(input, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
		<span class="hljs-keyword">return</span> regexNonASCII.test(string) ? <span class="hljs-string">'xn--'</span> + encode(string) : string;
	});
};

<span class="hljs-comment">/*--------------------------------------------------------------------------*/</span>

<span class="hljs-comment">/** Define the public API */</span>
<span class="hljs-keyword">var</span> punycode = {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-73" id="section-73"></a>
</div>
<div class="dox">
<div class="summary">
<p>A string representing the current Punycode.js version number.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Type</div>
<div class="dox_tag_detail">
<span class="dox_type">trin</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-string">'version'</span>: <span class="hljs-string">'2.1.0'</span>,
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-74" id="section-74"></a>
</div>
<div class="dox">
<div class="summary">
<p>An object of methods to convert from JavaScript's internal character
representation (UCS-2) to Unicode code points, and back.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<a href="&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;">&lt;https://mathiasbynens.be/notes/javascript-encoding&gt;</a>
</div>
<div class="dox_tag_title">Type</div>
<div class="dox_tag_detail">
<span class="dox_type">bjec</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">	<span class="hljs-string">'ucs2'</span>: {
		<span class="hljs-string">'decode'</span>: ucs2decode,
		<span class="hljs-string">'encode'</span>: ucs2encode
	},
	<span class="hljs-string">'decode'</span>: decode,
	<span class="hljs-string">'encode'</span>: encode,
	<span class="hljs-string">'toASCII'</span>: toASCII,
	<span class="hljs-string">'toUnicode'</span>: toUnicode
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-75" id="section-75"></a>
</div>
<div class="dox">
<div class="summary">
<p>URI.js</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">See</div>
<div class="dox_tag_detail">
<a href="http://github.com/garycourt/uri-js">http://github.com/garycourt/uri-js</a>
</div>
</div>
</div>
<div class="dox">
<div class="summary">
<p>Copyright 2011 Gary Court. All rights reserved.</p>
</div>
<div class="body">
<p>Redistribution and use in source and binary forms, with or without modification, are
permitted provided that the following conditions are met:</p>
<ol>
<li>
<p>Redistributions of source code must retain the above copyright notice, this list of
conditions and the following disclaimer.</p>
</li>
<li>
<p>Redistributions in binary form must reproduce the above copyright notice, this list
of conditions and the following disclaimer in the documentation and/or other materials
provided with the distribution.</p>
</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY GARY COURT ``AS IS'' AND ANY EXPRESS OR IMPLIED
WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL GARY COURT OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>The views and conclusions contained in the software and documentation are those of the
authors and should not be interpreted as representing official policies, either expressed
or implied, of Gary Court.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> SCHEMES = {};
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pctEncChar</span>(<span class="hljs-params">chr</span>) </span>{
    <span class="hljs-keyword">var</span> c = chr.charCodeAt(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">var</span> e = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">16</span>) e = <span class="hljs-string">"%0"</span> + c.toString(<span class="hljs-number">16</span>).toUpperCase();<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">128</span>) e = <span class="hljs-string">"%"</span> + c.toString(<span class="hljs-number">16</span>).toUpperCase();<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">2048</span>) e = <span class="hljs-string">"%"</span> + (c &gt;&gt; <span class="hljs-number">6</span> | <span class="hljs-number">192</span>).toString(<span class="hljs-number">16</span>).toUpperCase() + <span class="hljs-string">"%"</span> + (c &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>).toString(<span class="hljs-number">16</span>).toUpperCase();<span class="hljs-keyword">else</span> e = <span class="hljs-string">"%"</span> + (c &gt;&gt; <span class="hljs-number">12</span> | <span class="hljs-number">224</span>).toString(<span class="hljs-number">16</span>).toUpperCase() + <span class="hljs-string">"%"</span> + (c &gt;&gt; <span class="hljs-number">6</span> &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>).toString(<span class="hljs-number">16</span>).toUpperCase() + <span class="hljs-string">"%"</span> + (c &amp; <span class="hljs-number">63</span> | <span class="hljs-number">128</span>).toString(<span class="hljs-number">16</span>).toUpperCase();
    <span class="hljs-keyword">return</span> e;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pctDecChars</span>(<span class="hljs-params">str</span>) </span>{
    <span class="hljs-keyword">var</span> newStr = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">var</span> il = str.length;
    <span class="hljs-keyword">while</span> (i &lt; il) {
        <span class="hljs-keyword">var</span> c = <span class="hljs-built_in">parseInt</span>(str.substr(i + <span class="hljs-number">1</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
        <span class="hljs-keyword">if</span> (c &lt; <span class="hljs-number">128</span>) {
            newStr += <span class="hljs-built_in">String</span>.fromCharCode(c);
            i += <span class="hljs-number">3</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c &gt;= <span class="hljs-number">194</span> &amp;&amp; c &lt; <span class="hljs-number">224</span>) {
            <span class="hljs-keyword">if</span> (il - i &gt;= <span class="hljs-number">6</span>) {
                <span class="hljs-keyword">var</span> c2 = <span class="hljs-built_in">parseInt</span>(str.substr(i + <span class="hljs-number">4</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
                newStr += <span class="hljs-built_in">String</span>.fromCharCode((c &amp; <span class="hljs-number">31</span>) &lt;&lt; <span class="hljs-number">6</span> | c2 &amp; <span class="hljs-number">63</span>);
            } <span class="hljs-keyword">else</span> {
                newStr += str.substr(i, <span class="hljs-number">6</span>);
            }
            i += <span class="hljs-number">6</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (c &gt;= <span class="hljs-number">224</span>) {
            <span class="hljs-keyword">if</span> (il - i &gt;= <span class="hljs-number">9</span>) {
                <span class="hljs-keyword">var</span> _c = <span class="hljs-built_in">parseInt</span>(str.substr(i + <span class="hljs-number">4</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
                <span class="hljs-keyword">var</span> c3 = <span class="hljs-built_in">parseInt</span>(str.substr(i + <span class="hljs-number">7</span>, <span class="hljs-number">2</span>), <span class="hljs-number">16</span>);
                newStr += <span class="hljs-built_in">String</span>.fromCharCode((c &amp; <span class="hljs-number">15</span>) &lt;&lt; <span class="hljs-number">12</span> | (_c &amp; <span class="hljs-number">63</span>) &lt;&lt; <span class="hljs-number">6</span> | c3 &amp; <span class="hljs-number">63</span>);
            } <span class="hljs-keyword">else</span> {
                newStr += str.substr(i, <span class="hljs-number">9</span>);
            }
            i += <span class="hljs-number">9</span>;
        } <span class="hljs-keyword">else</span> {
            newStr += str.substr(i, <span class="hljs-number">3</span>);
            i += <span class="hljs-number">3</span>;
        }
    }
    <span class="hljs-keyword">return</span> newStr;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_normalizeComponentEncoding</span>(<span class="hljs-params">components, protocol</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeUnreserved</span>(<span class="hljs-params">str</span>) </span>{
        <span class="hljs-keyword">var</span> decStr = pctDecChars(str);
        <span class="hljs-keyword">return</span> !decStr.match(protocol.UNRESERVED) ? str : decStr;
    }
    <span class="hljs-keyword">if</span> (components.scheme) components.scheme = <span class="hljs-built_in">String</span>(components.scheme).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_SCHEME, <span class="hljs-string">""</span>);
    <span class="hljs-keyword">if</span> (components.userinfo !== <span class="hljs-literal">undefined</span>) components.userinfo = <span class="hljs-built_in">String</span>(components.userinfo).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_USERINFO, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);
    <span class="hljs-keyword">if</span> (components.host !== <span class="hljs-literal">undefined</span>) components.host = <span class="hljs-built_in">String</span>(components.host).replace(protocol.PCT_ENCODED, decodeUnreserved).toLowerCase().replace(protocol.NOT_HOST, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);
    <span class="hljs-keyword">if</span> (components.path !== <span class="hljs-literal">undefined</span>) components.path = <span class="hljs-built_in">String</span>(components.path).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(components.scheme ? protocol.NOT_PATH : protocol.NOT_PATH_NOSCHEME, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);
    <span class="hljs-keyword">if</span> (components.query !== <span class="hljs-literal">undefined</span>) components.query = <span class="hljs-built_in">String</span>(components.query).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_QUERY, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);
    <span class="hljs-keyword">if</span> (components.fragment !== <span class="hljs-literal">undefined</span>) components.fragment = <span class="hljs-built_in">String</span>(components.fragment).replace(protocol.PCT_ENCODED, decodeUnreserved).replace(protocol.NOT_FRAGMENT, pctEncChar).replace(protocol.PCT_ENCODED, toUpperCase);
    <span class="hljs-keyword">return</span> components;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_stripLeadingZeros</span>(<span class="hljs-params">str</span>) </span>{
    <span class="hljs-keyword">return</span> str.replace(<span class="hljs-regexp">/^0*(.*)/</span>, <span class="hljs-string">"$1"</span>) || <span class="hljs-string">"0"</span>;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_normalizeIPv4</span>(<span class="hljs-params">host, protocol</span>) </span>{
    <span class="hljs-keyword">var</span> matches = host.match(protocol.IPV4ADDRESS) || [];

    <span class="hljs-keyword">var</span> _matches = slicedToArray(matches, <span class="hljs-number">2</span>),
        address = _matches[<span class="hljs-number">1</span>];

    <span class="hljs-keyword">if</span> (address) {
        <span class="hljs-keyword">return</span> address.split(<span class="hljs-string">"."</span>).map(_stripLeadingZeros).join(<span class="hljs-string">"."</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> host;
    }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_normalizeIPv6</span>(<span class="hljs-params">host, protocol</span>) </span>{
    <span class="hljs-keyword">var</span> matches = host.match(protocol.IPV6ADDRESS) || [];

    <span class="hljs-keyword">var</span> _matches2 = slicedToArray(matches, <span class="hljs-number">3</span>),
        address = _matches2[<span class="hljs-number">1</span>],
        zone = _matches2[<span class="hljs-number">2</span>];

    <span class="hljs-keyword">if</span> (address) {
        <span class="hljs-keyword">var</span> _address$toLowerCase$ = address.toLowerCase().split(<span class="hljs-string">'::'</span>).reverse(),
            _address$toLowerCase$<span class="hljs-number">2</span> = slicedToArray(_address$toLowerCase$, <span class="hljs-number">2</span>),
            last = _address$toLowerCase$<span class="hljs-number">2</span>[<span class="hljs-number">0</span>],
            first = _address$toLowerCase$<span class="hljs-number">2</span>[<span class="hljs-number">1</span>];

        <span class="hljs-keyword">var</span> firstFields = first ? first.split(<span class="hljs-string">":"</span>).map(_stripLeadingZeros) : [];
        <span class="hljs-keyword">var</span> lastFields = last.split(<span class="hljs-string">":"</span>).map(_stripLeadingZeros);
        <span class="hljs-keyword">var</span> isLastFieldIPv4Address = protocol.IPV4ADDRESS.test(lastFields[lastFields.length - <span class="hljs-number">1</span>]);
        <span class="hljs-keyword">var</span> fieldCount = isLastFieldIPv4Address ? <span class="hljs-number">7</span> : <span class="hljs-number">8</span>;
        <span class="hljs-keyword">var</span> lastFieldsStart = lastFields.length - fieldCount;
        <span class="hljs-keyword">var</span> fields = <span class="hljs-built_in">Array</span>(fieldCount);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>; x &lt; fieldCount; ++x) {
            fields[x] = firstFields[x] || lastFields[lastFieldsStart + x] || <span class="hljs-string">''</span>;
        }
        <span class="hljs-keyword">if</span> (isLastFieldIPv4Address) {
            fields[fieldCount - <span class="hljs-number">1</span>] = _normalizeIPv4(fields[fieldCount - <span class="hljs-number">1</span>], protocol);
        }
        <span class="hljs-keyword">var</span> allZeroFields = fields.reduce(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">acc, field, index</span>) </span>{
            <span class="hljs-keyword">if</span> (!field || field === <span class="hljs-string">"0"</span>) {
                <span class="hljs-keyword">var</span> lastLongest = acc[acc.length - <span class="hljs-number">1</span>];
                <span class="hljs-keyword">if</span> (lastLongest &amp;&amp; lastLongest.index + lastLongest.length === index) {
                    lastLongest.length++;
                } <span class="hljs-keyword">else</span> {
                    acc.push({ <span class="hljs-attr">index</span>: index, <span class="hljs-attr">length</span>: <span class="hljs-number">1</span> });
                }
            }
            <span class="hljs-keyword">return</span> acc;
        }, []);
        <span class="hljs-keyword">var</span> longestZeroFields = allZeroFields.sort(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
            <span class="hljs-keyword">return</span> b.length - a.length;
        })[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">var</span> newHost = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (longestZeroFields &amp;&amp; longestZeroFields.length &gt; <span class="hljs-number">1</span>) {
            <span class="hljs-keyword">var</span> newFirst = fields.slice(<span class="hljs-number">0</span>, longestZeroFields.index);
            <span class="hljs-keyword">var</span> newLast = fields.slice(longestZeroFields.index + longestZeroFields.length);
            newHost = newFirst.join(<span class="hljs-string">":"</span>) + <span class="hljs-string">"::"</span> + newLast.join(<span class="hljs-string">":"</span>);
        } <span class="hljs-keyword">else</span> {
            newHost = fields.join(<span class="hljs-string">":"</span>);
        }
        <span class="hljs-keyword">if</span> (zone) {
            newHost += <span class="hljs-string">"%"</span> + zone;
        }
        <span class="hljs-keyword">return</span> newHost;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> host;
    }
}
<span class="hljs-keyword">var</span> URI_PARSE = <span class="hljs-regexp">/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i</span>;
<span class="hljs-keyword">var</span> NO_MATCH_IS_UNDEFINED = <span class="hljs-string">""</span>.match(<span class="hljs-regexp">/(){0}/</span>)[<span class="hljs-number">1</span>] === <span class="hljs-literal">undefined</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">uriString</span>) </span>{
    <span class="hljs-keyword">var</span> options = <span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] !== <span class="hljs-literal">undefined</span> ? <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] : {};

    <span class="hljs-keyword">var</span> components = {};
    <span class="hljs-keyword">var</span> protocol = options.iri !== <span class="hljs-literal">false</span> ? IRI_PROTOCOL : URI_PROTOCOL;
    <span class="hljs-keyword">if</span> (options.reference === <span class="hljs-string">"suffix"</span>) uriString = (options.scheme ? options.scheme + <span class="hljs-string">":"</span> : <span class="hljs-string">""</span>) + <span class="hljs-string">"//"</span> + uriString;
    <span class="hljs-keyword">var</span> matches = uriString.match(URI_PARSE);
    <span class="hljs-keyword">if</span> (matches) {
        <span class="hljs-keyword">if</span> (NO_MATCH_IS_UNDEFINED) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-76" id="section-76"></a>
</div>
<p>store each component</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            components.scheme = matches[<span class="hljs-number">1</span>];
            components.userinfo = matches[<span class="hljs-number">3</span>];
            components.host = matches[<span class="hljs-number">4</span>];
            components.port = <span class="hljs-built_in">parseInt</span>(matches[<span class="hljs-number">5</span>], <span class="hljs-number">10</span>);
            components.path = matches[<span class="hljs-number">6</span>] || <span class="hljs-string">""</span>;
            components.query = matches[<span class="hljs-number">7</span>];
            components.fragment = matches[<span class="hljs-number">8</span>];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-77" id="section-77"></a>
</div>
<p>fix port number</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(components.port)) {
                components.port = matches[<span class="hljs-number">5</span>];
            }
        } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-78" id="section-78"></a>
</div>
<p>IE FIX for improper RegExp matching
store each component</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            components.scheme = matches[<span class="hljs-number">1</span>] || <span class="hljs-literal">undefined</span>;
            components.userinfo = uriString.indexOf(<span class="hljs-string">"@"</span>) !== <span class="hljs-number">-1</span> ? matches[<span class="hljs-number">3</span>] : <span class="hljs-literal">undefined</span>;
            components.host = uriString.indexOf(<span class="hljs-string">"//"</span>) !== <span class="hljs-number">-1</span> ? matches[<span class="hljs-number">4</span>] : <span class="hljs-literal">undefined</span>;
            components.port = <span class="hljs-built_in">parseInt</span>(matches[<span class="hljs-number">5</span>], <span class="hljs-number">10</span>);
            components.path = matches[<span class="hljs-number">6</span>] || <span class="hljs-string">""</span>;
            components.query = uriString.indexOf(<span class="hljs-string">"?"</span>) !== <span class="hljs-number">-1</span> ? matches[<span class="hljs-number">7</span>] : <span class="hljs-literal">undefined</span>;
            components.fragment = uriString.indexOf(<span class="hljs-string">"#"</span>) !== <span class="hljs-number">-1</span> ? matches[<span class="hljs-number">8</span>] : <span class="hljs-literal">undefined</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-79" id="section-79"></a>
</div>
<p>fix port number</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(components.port)) {
                components.port = uriString.match(<span class="hljs-regexp">/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/</span>) ? matches[<span class="hljs-number">4</span>] : <span class="hljs-literal">undefined</span>;
            }
        }
        <span class="hljs-keyword">if</span> (components.host) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-80" id="section-80"></a>
</div>
<p>normalize IP hosts</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            components.host = _normalizeIPv6(_normalizeIPv4(components.host, protocol), protocol);
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-81" id="section-81"></a>
</div>
<p>determine reference type</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (components.scheme === <span class="hljs-literal">undefined</span> &amp;&amp; components.userinfo === <span class="hljs-literal">undefined</span> &amp;&amp; components.host === <span class="hljs-literal">undefined</span> &amp;&amp; components.port === <span class="hljs-literal">undefined</span> &amp;&amp; !components.path &amp;&amp; components.query === <span class="hljs-literal">undefined</span>) {
            components.reference = <span class="hljs-string">"same-document"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (components.scheme === <span class="hljs-literal">undefined</span>) {
            components.reference = <span class="hljs-string">"relative"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (components.fragment === <span class="hljs-literal">undefined</span>) {
            components.reference = <span class="hljs-string">"absolute"</span>;
        } <span class="hljs-keyword">else</span> {
            components.reference = <span class="hljs-string">"uri"</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-82" id="section-82"></a>
</div>
<p>check for reference errors</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (options.reference &amp;&amp; options.reference !== <span class="hljs-string">"suffix"</span> &amp;&amp; options.reference !== components.reference) {
            components.error = components.error || <span class="hljs-string">"URI is not a "</span> + options.reference + <span class="hljs-string">" reference."</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-83" id="section-83"></a>
</div>
<p>find scheme handler</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">var</span> schemeHandler = SCHEMES[(options.scheme || components.scheme || <span class="hljs-string">""</span>).toLowerCase()];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-84" id="section-84"></a>
</div>
<p>check if scheme can't handle IRIs</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (!options.unicodeSupport &amp;&amp; (!schemeHandler || !schemeHandler.unicodeSupport)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-85" id="section-85"></a>
</div>
<p>if host component is a domain name</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">if</span> (components.host &amp;&amp; (options.domainHost || schemeHandler &amp;&amp; schemeHandler.domainHost)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-86" id="section-86"></a>
</div>
<p>convert Unicode IDN -&gt; ASCII IDN</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">try</span> {
                    components.host = punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase());
                } <span class="hljs-keyword">catch</span> (e) {
                    components.error = components.error || <span class="hljs-string">"Host's domain name can not be converted to ASCII via punycode: "</span> + e;
                }
            }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-87" id="section-87"></a>
</div>
<p>convert IRI -&gt; URI</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            _normalizeComponentEncoding(components, URI_PROTOCOL);
        } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-88" id="section-88"></a>
</div>
<p>normalize encodings</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            _normalizeComponentEncoding(components, protocol);
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-89" id="section-89"></a>
</div>
<p>perform scheme specific parsing</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (schemeHandler &amp;&amp; schemeHandler.parse) {
            schemeHandler.parse(components, options);
        }
    } <span class="hljs-keyword">else</span> {
        components.error = components.error || <span class="hljs-string">"URI can not be parsed."</span>;
    }
    <span class="hljs-keyword">return</span> components;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_recomposeAuthority</span>(<span class="hljs-params">components, options</span>) </span>{
    <span class="hljs-keyword">var</span> protocol = options.iri !== <span class="hljs-literal">false</span> ? IRI_PROTOCOL : URI_PROTOCOL;
    <span class="hljs-keyword">var</span> uriTokens = [];
    <span class="hljs-keyword">if</span> (components.userinfo !== <span class="hljs-literal">undefined</span>) {
        uriTokens.push(components.userinfo);
        uriTokens.push(<span class="hljs-string">"@"</span>);
    }
    <span class="hljs-keyword">if</span> (components.host !== <span class="hljs-literal">undefined</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-90" id="section-90"></a>
</div>
<p>normalize IP hosts, add brackets and escape zone separator for IPv6</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        uriTokens.push(_normalizeIPv6(_normalizeIPv4(<span class="hljs-built_in">String</span>(components.host), protocol), protocol).replace(protocol.IPV6ADDRESS, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">_, $<span class="hljs-number">1</span>, $<span class="hljs-number">2</span></span>) </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-string">"["</span> + $<span class="hljs-number">1</span> + ($<span class="hljs-number">2</span> ? <span class="hljs-string">"%25"</span> + $<span class="hljs-number">2</span> : <span class="hljs-string">""</span>) + <span class="hljs-string">"]"</span>;
        }));
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> components.port === <span class="hljs-string">"number"</span> || <span class="hljs-keyword">typeof</span> components.port === <span class="hljs-string">"string"</span>) {
        uriTokens.push(<span class="hljs-string">":"</span>);
        uriTokens.push(<span class="hljs-built_in">String</span>(components.port));
    }
    <span class="hljs-keyword">return</span> uriTokens.length ? uriTokens.join(<span class="hljs-string">""</span>) : <span class="hljs-literal">undefined</span>;
}

<span class="hljs-keyword">var</span> RDS1 = <span class="hljs-regexp">/^\.\.?\//</span>;
<span class="hljs-keyword">var</span> RDS2 = <span class="hljs-regexp">/^\/\.(\/|$)/</span>;
<span class="hljs-keyword">var</span> RDS3 = <span class="hljs-regexp">/^\/\.\.(\/|$)/</span>;
<span class="hljs-keyword">var</span> RDS5 = <span class="hljs-regexp">/^\/?(?:.|\n)*?(?=\/|$)/</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeDotSegments</span>(<span class="hljs-params">input</span>) </span>{
    <span class="hljs-keyword">var</span> output = [];
    <span class="hljs-keyword">while</span> (input.length) {
        <span class="hljs-keyword">if</span> (input.match(RDS1)) {
            input = input.replace(RDS1, <span class="hljs-string">""</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (input.match(RDS2)) {
            input = input.replace(RDS2, <span class="hljs-string">"/"</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (input.match(RDS3)) {
            input = input.replace(RDS3, <span class="hljs-string">"/"</span>);
            output.pop();
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (input === <span class="hljs-string">"."</span> || input === <span class="hljs-string">".."</span>) {
            input = <span class="hljs-string">""</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">var</span> im = input.match(RDS5);
            <span class="hljs-keyword">if</span> (im) {
                <span class="hljs-keyword">var</span> s = im[<span class="hljs-number">0</span>];
                input = input.slice(s.length);
                output.push(s);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Unexpected dot segment condition"</span>);
            }
        }
    }
    <span class="hljs-keyword">return</span> output.join(<span class="hljs-string">""</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize</span>(<span class="hljs-params">components</span>) </span>{
    <span class="hljs-keyword">var</span> options = <span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] !== <span class="hljs-literal">undefined</span> ? <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>] : {};

    <span class="hljs-keyword">var</span> protocol = options.iri ? IRI_PROTOCOL : URI_PROTOCOL;
    <span class="hljs-keyword">var</span> uriTokens = [];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-91" id="section-91"></a>
</div>
<p>find scheme handler</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">var</span> schemeHandler = SCHEMES[(options.scheme || components.scheme || <span class="hljs-string">""</span>).toLowerCase()];
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-92" id="section-92"></a>
</div>
<p>perform scheme specific serialization</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (schemeHandler &amp;&amp; schemeHandler.serialize) schemeHandler.serialize(components, options);
    <span class="hljs-keyword">if</span> (components.host) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-93" id="section-93"></a>
</div>
<p>if host component is an IPv6 address</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (protocol.IPV6ADDRESS.test(components.host)) {}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-94" id="section-94"></a>
</div>
<p>TODO: normalize IPv6 address as per RFC 5952</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-95" id="section-95"></a>
</div>
<p>if host component is a domain name</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (options.domainHost || schemeHandler &amp;&amp; schemeHandler.domainHost) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-96" id="section-96"></a>
</div>
<p>convert IDN via punycode</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">try</span> {
                    components.host = !options.iri ? punycode.toASCII(components.host.replace(protocol.PCT_ENCODED, pctDecChars).toLowerCase()) : punycode.toUnicode(components.host);
                } <span class="hljs-keyword">catch</span> (e) {
                    components.error = components.error || <span class="hljs-string">"Host's domain name can not be converted to "</span> + (!options.iri ? <span class="hljs-string">"ASCII"</span> : <span class="hljs-string">"Unicode"</span>) + <span class="hljs-string">" via punycode: "</span> + e;
                }
            }
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-97" id="section-97"></a>
</div>
<p>normalize encoding</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    _normalizeComponentEncoding(components, protocol);
    <span class="hljs-keyword">if</span> (options.reference !== <span class="hljs-string">"suffix"</span> &amp;&amp; components.scheme) {
        uriTokens.push(components.scheme);
        uriTokens.push(<span class="hljs-string">":"</span>);
    }
    <span class="hljs-keyword">var</span> authority = _recomposeAuthority(components, options);
    <span class="hljs-keyword">if</span> (authority !== <span class="hljs-literal">undefined</span>) {
        <span class="hljs-keyword">if</span> (options.reference !== <span class="hljs-string">"suffix"</span>) {
            uriTokens.push(<span class="hljs-string">"//"</span>);
        }
        uriTokens.push(authority);
        <span class="hljs-keyword">if</span> (components.path &amp;&amp; components.path.charAt(<span class="hljs-number">0</span>) !== <span class="hljs-string">"/"</span>) {
            uriTokens.push(<span class="hljs-string">"/"</span>);
        }
    }
    <span class="hljs-keyword">if</span> (components.path !== <span class="hljs-literal">undefined</span>) {
        <span class="hljs-keyword">var</span> s = components.path;
        <span class="hljs-keyword">if</span> (!options.absolutePath &amp;&amp; (!schemeHandler || !schemeHandler.absolutePath)) {
            s = removeDotSegments(s);
        }
        <span class="hljs-keyword">if</span> (authority === <span class="hljs-literal">undefined</span>) {
            s = s.replace(<span class="hljs-regexp">/^\/\//</span>, <span class="hljs-string">"/%2F"</span>); <span class="hljs-comment">//don't allow the path to start with "//"</span>
        }
        uriTokens.push(s);
    }
    <span class="hljs-keyword">if</span> (components.query !== <span class="hljs-literal">undefined</span>) {
        uriTokens.push(<span class="hljs-string">"?"</span>);
        uriTokens.push(components.query);
    }
    <span class="hljs-keyword">if</span> (components.fragment !== <span class="hljs-literal">undefined</span>) {
        uriTokens.push(<span class="hljs-string">"#"</span>);
        uriTokens.push(components.fragment);
    }
    <span class="hljs-keyword">return</span> uriTokens.join(<span class="hljs-string">""</span>); <span class="hljs-comment">//merge tokens into a string</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveComponents</span>(<span class="hljs-params">base, relative</span>) </span>{
    <span class="hljs-keyword">var</span> options = <span class="hljs-built_in">arguments</span>.length &gt; <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-built_in">arguments</span>[<span class="hljs-number">2</span>] !== <span class="hljs-literal">undefined</span> ? <span class="hljs-built_in">arguments</span>[<span class="hljs-number">2</span>] : {};
    <span class="hljs-keyword">var</span> skipNormalization = <span class="hljs-built_in">arguments</span>[<span class="hljs-number">3</span>];

    <span class="hljs-keyword">var</span> target = {};
    <span class="hljs-keyword">if</span> (!skipNormalization) {
        base = parse(serialize(base, options), options); <span class="hljs-comment">//normalize base components</span>
        relative = parse(serialize(relative, options), options); <span class="hljs-comment">//normalize relative components</span>
    }
    options = options || {};
    <span class="hljs-keyword">if</span> (!options.tolerant &amp;&amp; relative.scheme) {
        target.scheme = relative.scheme;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-98" id="section-98"></a>
</div>
<p>target.authority = relative.authority;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        target.userinfo = relative.userinfo;
        target.host = relative.host;
        target.port = relative.port;
        target.path = removeDotSegments(relative.path || <span class="hljs-string">""</span>);
        target.query = relative.query;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (relative.userinfo !== <span class="hljs-literal">undefined</span> || relative.host !== <span class="hljs-literal">undefined</span> || relative.port !== <span class="hljs-literal">undefined</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-99" id="section-99"></a>
</div>
<p>target.authority = relative.authority;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            target.userinfo = relative.userinfo;
            target.host = relative.host;
            target.port = relative.port;
            target.path = removeDotSegments(relative.path || <span class="hljs-string">""</span>);
            target.query = relative.query;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">if</span> (!relative.path) {
                target.path = base.path;
                <span class="hljs-keyword">if</span> (relative.query !== <span class="hljs-literal">undefined</span>) {
                    target.query = relative.query;
                } <span class="hljs-keyword">else</span> {
                    target.query = base.query;
                }
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">if</span> (relative.path.charAt(<span class="hljs-number">0</span>) === <span class="hljs-string">"/"</span>) {
                    target.path = removeDotSegments(relative.path);
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">if</span> ((base.userinfo !== <span class="hljs-literal">undefined</span> || base.host !== <span class="hljs-literal">undefined</span> || base.port !== <span class="hljs-literal">undefined</span>) &amp;&amp; !base.path) {
                        target.path = <span class="hljs-string">"/"</span> + relative.path;
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!base.path) {
                        target.path = relative.path;
                    } <span class="hljs-keyword">else</span> {
                        target.path = base.path.slice(<span class="hljs-number">0</span>, base.path.lastIndexOf(<span class="hljs-string">"/"</span>) + <span class="hljs-number">1</span>) + relative.path;
                    }
                    target.path = removeDotSegments(target.path);
                }
                target.query = relative.query;
            }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-100" id="section-100"></a>
</div>
<p>target.authority = base.authority;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            target.userinfo = base.userinfo;
            target.host = base.host;
            target.port = base.port;
        }
        target.scheme = base.scheme;
    }
    target.fragment = relative.fragment;
    <span class="hljs-keyword">return</span> target;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolve</span>(<span class="hljs-params">baseURI, relativeURI, options</span>) </span>{
    <span class="hljs-keyword">var</span> schemelessOptions = assign({ <span class="hljs-attr">scheme</span>: <span class="hljs-string">'null'</span> }, options);
    <span class="hljs-keyword">return</span> serialize(resolveComponents(parse(baseURI, schemelessOptions), parse(relativeURI, schemelessOptions), schemelessOptions, <span class="hljs-literal">true</span>), schemelessOptions);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">normalize</span>(<span class="hljs-params">uri, options</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> uri === <span class="hljs-string">"string"</span>) {
        uri = serialize(parse(uri, options), options);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeOf(uri) === <span class="hljs-string">"object"</span>) {
        uri = parse(serialize(uri, options), options);
    }
    <span class="hljs-keyword">return</span> uri;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">equal</span>(<span class="hljs-params">uriA, uriB, options</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> uriA === <span class="hljs-string">"string"</span>) {
        uriA = serialize(parse(uriA, options), options);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeOf(uriA) === <span class="hljs-string">"object"</span>) {
        uriA = serialize(uriA, options);
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> uriB === <span class="hljs-string">"string"</span>) {
        uriB = serialize(parse(uriB, options), options);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typeOf(uriB) === <span class="hljs-string">"object"</span>) {
        uriB = serialize(uriB, options);
    }
    <span class="hljs-keyword">return</span> uriA === uriB;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeComponent</span>(<span class="hljs-params">str, options</span>) </span>{
    <span class="hljs-keyword">return</span> str &amp;&amp; str.toString().replace(!options || !options.iri ? URI_PROTOCOL.ESCAPE : IRI_PROTOCOL.ESCAPE, pctEncChar);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unescapeComponent</span>(<span class="hljs-params">str, options</span>) </span>{
    <span class="hljs-keyword">return</span> str &amp;&amp; str.toString().replace(!options || !options.iri ? URI_PROTOCOL.PCT_ENCODED : IRI_PROTOCOL.PCT_ENCODED, pctDecChars);
}

<span class="hljs-keyword">var</span> handler = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"http"</span>,
    <span class="hljs-attr">domainHost</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">components, options</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-101" id="section-101"></a>
</div>
<p>report missing host</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (!components.host) {
            components.error = components.error || <span class="hljs-string">"HTTP URIs must have a host."</span>;
        }
        <span class="hljs-keyword">return</span> components;
    },
    <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize</span>(<span class="hljs-params">components, options</span>) </span>{
        <span class="hljs-keyword">var</span> secure = <span class="hljs-built_in">String</span>(components.scheme).toLowerCase() === <span class="hljs-string">"https"</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-102" id="section-102"></a>
</div>
<p>normalize the default port</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (components.port === (secure ? <span class="hljs-number">443</span> : <span class="hljs-number">80</span>) || components.port === <span class="hljs-string">""</span>) {
            components.port = <span class="hljs-literal">undefined</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-103" id="section-103"></a>
</div>
<p>normalize the empty path</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (!components.path) {
            components.path = <span class="hljs-string">"/"</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-104" id="section-104"></a>
</div>
<p>NOTE: We do not parse query strings for HTTP URIs
as WWW Form Url Encoded query strings are part of the HTML4+ spec,
and not the HTTP spec.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">return</span> components;
    }
};

<span class="hljs-keyword">var</span> handler$<span class="hljs-number">1</span> = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"https"</span>,
    <span class="hljs-attr">domainHost</span>: handler.domainHost,
    <span class="hljs-attr">parse</span>: handler.parse,
    <span class="hljs-attr">serialize</span>: handler.serialize
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isSecure</span>(<span class="hljs-params">wsComponents</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> wsComponents.secure === <span class="hljs-string">'boolean'</span> ? wsComponents.secure : <span class="hljs-built_in">String</span>(wsComponents.scheme).toLowerCase() === <span class="hljs-string">"wss"</span>;
}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-105" id="section-105"></a>
</div>
<p>RFC 6455</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> handler$<span class="hljs-number">2</span> = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"ws"</span>,
    <span class="hljs-attr">domainHost</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">components, options</span>) </span>{
        <span class="hljs-keyword">var</span> wsComponents = components;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-106" id="section-106"></a>
</div>
<p>indicate if the secure flag is set</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        wsComponents.secure = isSecure(wsComponents);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-107" id="section-107"></a>
</div>
<p>construct resouce name</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        wsComponents.resourceName = (wsComponents.path || <span class="hljs-string">'/'</span>) + (wsComponents.query ? <span class="hljs-string">'?'</span> + wsComponents.query : <span class="hljs-string">''</span>);
        wsComponents.path = <span class="hljs-literal">undefined</span>;
        wsComponents.query = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">return</span> wsComponents;
    },
    <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize</span>(<span class="hljs-params">wsComponents, options</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-108" id="section-108"></a>
</div>
<p>normalize the default port</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (wsComponents.port === (isSecure(wsComponents) ? <span class="hljs-number">443</span> : <span class="hljs-number">80</span>) || wsComponents.port === <span class="hljs-string">""</span>) {
            wsComponents.port = <span class="hljs-literal">undefined</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-109" id="section-109"></a>
</div>
<p>ensure scheme matches secure flag</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> wsComponents.secure === <span class="hljs-string">'boolean'</span>) {
            wsComponents.scheme = wsComponents.secure ? <span class="hljs-string">'wss'</span> : <span class="hljs-string">'ws'</span>;
            wsComponents.secure = <span class="hljs-literal">undefined</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-110" id="section-110"></a>
</div>
<p>reconstruct path from resource name</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (wsComponents.resourceName) {
            <span class="hljs-keyword">var</span> _wsComponents$resourc = wsComponents.resourceName.split(<span class="hljs-string">'?'</span>),
                _wsComponents$resourc2 = slicedToArray(_wsComponents$resourc, <span class="hljs-number">2</span>),
                path = _wsComponents$resourc2[<span class="hljs-number">0</span>],
                query = _wsComponents$resourc2[<span class="hljs-number">1</span>];

            wsComponents.path = path &amp;&amp; path !== <span class="hljs-string">'/'</span> ? path : <span class="hljs-literal">undefined</span>;
            wsComponents.query = query;
            wsComponents.resourceName = <span class="hljs-literal">undefined</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-111" id="section-111"></a>
</div>
<p>forbid fragment component</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        wsComponents.fragment = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">return</span> wsComponents;
    }
};

<span class="hljs-keyword">var</span> handler$<span class="hljs-number">3</span> = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"wss"</span>,
    <span class="hljs-attr">domainHost</span>: handler$<span class="hljs-number">2.</span>domainHost,
    <span class="hljs-attr">parse</span>: handler$<span class="hljs-number">2.</span>parse,
    <span class="hljs-attr">serialize</span>: handler$<span class="hljs-number">2.</span>serialize
};

<span class="hljs-keyword">var</span> O = {};
<span class="hljs-keyword">var</span> isIRI = <span class="hljs-literal">true</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-112" id="section-112"></a>
</div>
<p>RFC 3986</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> UNRESERVED$$ = <span class="hljs-string">"[A-Za-z0-9\\-\\.\\_\\~"</span> + (isIRI ? <span class="hljs-string">"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF"</span> : <span class="hljs-string">""</span>) + <span class="hljs-string">"]"</span>;
<span class="hljs-keyword">var</span> HEXDIG$$ = <span class="hljs-string">"[0-9A-Fa-f]"</span>; <span class="hljs-comment">//case-insensitive</span>
<span class="hljs-keyword">var</span> PCT_ENCODED$ = subexp(subexp(<span class="hljs-string">"%[EFef]"</span> + HEXDIG$$ + <span class="hljs-string">"%"</span> + HEXDIG$$ + HEXDIG$$ + <span class="hljs-string">"%"</span> + HEXDIG$$ + HEXDIG$$) + <span class="hljs-string">"|"</span> + subexp(<span class="hljs-string">"%[89A-Fa-f]"</span> + HEXDIG$$ + <span class="hljs-string">"%"</span> + HEXDIG$$ + HEXDIG$$) + <span class="hljs-string">"|"</span> + subexp(<span class="hljs-string">"%"</span> + HEXDIG$$ + HEXDIG$$)); <span class="hljs-comment">//expanded</span>
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-113" id="section-113"></a>
</div>
<p>RFC 5322, except these symbols as per RFC 6068: @ : / ? # [ ] &amp; ; =
const ATEXT$$ = &quot;[A-Za-z0-9\!\#\$\%\&amp;\'\<em>\+\-\/\=\?\^\_\`\{\|\}\~]&quot;;
const WSP$$ = &quot;[\x20\x09]&quot;;
const OBS_QTEXT$$ = &quot;[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]&quot;;  //(%d1-8 / %d11-12 / %d14-31 / %d127)
const QTEXT$$ = merge(&quot;[\x21\x23-\x5B\x5D-\x7E]&quot;, OBS_QTEXT$$);  //%d33 / %d35-91 / %d93-126 / obs-qtext
const VCHAR$$ = &quot;[\x21-\x7E]&quot;;
const WSP$$ = &quot;[\x20\x09]&quot;;
const OBS_QP$ = subexp(&quot;\\&quot; + merge(&quot;[\x00\x0D\x0A]&quot;, OBS_QTEXT$$));  //%d0 / CR / LF / obs-qtext
const FWS$ = subexp(subexp(WSP$$ + &quot;</em>&quot; + &quot;\x0D\x0A&quot;) + &quot;?&quot; + WSP$$ + &quot;+&quot;);
const QUOTED_PAIR$ = subexp(subexp(&quot;\\&quot; + subexp(VCHAR$$ + &quot;|&quot; + WSP$$)) + &quot;|&quot; + OBS_QP$);
const QUOTED_STRING$ = subexp('\&quot;' + subexp(FWS$ + &quot;?&quot; + QCONTENT$) + &quot;*&quot; + FWS$ + &quot;?&quot; + '\&quot;');</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> ATEXT$$ = <span class="hljs-string">"[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]"</span>;
<span class="hljs-keyword">var</span> QTEXT$$ = <span class="hljs-string">"[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\&lt;\\&gt;A-Z\\x5E-\\x7E]"</span>;
<span class="hljs-keyword">var</span> VCHAR$$ = merge(QTEXT$$, <span class="hljs-string">"[\\\"\\\\]"</span>);
<span class="hljs-keyword">var</span> SOME_DELIMS$$ = <span class="hljs-string">"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"</span>;
<span class="hljs-keyword">var</span> UNRESERVED = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(UNRESERVED$$, <span class="hljs-string">"g"</span>);
<span class="hljs-keyword">var</span> PCT_ENCODED = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(PCT_ENCODED$, <span class="hljs-string">"g"</span>);
<span class="hljs-keyword">var</span> NOT_LOCAL_PART = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(merge(<span class="hljs-string">"[^]"</span>, ATEXT$$, <span class="hljs-string">"[\\.]"</span>, <span class="hljs-string">'[\\"]'</span>, VCHAR$$), <span class="hljs-string">"g"</span>);
<span class="hljs-keyword">var</span> NOT_HFNAME = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(merge(<span class="hljs-string">"[^]"</span>, UNRESERVED$$, SOME_DELIMS$$), <span class="hljs-string">"g"</span>);
<span class="hljs-keyword">var</span> NOT_HFVALUE = NOT_HFNAME;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decodeUnreserved</span>(<span class="hljs-params">str</span>) </span>{
    <span class="hljs-keyword">var</span> decStr = pctDecChars(str);
    <span class="hljs-keyword">return</span> !decStr.match(UNRESERVED) ? str : decStr;
}
<span class="hljs-keyword">var</span> handler$<span class="hljs-number">4</span> = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"mailto"</span>,
    <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse$$1</span>(<span class="hljs-params">components, options</span>) </span>{
        <span class="hljs-keyword">var</span> mailtoComponents = components;
        <span class="hljs-keyword">var</span> to = mailtoComponents.to = mailtoComponents.path ? mailtoComponents.path.split(<span class="hljs-string">","</span>) : [];
        mailtoComponents.path = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">if</span> (mailtoComponents.query) {
            <span class="hljs-keyword">var</span> unknownHeaders = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">var</span> headers = {};
            <span class="hljs-keyword">var</span> hfields = mailtoComponents.query.split(<span class="hljs-string">"&amp;"</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>, xl = hfields.length; x &lt; xl; ++x) {
                <span class="hljs-keyword">var</span> hfield = hfields[x].split(<span class="hljs-string">"="</span>);
                <span class="hljs-keyword">switch</span> (hfield[<span class="hljs-number">0</span>]) {
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"to"</span>:
                        <span class="hljs-keyword">var</span> toAddrs = hfield[<span class="hljs-number">1</span>].split(<span class="hljs-string">","</span>);
                        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _x = <span class="hljs-number">0</span>, _xl = toAddrs.length; _x &lt; _xl; ++_x) {
                            to.push(toAddrs[_x]);
                        }
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"subject"</span>:
                        mailtoComponents.subject = unescapeComponent(hfield[<span class="hljs-number">1</span>], options);
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"body"</span>:
                        mailtoComponents.body = unescapeComponent(hfield[<span class="hljs-number">1</span>], options);
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">default</span>:
                        unknownHeaders = <span class="hljs-literal">true</span>;
                        headers[unescapeComponent(hfield[<span class="hljs-number">0</span>], options)] = unescapeComponent(hfield[<span class="hljs-number">1</span>], options);
                        <span class="hljs-keyword">break</span>;
                }
            }
            <span class="hljs-keyword">if</span> (unknownHeaders) mailtoComponents.headers = headers;
        }
        mailtoComponents.query = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _x2 = <span class="hljs-number">0</span>, _xl2 = to.length; _x2 &lt; _xl2; ++_x2) {
            <span class="hljs-keyword">var</span> addr = to[_x2].split(<span class="hljs-string">"@"</span>);
            addr[<span class="hljs-number">0</span>] = unescapeComponent(addr[<span class="hljs-number">0</span>]);
            <span class="hljs-keyword">if</span> (!options.unicodeSupport) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-114" id="section-114"></a>
</div>
<p>convert Unicode IDN -&gt; ASCII IDN</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">try</span> {
                    addr[<span class="hljs-number">1</span>] = punycode.toASCII(unescapeComponent(addr[<span class="hljs-number">1</span>], options).toLowerCase());
                } <span class="hljs-keyword">catch</span> (e) {
                    mailtoComponents.error = mailtoComponents.error || <span class="hljs-string">"Email address's domain name can not be converted to ASCII via punycode: "</span> + e;
                }
            } <span class="hljs-keyword">else</span> {
                addr[<span class="hljs-number">1</span>] = unescapeComponent(addr[<span class="hljs-number">1</span>], options).toLowerCase();
            }
            to[_x2] = addr.join(<span class="hljs-string">"@"</span>);
        }
        <span class="hljs-keyword">return</span> mailtoComponents;
    },
    <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize$$1</span>(<span class="hljs-params">mailtoComponents, options</span>) </span>{
        <span class="hljs-keyword">var</span> components = mailtoComponents;
        <span class="hljs-keyword">var</span> to = toArray(mailtoComponents.to);
        <span class="hljs-keyword">if</span> (to) {
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> x = <span class="hljs-number">0</span>, xl = to.length; x &lt; xl; ++x) {
                <span class="hljs-keyword">var</span> toAddr = <span class="hljs-built_in">String</span>(to[x]);
                <span class="hljs-keyword">var</span> atIdx = toAddr.lastIndexOf(<span class="hljs-string">"@"</span>);
                <span class="hljs-keyword">var</span> localPart = toAddr.slice(<span class="hljs-number">0</span>, atIdx).replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_LOCAL_PART, pctEncChar);
                <span class="hljs-keyword">var</span> domain = toAddr.slice(atIdx + <span class="hljs-number">1</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-115" id="section-115"></a>
</div>
<p>convert IDN via punycode</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">                <span class="hljs-keyword">try</span> {
                    domain = !options.iri ? punycode.toASCII(unescapeComponent(domain, options).toLowerCase()) : punycode.toUnicode(domain);
                } <span class="hljs-keyword">catch</span> (e) {
                    components.error = components.error || <span class="hljs-string">"Email address's domain name can not be converted to "</span> + (!options.iri ? <span class="hljs-string">"ASCII"</span> : <span class="hljs-string">"Unicode"</span>) + <span class="hljs-string">" via punycode: "</span> + e;
                }
                to[x] = localPart + <span class="hljs-string">"@"</span> + domain;
            }
            components.path = to.join(<span class="hljs-string">","</span>);
        }
        <span class="hljs-keyword">var</span> headers = mailtoComponents.headers = mailtoComponents.headers || {};
        <span class="hljs-keyword">if</span> (mailtoComponents.subject) headers[<span class="hljs-string">"subject"</span>] = mailtoComponents.subject;
        <span class="hljs-keyword">if</span> (mailtoComponents.body) headers[<span class="hljs-string">"body"</span>] = mailtoComponents.body;
        <span class="hljs-keyword">var</span> fields = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> headers) {
            <span class="hljs-keyword">if</span> (headers[name] !== O[name]) {
                fields.push(name.replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFNAME, pctEncChar) + <span class="hljs-string">"="</span> + headers[name].replace(PCT_ENCODED, decodeUnreserved).replace(PCT_ENCODED, toUpperCase).replace(NOT_HFVALUE, pctEncChar));
            }
        }
        <span class="hljs-keyword">if</span> (fields.length) {
            components.query = fields.join(<span class="hljs-string">"&amp;"</span>);
        }
        <span class="hljs-keyword">return</span> components;
    }
};

<span class="hljs-keyword">var</span> URN_PARSE = <span class="hljs-regexp">/^([^\:]+)\:(.*)/</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-116" id="section-116"></a>
</div>
<p>RFC 2141</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> handler$<span class="hljs-number">5</span> = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"urn"</span>,
    <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse$$1</span>(<span class="hljs-params">components, options</span>) </span>{
        <span class="hljs-keyword">var</span> matches = components.path &amp;&amp; components.path.match(URN_PARSE);
        <span class="hljs-keyword">var</span> urnComponents = components;
        <span class="hljs-keyword">if</span> (matches) {
            <span class="hljs-keyword">var</span> scheme = options.scheme || urnComponents.scheme || <span class="hljs-string">"urn"</span>;
            <span class="hljs-keyword">var</span> nid = matches[<span class="hljs-number">1</span>].toLowerCase();
            <span class="hljs-keyword">var</span> nss = matches[<span class="hljs-number">2</span>];
            <span class="hljs-keyword">var</span> urnScheme = scheme + <span class="hljs-string">":"</span> + (options.nid || nid);
            <span class="hljs-keyword">var</span> schemeHandler = SCHEMES[urnScheme];
            urnComponents.nid = nid;
            urnComponents.nss = nss;
            urnComponents.path = <span class="hljs-literal">undefined</span>;
            <span class="hljs-keyword">if</span> (schemeHandler) {
                urnComponents = schemeHandler.parse(urnComponents, options);
            }
        } <span class="hljs-keyword">else</span> {
            urnComponents.error = urnComponents.error || <span class="hljs-string">"URN can not be parsed."</span>;
        }
        <span class="hljs-keyword">return</span> urnComponents;
    },
    <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize$$1</span>(<span class="hljs-params">urnComponents, options</span>) </span>{
        <span class="hljs-keyword">var</span> scheme = options.scheme || urnComponents.scheme || <span class="hljs-string">"urn"</span>;
        <span class="hljs-keyword">var</span> nid = urnComponents.nid;
        <span class="hljs-keyword">var</span> urnScheme = scheme + <span class="hljs-string">":"</span> + (options.nid || nid);
        <span class="hljs-keyword">var</span> schemeHandler = SCHEMES[urnScheme];
        <span class="hljs-keyword">if</span> (schemeHandler) {
            urnComponents = schemeHandler.serialize(urnComponents, options);
        }
        <span class="hljs-keyword">var</span> uriComponents = urnComponents;
        <span class="hljs-keyword">var</span> nss = urnComponents.nss;
        uriComponents.path = (nid || options.nid) + <span class="hljs-string">":"</span> + nss;
        <span class="hljs-keyword">return</span> uriComponents;
    }
};

<span class="hljs-keyword">var</span> UUID = <span class="hljs-regexp">/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-117" id="section-117"></a>
</div>
<p>RFC 4122</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> handler$<span class="hljs-number">6</span> = {
    <span class="hljs-attr">scheme</span>: <span class="hljs-string">"urn:uuid"</span>,
    <span class="hljs-attr">parse</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">urnComponents, options</span>) </span>{
        <span class="hljs-keyword">var</span> uuidComponents = urnComponents;
        uuidComponents.uuid = uuidComponents.nss;
        uuidComponents.nss = <span class="hljs-literal">undefined</span>;
        <span class="hljs-keyword">if</span> (!options.tolerant &amp;&amp; (!uuidComponents.uuid || !uuidComponents.uuid.match(UUID))) {
            uuidComponents.error = uuidComponents.error || <span class="hljs-string">"UUID is not valid."</span>;
        }
        <span class="hljs-keyword">return</span> uuidComponents;
    },
    <span class="hljs-attr">serialize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serialize</span>(<span class="hljs-params">uuidComponents, options</span>) </span>{
        <span class="hljs-keyword">var</span> urnComponents = uuidComponents;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-118" id="section-118"></a>
</div>
<p>normalize UUID</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        urnComponents.nss = (uuidComponents.uuid || <span class="hljs-string">""</span>).toLowerCase();
        <span class="hljs-keyword">return</span> urnComponents;
    }
};

SCHEMES[handler.scheme] = handler;
SCHEMES[handler$<span class="hljs-number">1.</span>scheme] = handler$<span class="hljs-number">1</span>;
SCHEMES[handler$<span class="hljs-number">2.</span>scheme] = handler$<span class="hljs-number">2</span>;
SCHEMES[handler$<span class="hljs-number">3.</span>scheme] = handler$<span class="hljs-number">3</span>;
SCHEMES[handler$<span class="hljs-number">4.</span>scheme] = handler$<span class="hljs-number">4</span>;
SCHEMES[handler$<span class="hljs-number">5.</span>scheme] = handler$<span class="hljs-number">5</span>;
SCHEMES[handler$<span class="hljs-number">6.</span>scheme] = handler$<span class="hljs-number">6</span>;

exports.SCHEMES = SCHEMES;
exports.pctEncChar = pctEncChar;
exports.pctDecChars = pctDecChars;
exports.parse = parse;
exports.removeDotSegments = removeDotSegments;
exports.serialize = serialize;
exports.resolveComponents = resolveComponents;
exports.resolve = resolve;
exports.normalize = normalize;
exports.equal = equal;
exports.escapeComponent = escapeComponent;
exports.unescapeComponent = unescapeComponent;

<span class="hljs-built_in">Object</span>.defineProperty(exports, <span class="hljs-string">'__esModule'</span>, { <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span> });

})));


},{}],<span class="hljs-string">"ajv"</span>:[<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">require,module,exports</span>)</span>{
<span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> compileSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile'</span>)
  , resolve = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/resolve'</span>)
  , Cache = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./cache'</span>)
  , SchemaObject = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/schema_obj'</span>)
  , stableStringify = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fast-json-stable-stringify'</span>)
  , formats = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/formats'</span>)
  , rules = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/rules'</span>)
  , $dataMetaSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./data'</span>)
  , util = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/util'</span>);

<span class="hljs-built_in">module</span>.exports = Ajv;

Ajv.prototype.validate = validate;
Ajv.prototype.compile = compile;
Ajv.prototype.addSchema = addSchema;
Ajv.prototype.addMetaSchema = addMetaSchema;
Ajv.prototype.validateSchema = validateSchema;
Ajv.prototype.getSchema = getSchema;
Ajv.prototype.removeSchema = removeSchema;
Ajv.prototype.addFormat = addFormat;
Ajv.prototype.errorsText = errorsText;

Ajv.prototype._addSchema = _addSchema;
Ajv.prototype._compile = _compile;

Ajv.prototype.compileAsync = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/async'</span>);
<span class="hljs-keyword">var</span> customKeyword = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./keyword'</span>);
Ajv.prototype.addKeyword = customKeyword.add;
Ajv.prototype.getKeyword = customKeyword.get;
Ajv.prototype.removeKeyword = customKeyword.remove;
Ajv.prototype.validateKeyword = customKeyword.validate;

<span class="hljs-keyword">var</span> errorClasses = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./compile/error_classes'</span>);
Ajv.ValidationError = errorClasses.Validation;
Ajv.MissingRefError = errorClasses.MissingRef;
Ajv.$dataMetaSchema = $dataMetaSchema;

<span class="hljs-keyword">var</span> META_SCHEMA_ID = <span class="hljs-string">'http://json-schema.org/draft-07/schema'</span>;

<span class="hljs-keyword">var</span> META_IGNORE_OPTIONS = [ <span class="hljs-string">'removeAdditional'</span>, <span class="hljs-string">'useDefaults'</span>, <span class="hljs-string">'coerceTypes'</span>, <span class="hljs-string">'strictDefaults'</span> ];
<span class="hljs-keyword">var</span> META_SUPPORT_DATA = [<span class="hljs-string">'/properties'</span>];

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-119" id="section-119"></a>
</div>
<div class="dox">
<div class="summary">
<p>Creates validator instance.
Usage: <code>Ajv(opts)</code></p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">opts</span>
<span class="dox_type">Object</span>
<span>optional options
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Object</span>
<span>ajv instance
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Ajv</span>(<span class="hljs-params">opts</span>) </span>{
  <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Ajv)) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Ajv(opts);
  opts = <span class="hljs-keyword">this</span>._opts = util.copy(opts) || {};
  setLogger(<span class="hljs-keyword">this</span>);
  <span class="hljs-keyword">this</span>._schemas = {};
  <span class="hljs-keyword">this</span>._refs = {};
  <span class="hljs-keyword">this</span>._fragments = {};
  <span class="hljs-keyword">this</span>._formats = formats(opts.format);

  <span class="hljs-keyword">this</span>._cache = opts.cache || <span class="hljs-keyword">new</span> Cache;
  <span class="hljs-keyword">this</span>._loadingSchemas = {};
  <span class="hljs-keyword">this</span>._compilations = [];
  <span class="hljs-keyword">this</span>.RULES = rules();
  <span class="hljs-keyword">this</span>._getId = chooseGetId(opts);

  opts.loopRequired = opts.loopRequired || <span class="hljs-literal">Infinity</span>;
  <span class="hljs-keyword">if</span> (opts.errorDataPath == <span class="hljs-string">'property'</span>) opts._errorDataPathProperty = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">if</span> (opts.serialize === <span class="hljs-literal">undefined</span>) opts.serialize = stableStringify;
  <span class="hljs-keyword">this</span>._metaOpts = getMetaSchemaOptions(<span class="hljs-keyword">this</span>);

  <span class="hljs-keyword">if</span> (opts.formats) addInitialFormats(<span class="hljs-keyword">this</span>);
  <span class="hljs-keyword">if</span> (opts.keywords) addInitialKeywords(<span class="hljs-keyword">this</span>);
  addDefaultMetaSchema(<span class="hljs-keyword">this</span>);
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opts.meta == <span class="hljs-string">'object'</span>) <span class="hljs-keyword">this</span>.addMetaSchema(opts.meta);
  <span class="hljs-keyword">if</span> (opts.nullable) <span class="hljs-keyword">this</span>.addKeyword(<span class="hljs-string">'nullable'</span>, {<span class="hljs-attr">metaSchema</span>: {<span class="hljs-attr">type</span>: <span class="hljs-string">'boolean'</span>}});
  addInitialSchemas(<span class="hljs-keyword">this</span>);
}



</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-120" id="section-120"></a>
</div>
<div class="dox">
<div class="summary">
<p>Validate data using schema
Schema will be compiled and cached (using serialized JSON as key. <a href="https://github.com/epoberezkin/fast-json-stable-stringify">fast-json-stable-stringify</a> is used to serialize.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schemaKeyRef</span>
<span class="dox_type">String</span>
<span class="dox_type">Object</span>
<span>key, ref or schema object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">data</span>
<span class="dox_type">Any</span>
<span>to be validated
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Boolean</span>
<span>validation result. Errors from the last validation will be available in <code>ajv.errors</code> (and also in compiled schema: <code>schema.errors</code>).
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params">schemaKeyRef, data</span>) </span>{
  <span class="hljs-keyword">var</span> v;
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> schemaKeyRef == <span class="hljs-string">'string'</span>) {
    v = <span class="hljs-keyword">this</span>.getSchema(schemaKeyRef);
    <span class="hljs-keyword">if</span> (!v) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'no schema with key or ref "'</span> + schemaKeyRef + <span class="hljs-string">'"'</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> schemaObj = <span class="hljs-keyword">this</span>._addSchema(schemaKeyRef);
    v = schemaObj.validate || <span class="hljs-keyword">this</span>._compile(schemaObj);
  }

  <span class="hljs-keyword">var</span> valid = v(data);
  <span class="hljs-keyword">if</span> (v.$<span class="hljs-keyword">async</span> !== <span class="hljs-literal">true</span>) <span class="hljs-keyword">this</span>.errors = v.errors;
  <span class="hljs-keyword">return</span> valid;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-121" id="section-121"></a>
</div>
<div class="dox">
<div class="summary">
<p>Create validating function for passed schema.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">_meta</span>
<span class="dox_type">Boolean</span>
<span>true if schema is a meta-schema. Used internally to compile meta schemas of custom keywords.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Function</span>
<span>validating function
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compile</span>(<span class="hljs-params">schema, _meta</span>) </span>{
  <span class="hljs-keyword">var</span> schemaObj = <span class="hljs-keyword">this</span>._addSchema(schema, <span class="hljs-literal">undefined</span>, _meta);
  <span class="hljs-keyword">return</span> schemaObj.validate || <span class="hljs-keyword">this</span>._compile(schemaObj);
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-122" id="section-122"></a>
</div>
<div class="dox">
<div class="summary">
<p>Adds schema to the instance.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span class="dox_type">Array</span>
<span>schema or array of schemas. If array is passed, <code>key</code> and other parameters will be ignored.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">key</span>
<span class="dox_type">String</span>
<span>Optional schema key. Can be passed to <code>validate</code> method instead of schema object or id/ref. One schema per instance can have empty <code>id</code> and <code>key</code>.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">_skipValidation</span>
<span class="dox_type">Boolean</span>
<span>true to skip schema validation. Used internally, option validateSchema should be used instead.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">_meta</span>
<span class="dox_type">Boolean</span>
<span>true if schema is a meta-schema. Used internally, addMetaSchema should be used instead.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Ajv</span>
<span>this for method chaining
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addSchema</span>(<span class="hljs-params">schema, key, _skipValidation, _meta</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(schema)){
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;schema.length; i++) <span class="hljs-keyword">this</span>.addSchema(schema[i], <span class="hljs-literal">undefined</span>, _skipValidation, _meta);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }
  <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>._getId(schema);
  <span class="hljs-keyword">if</span> (id !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> id != <span class="hljs-string">'string'</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'schema id must be string'</span>);
  key = resolve.normalizeId(key || id);
  checkUnique(<span class="hljs-keyword">this</span>, key);
  <span class="hljs-keyword">this</span>._schemas[key] = <span class="hljs-keyword">this</span>._addSchema(schema, _skipValidation, _meta, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-123" id="section-123"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add schema that will be used to validate other schemas
options in META_IGNORE_OPTIONS are alway set to false</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema object
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">key</span>
<span class="dox_type">String</span>
<span>optional schema key
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">skipValidation</span>
<span class="dox_type">Boolean</span>
<span>true to skip schema validation, can be used to override validateSchema option for meta-schema
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Ajv</span>
<span>this for method chaining
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addMetaSchema</span>(<span class="hljs-params">schema, key, skipValidation</span>) </span>{
  <span class="hljs-keyword">this</span>.addSchema(schema, key, skipValidation, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-124" id="section-124"></a>
</div>
<div class="dox">
<div class="summary">
<p>Validate schema</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schema</span>
<span class="dox_type">Object</span>
<span>schema to validate
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">throwOrLogError</span>
<span class="dox_type">Boolean</span>
<span>pass true to throw (or log) an error if invalid
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Boolean</span>
<span>true if schema is valid
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateSchema</span>(<span class="hljs-params">schema, throwOrLogError</span>) </span>{
  <span class="hljs-keyword">var</span> $schema = schema.$schema;
  <span class="hljs-keyword">if</span> ($schema !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> $schema != <span class="hljs-string">'string'</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'$schema must be a string'</span>);
  $schema = $schema || <span class="hljs-keyword">this</span>._opts.defaultMeta || defaultMeta(<span class="hljs-keyword">this</span>);
  <span class="hljs-keyword">if</span> (!$schema) {
    <span class="hljs-keyword">this</span>.logger.warn(<span class="hljs-string">'meta-schema not available'</span>);
    <span class="hljs-keyword">this</span>.errors = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">var</span> valid = <span class="hljs-keyword">this</span>.validate($schema, schema);
  <span class="hljs-keyword">if</span> (!valid &amp;&amp; throwOrLogError) {
    <span class="hljs-keyword">var</span> message = <span class="hljs-string">'schema is invalid: '</span> + <span class="hljs-keyword">this</span>.errorsText();
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._opts.validateSchema == <span class="hljs-string">'log'</span>) <span class="hljs-keyword">this</span>.logger.error(message);
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(message);
  }
  <span class="hljs-keyword">return</span> valid;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">defaultMeta</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">var</span> meta = self._opts.meta;
  self._opts.defaultMeta = <span class="hljs-keyword">typeof</span> meta == <span class="hljs-string">'object'</span>
                            ? self._getId(meta) || meta
                            : self.getSchema(META_SCHEMA_ID)
                              ? META_SCHEMA_ID
                              : <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">return</span> self._opts.defaultMeta;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-125" id="section-125"></a>
</div>
<div class="dox">
<div class="summary">
<p>Get compiled schema from the instance by <code>key</code> or <code>ref</code>.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">keyRef</span>
<span class="dox_type">String</span>
<span><code>key</code> that was passed to <code>addSchema</code> or full schema reference (<code>schema.id</code> or resolved id).
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Function</span>
<span>schema validating function (with property <code>schema</code>).
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSchema</span>(<span class="hljs-params">keyRef</span>) </span>{
  <span class="hljs-keyword">var</span> schemaObj = _getSchemaObj(<span class="hljs-keyword">this</span>, keyRef);
  <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> schemaObj) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>: <span class="hljs-keyword">return</span> schemaObj.validate || <span class="hljs-keyword">this</span>._compile(schemaObj);
    <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>: <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getSchema(schemaObj);
    <span class="hljs-keyword">case</span> <span class="hljs-string">'undefined'</span>: <span class="hljs-keyword">return</span> _getSchemaFragment(<span class="hljs-keyword">this</span>, keyRef);
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getSchemaFragment</span>(<span class="hljs-params">self, ref</span>) </span>{
  <span class="hljs-keyword">var</span> res = resolve.schema.call(self, { <span class="hljs-attr">schema</span>: {} }, ref);
  <span class="hljs-keyword">if</span> (res) {
    <span class="hljs-keyword">var</span> schema = res.schema
      , root = res.root
      , baseId = res.baseId;
    <span class="hljs-keyword">var</span> v = compileSchema.call(self, schema, root, <span class="hljs-literal">undefined</span>, baseId);
    self._fragments[ref] = <span class="hljs-keyword">new</span> SchemaObject({
      <span class="hljs-attr">ref</span>: ref,
      <span class="hljs-attr">fragment</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">schema</span>: schema,
      <span class="hljs-attr">root</span>: root,
      <span class="hljs-attr">baseId</span>: baseId,
      <span class="hljs-attr">validate</span>: v
    });
    <span class="hljs-keyword">return</span> v;
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getSchemaObj</span>(<span class="hljs-params">self, keyRef</span>) </span>{
  keyRef = resolve.normalizeId(keyRef);
  <span class="hljs-keyword">return</span> self._schemas[keyRef] || self._refs[keyRef] || self._fragments[keyRef];
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-126" id="section-126"></a>
</div>
<div class="dox">
<div class="summary">
<p>Remove cached schema(s).
If no parameter is passed all schemas but meta-schemas are removed.
If RegExp is passed all schemas with key/id matching pattern but meta-schemas are removed.
Even if schema is referenced by other schemas it still can be removed as other schemas have local references.</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">schemaKeyRef</span>
<span class="dox_type">String</span>
<span class="dox_type">Object</span>
<span class="dox_type">RegExp</span>
<span>key, ref, pattern to match key/ref or schema object
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Ajv</span>
<span>this for method chaining
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeSchema</span>(<span class="hljs-params">schemaKeyRef</span>) </span>{
  <span class="hljs-keyword">if</span> (schemaKeyRef <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">RegExp</span>) {
    _removeAllSchemas(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._schemas, schemaKeyRef);
    _removeAllSchemas(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._refs, schemaKeyRef);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }
  <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">typeof</span> schemaKeyRef) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'undefined'</span>:
      _removeAllSchemas(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._schemas);
      _removeAllSchemas(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._refs);
      <span class="hljs-keyword">this</span>._cache.clear();
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'string'</span>:
      <span class="hljs-keyword">var</span> schemaObj = _getSchemaObj(<span class="hljs-keyword">this</span>, schemaKeyRef);
      <span class="hljs-keyword">if</span> (schemaObj) <span class="hljs-keyword">this</span>._cache.del(schemaObj.cacheKey);
      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._schemas[schemaKeyRef];
      <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._refs[schemaKeyRef];
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'object'</span>:
      <span class="hljs-keyword">var</span> serialize = <span class="hljs-keyword">this</span>._opts.serialize;
      <span class="hljs-keyword">var</span> cacheKey = serialize ? serialize(schemaKeyRef) : schemaKeyRef;
      <span class="hljs-keyword">this</span>._cache.del(cacheKey);
      <span class="hljs-keyword">var</span> id = <span class="hljs-keyword">this</span>._getId(schemaKeyRef);
      <span class="hljs-keyword">if</span> (id) {
        id = resolve.normalizeId(id);
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._schemas[id];
        <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._refs[id];
      }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_removeAllSchemas</span>(<span class="hljs-params">self, schemas, regex</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> keyRef <span class="hljs-keyword">in</span> schemas) {
    <span class="hljs-keyword">var</span> schemaObj = schemas[keyRef];
    <span class="hljs-keyword">if</span> (!schemaObj.meta &amp;&amp; (!regex || regex.test(keyRef))) {
      self._cache.del(schemaObj.cacheKey);
      <span class="hljs-keyword">delete</span> schemas[keyRef];
    }
  }
}


<span class="hljs-comment">/* @this   Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_addSchema</span>(<span class="hljs-params">schema, skipValidation, meta, shouldAddSchema</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> schema != <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> schema != <span class="hljs-string">'boolean'</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'schema should be object or boolean'</span>);
  <span class="hljs-keyword">var</span> serialize = <span class="hljs-keyword">this</span>._opts.serialize;
  <span class="hljs-keyword">var</span> cacheKey = serialize ? serialize(schema) : schema;
  <span class="hljs-keyword">var</span> cached = <span class="hljs-keyword">this</span>._cache.get(cacheKey);
  <span class="hljs-keyword">if</span> (cached) <span class="hljs-keyword">return</span> cached;

  shouldAddSchema = shouldAddSchema || <span class="hljs-keyword">this</span>._opts.addUsedSchema !== <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">var</span> id = resolve.normalizeId(<span class="hljs-keyword">this</span>._getId(schema));
  <span class="hljs-keyword">if</span> (id &amp;&amp; shouldAddSchema) checkUnique(<span class="hljs-keyword">this</span>, id);

  <span class="hljs-keyword">var</span> willValidate = <span class="hljs-keyword">this</span>._opts.validateSchema !== <span class="hljs-literal">false</span> &amp;&amp; !skipValidation;
  <span class="hljs-keyword">var</span> recursiveMeta;
  <span class="hljs-keyword">if</span> (willValidate &amp;&amp; !(recursiveMeta = id &amp;&amp; id == resolve.normalizeId(schema.$schema)))
    <span class="hljs-keyword">this</span>.validateSchema(schema, <span class="hljs-literal">true</span>);

  <span class="hljs-keyword">var</span> localRefs = resolve.ids.call(<span class="hljs-keyword">this</span>, schema);

  <span class="hljs-keyword">var</span> schemaObj = <span class="hljs-keyword">new</span> SchemaObject({
    <span class="hljs-attr">id</span>: id,
    <span class="hljs-attr">schema</span>: schema,
    <span class="hljs-attr">localRefs</span>: localRefs,
    <span class="hljs-attr">cacheKey</span>: cacheKey,
    <span class="hljs-attr">meta</span>: meta
  });

  <span class="hljs-keyword">if</span> (id[<span class="hljs-number">0</span>] != <span class="hljs-string">'#'</span> &amp;&amp; shouldAddSchema) <span class="hljs-keyword">this</span>._refs[id] = schemaObj;
  <span class="hljs-keyword">this</span>._cache.put(cacheKey, schemaObj);

  <span class="hljs-keyword">if</span> (willValidate &amp;&amp; recursiveMeta) <span class="hljs-keyword">this</span>.validateSchema(schema, <span class="hljs-literal">true</span>);

  <span class="hljs-keyword">return</span> schemaObj;
}


<span class="hljs-comment">/* @this   Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_compile</span>(<span class="hljs-params">schemaObj, root</span>) </span>{
  <span class="hljs-keyword">if</span> (schemaObj.compiling) {
    schemaObj.validate = callValidate;
    callValidate.schema = schemaObj.schema;
    callValidate.errors = <span class="hljs-literal">null</span>;
    callValidate.root = root ? root : callValidate;
    <span class="hljs-keyword">if</span> (schemaObj.schema.$<span class="hljs-keyword">async</span> === <span class="hljs-literal">true</span>)
      callValidate.$<span class="hljs-keyword">async</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> callValidate;
  }
  schemaObj.compiling = <span class="hljs-literal">true</span>;

  <span class="hljs-keyword">var</span> currentOpts;
  <span class="hljs-keyword">if</span> (schemaObj.meta) {
    currentOpts = <span class="hljs-keyword">this</span>._opts;
    <span class="hljs-keyword">this</span>._opts = <span class="hljs-keyword">this</span>._metaOpts;
  }

  <span class="hljs-keyword">var</span> v;
  <span class="hljs-keyword">try</span> { v = compileSchema.call(<span class="hljs-keyword">this</span>, schemaObj.schema, root, schemaObj.localRefs); }
  <span class="hljs-keyword">catch</span>(e) {
    <span class="hljs-keyword">delete</span> schemaObj.validate;
    <span class="hljs-keyword">throw</span> e;
  }
  <span class="hljs-keyword">finally</span> {
    schemaObj.compiling = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (schemaObj.meta) <span class="hljs-keyword">this</span>._opts = currentOpts;
  }

  schemaObj.validate = v;
  schemaObj.refs = v.refs;
  schemaObj.refVal = v.refVal;
  schemaObj.root = v.root;
  <span class="hljs-keyword">return</span> v;


  <span class="hljs-comment">/* @this   {*} - custom context, see passContext option */</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callValidate</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">/* jshint validthis: true */</span>
    <span class="hljs-keyword">var</span> _validate = schemaObj.validate;
    <span class="hljs-keyword">var</span> result = _validate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    callValidate.errors = _validate.errors;
    <span class="hljs-keyword">return</span> result;
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">chooseGetId</span>(<span class="hljs-params">opts</span>) </span>{
  <span class="hljs-keyword">switch</span> (opts.schemaId) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'auto'</span>: <span class="hljs-keyword">return</span> _get$IdOrId;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'id'</span>: <span class="hljs-keyword">return</span> _getId;
    <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> _get$Id;
  }
}

<span class="hljs-comment">/* @this   Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_getId</span>(<span class="hljs-params">schema</span>) </span>{
  <span class="hljs-keyword">if</span> (schema.$id) <span class="hljs-keyword">this</span>.logger.warn(<span class="hljs-string">'schema $id ignored'</span>, schema.$id);
  <span class="hljs-keyword">return</span> schema.id;
}

<span class="hljs-comment">/* @this   Ajv */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_get$Id</span>(<span class="hljs-params">schema</span>) </span>{
  <span class="hljs-keyword">if</span> (schema.id) <span class="hljs-keyword">this</span>.logger.warn(<span class="hljs-string">'schema id ignored'</span>, schema.id);
  <span class="hljs-keyword">return</span> schema.$id;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_get$IdOrId</span>(<span class="hljs-params">schema</span>) </span>{
  <span class="hljs-keyword">if</span> (schema.$id &amp;&amp; schema.id &amp;&amp; schema.$id != schema.id)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'schema $id is different from id'</span>);
  <span class="hljs-keyword">return</span> schema.$id || schema.id;
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-127" id="section-127"></a>
</div>
<div class="dox">
<div class="summary">
<p>Convert array of error message objects to string</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">errors</span>
<span class="dox_type">Array.&lt;Object&gt;</span>
<span>optional array of validation errors, if not passed errors from the instance are used.
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">options</span>
<span class="dox_type">Object</span>
<span>optional options with properties <code>separator</code> and <code>dataVar</code>.
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">String</span>
<span>human readable string with all errors descriptions
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorsText</span>(<span class="hljs-params">errors, options</span>) </span>{
  errors = errors || <span class="hljs-keyword">this</span>.errors;
  <span class="hljs-keyword">if</span> (!errors) <span class="hljs-keyword">return</span> <span class="hljs-string">'No errors'</span>;
  options = options || {};
  <span class="hljs-keyword">var</span> separator = options.separator === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">', '</span> : options.separator;
  <span class="hljs-keyword">var</span> dataVar = options.dataVar === <span class="hljs-literal">undefined</span> ? <span class="hljs-string">'data'</span> : options.dataVar;

  <span class="hljs-keyword">var</span> text = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;errors.length; i++) {
    <span class="hljs-keyword">var</span> e = errors[i];
    <span class="hljs-keyword">if</span> (e) text += dataVar + e.dataPath + <span class="hljs-string">' '</span> + e.message + separator;
  }
  <span class="hljs-keyword">return</span> text.slice(<span class="hljs-number">0</span>, -separator.length);
}


</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-128" id="section-128"></a>
</div>
<div class="dox">
<div class="summary">
<p>Add custom format</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">name</span>
<span class="dox_type">String</span>
<span>format name
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">format</span>
<span class="dox_type">String</span>
<span class="dox_type">RegExp</span>
<span class="dox_type">Function</span>
<span>string is converted to RegExp; function should return boolean (true when valid)
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Ajv</span>
<span>this for method chaining
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addFormat</span>(<span class="hljs-params">name, format</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> format == <span class="hljs-string">'string'</span>) format = <span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(format);
  <span class="hljs-keyword">this</span>._formats[name] = format;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addDefaultMetaSchema</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">var</span> $dataSchema;
  <span class="hljs-keyword">if</span> (self._opts.$data) {
    $dataSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./refs/data.json'</span>);
    self.addMetaSchema($dataSchema, $dataSchema.$id, <span class="hljs-literal">true</span>);
  }
  <span class="hljs-keyword">if</span> (self._opts.meta === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">var</span> metaSchema = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./refs/json-schema-draft-07.json'</span>);
  <span class="hljs-keyword">if</span> (self._opts.$data) metaSchema = $dataMetaSchema(metaSchema, META_SUPPORT_DATA);
  self.addMetaSchema(metaSchema, META_SCHEMA_ID, <span class="hljs-literal">true</span>);
  self._refs[<span class="hljs-string">'http://json-schema.org/schema'</span>] = META_SCHEMA_ID;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInitialSchemas</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">var</span> optsSchemas = self._opts.schemas;
  <span class="hljs-keyword">if</span> (!optsSchemas) <span class="hljs-keyword">return</span>;
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(optsSchemas)) self.addSchema(optsSchemas);
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> optsSchemas) self.addSchema(optsSchemas[key], key);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInitialFormats</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> self._opts.formats) {
    <span class="hljs-keyword">var</span> format = self._opts.formats[name];
    self.addFormat(name, format);
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addInitialKeywords</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> name <span class="hljs-keyword">in</span> self._opts.keywords) {
    <span class="hljs-keyword">var</span> keyword = self._opts.keywords[name];
    self.addKeyword(name, keyword);
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkUnique</span>(<span class="hljs-params">self, id</span>) </span>{
  <span class="hljs-keyword">if</span> (self._schemas[id] || self._refs[id])
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'schema with key or id "'</span> + id + <span class="hljs-string">'" already exists'</span>);
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getMetaSchemaOptions</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">var</span> metaOpts = util.copy(self._opts);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt;META_IGNORE_OPTIONS.length; i++)
    <span class="hljs-keyword">delete</span> metaOpts[META_IGNORE_OPTIONS[i]];
  <span class="hljs-keyword">return</span> metaOpts;
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setLogger</span>(<span class="hljs-params">self</span>) </span>{
  <span class="hljs-keyword">var</span> logger = self._opts.logger;
  <span class="hljs-keyword">if</span> (logger === <span class="hljs-literal">false</span>) {
    self.logger = {<span class="hljs-attr">log</span>: noop, <span class="hljs-attr">warn</span>: noop, <span class="hljs-attr">error</span>: noop};
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">if</span> (logger === <span class="hljs-literal">undefined</span>) logger = <span class="hljs-built_in">console</span>;
    <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">typeof</span> logger == <span class="hljs-string">'object'</span> &amp;&amp; logger.log &amp;&amp; logger.warn &amp;&amp; logger.error))
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'logger must implement log, warn and error methods'</span>);
    self.logger = logger;
  }
}


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noop</span>(<span class="hljs-params"></span>) </span>{}

},{<span class="hljs-string">"./cache"</span>:<span class="hljs-number">1</span>,<span class="hljs-string">"./compile"</span>:<span class="hljs-number">5</span>,<span class="hljs-string">"./compile/async"</span>:<span class="hljs-number">2</span>,<span class="hljs-string">"./compile/error_classes"</span>:<span class="hljs-number">3</span>,<span class="hljs-string">"./compile/formats"</span>:<span class="hljs-number">4</span>,<span class="hljs-string">"./compile/resolve"</span>:<span class="hljs-number">6</span>,<span class="hljs-string">"./compile/rules"</span>:<span class="hljs-number">7</span>,<span class="hljs-string">"./compile/schema_obj"</span>:<span class="hljs-number">8</span>,<span class="hljs-string">"./compile/util"</span>:<span class="hljs-number">10</span>,<span class="hljs-string">"./data"</span>:<span class="hljs-number">11</span>,<span class="hljs-string">"./keyword"</span>:<span class="hljs-number">39</span>,<span class="hljs-string">"./refs/data.json"</span>:<span class="hljs-number">40</span>,<span class="hljs-string">"./refs/json-schema-draft-07.json"</span>:<span class="hljs-number">41</span>,<span class="hljs-string">"fast-json-stable-stringify"</span>:<span class="hljs-number">43</span>}]},{},[])(<span class="hljs-string">"ajv"</span>)
});

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
