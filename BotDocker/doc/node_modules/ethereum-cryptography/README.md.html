<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/ethereum-cryptography/README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#ethereum-cryptography">ethereum-cryptography</a>
      </div>

      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h2">
        <a href="#hashes-sha256-keccak-256-ripemd160-blake2b">Hashes: SHA256, keccak-256, RIPEMD160, BLAKE2b</a>
      </div>

      <div class="heading h2">
        <a href="#kdfs-pbkdf2-scrypt">KDFs: PBKDF2, Scrypt</a>
      </div>

      <div class="heading h2">
        <a href="#csprng-cryptographically-strong-pseudorandom-number-generator">CSPRNG (Cryptographically strong pseudorandom number generator)</a>
      </div>

      <div class="heading h2">
        <a href="#secp256k1-curve">secp256k1 curve</a>
      </div>

      <div class="heading h2">
        <a href="#bip32-hd-keygen">BIP32 HD Keygen</a>
      </div>

      <div class="heading h2">
        <a href="#bip39-mnemonic-seed-phrase">BIP39 Mnemonic Seed Phrase</a>
      </div>

      <div class="heading h2">
        <a href="#aes-encryption">AES Encryption</a>
      </div>

      <div class="heading h3">
        <a href="#encrypting-with-passwords">Encrypting with passwords</a>
      </div>

      <div class="heading h3">
        <a href="#operation-modes">Operation modes</a>
      </div>

      <div class="heading h3">
        <a href="#padding-plaintext-messages">Padding plaintext messages</a>
      </div>

      <div class="heading h3">
        <a href="#how-to-use-the-iv-parameter">How to use the IV parameter</a>
      </div>

      <div class="heading h3">
        <a href="#how-to-handle-errors-with-this-module">How to handle errors with this module</a>
      </div>

      <div class="heading h3">
        <a href="#example-usage">Example usage</a>
      </div>

      <div class="heading h2">
        <a href="#browser-usage">Browser usage</a>
      </div>

      <div class="heading h3">
        <a href="#rollup-setup">Rollup setup</a>
      </div>

      <div class="heading h2">
        <a href="#legacy-secp256k1-compatibility-layer">Legacy secp256k1 compatibility layer</a>
      </div>

      <div class="heading h2">
        <a href="#missing-cryptographic-primitives">Missing cryptographic primitives</a>
      </div>

      <div class="heading h2">
        <a href="#upgrading">Upgrading</a>
      </div>

      <div class="heading h2">
        <a href="#security">Security</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="ethereum-cryptography">
  <h1>
    <a href="#ethereum-cryptography" name="ethereum-cryptography" class="pilcrow"></a>
ethereum-cryptography
  </h1>
</div>
<p><a href="https://www.npmjs.com/package/ethereum-cryptography"><img src="https://img.shields.io/npm/v/ethereum-cryptography.svg" alt="npm version"></a> <a href="https://github.com/ethereum/js-ethereum-cryptography/blob/master/packages/ethereum-cryptography/LICENSE"><img src="https://img.shields.io/npm/l/ethereum-cryptography" alt="license"></a></p>
<p><a href="#security.html">Audited</a> pure JS library containing all Ethereum-related cryptographic primitives.</p>
<p>Included algorithms, implemented with just 5 <a href="https://paulmillr.com/noble/">noble &amp; scure</a> dependencies:</p>
<ul>
<li><a href="#hashes-sha256-keccak-256-ripemd160-blake2b.html">Hashes: SHA256, keccak-256, RIPEMD160, BLAKE2b</a></li>
<li><a href="#kdfs-pbkdf2-scrypt.html">KDFs: PBKDF2, Scrypt</a></li>
<li><a href="#csprng-cryptographically-strong-pseudorandom-number-generator.html">CSPRNG (Cryptographically Secure Pseudorandom Number Generator)</a></li>
<li><a href="#secp256k1-curve.html">secp256k1 elliptic curve</a></li>
<li><a href="#bip32-hd-keygen.html">BIP32 HD Keygen</a></li>
<li><a href="#bip39-mnemonic-seed-phrase.html">BIP39 Mnemonic phrases</a></li>
<li><a href="#aes-encryption.html">AES Encryption</a></li>
</ul>
<p><strong>April 2023 update:</strong> v2.0 is out, switching
<a href="https://github.com/paulmillr/noble-secp256k1">noble-secp256k1</a> to
<a href="https://github.com/paulmillr/noble-curves">noble-curves</a>,
which changes re-exported api of <code>secp256k1</code> submodule.
There have been no other changes.</p>
<p><strong>January 2022 update:</strong> v1.0 has been released. We've rewritten the library from
scratch and <a href="#security.html">audited</a> it. It became <strong>6x smaller:</strong> ~5,000 lines of
code instead of ~24,000 (with all deps); 650KB instead of 10.2MB.
5 dependencies by 1 author are now used, instead of 38 by 5 authors.</p>
<p>Check out <a href="#upgrading.html">Upgrading</a> section and an article about the library:
<a href="https://medium.com/nomic-labs-blog/a-safer-smaller-and-faster-ethereum-cryptography-stack-5eeb47f62d79">A safer, smaller, and faster Ethereum cryptography stack</a>.</p>
<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h2>
</div>
<p>Use NPM / Yarn in node.js / browser:</p>
<pre><code class="bash"><span class="hljs-comment"># NPM</span>
npm install ethereum-cryptography

<span class="hljs-comment"># Yarn</span>
yarn add ethereum-cryptography
</code></pre>
<p>See <a href="#browser-usage.html">browser usage</a> for information on using the package with major Javascript bundlers. It is
tested with <strong>Webpack, Rollup, Parcel and Browserify</strong>.</p>
<p>This package has no single entry-point, but submodule for each cryptographic
primitive. Read each primitive's section of this document to learn how to use
them.</p>
<p>The reason for this is that importing everything from a single file will lead to
huge bundles when using this package for the web. This could be avoided through
tree-shaking, but the possibility of it not working properly on one of
<a href="#browser-usage.html">the supported bundlers</a> is too high.</p>
<pre><code class="js"><span class="hljs-comment">// Hashes</span>
<span class="hljs-keyword">import</span> { sha256 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/sha256.js"</span>;
<span class="hljs-keyword">import</span> { keccak256 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/keccak.js"</span>;
<span class="hljs-keyword">import</span> { ripemd160 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/ripemd160.js"</span>;
<span class="hljs-keyword">import</span> { blake2b } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/blake2b.js"</span>;

<span class="hljs-comment">// KDFs</span>
<span class="hljs-keyword">import</span> { pbkdf2Sync } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/pbkdf2.js"</span>;
<span class="hljs-keyword">import</span> { scryptSync } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/scrypt.js"</span>;

<span class="hljs-comment">// Random</span>
<span class="hljs-keyword">import</span> { getRandomBytesSync } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/random.js"</span>;

<span class="hljs-comment">// AES encryption</span>
<span class="hljs-keyword">import</span> { encrypt } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/aes.js"</span>;

<span class="hljs-comment">// secp256k1 elliptic curve operations</span>
<span class="hljs-keyword">import</span> { secp256k1 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/secp256k1.js"</span>;

<span class="hljs-comment">// BIP32 HD Keygen, BIP39 Mnemonic Phrases</span>
<span class="hljs-keyword">import</span> { HDKey } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/hdkey.js"</span>;
<span class="hljs-keyword">import</span> { generateMnemonic } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/bip39/index.js"</span>;
<span class="hljs-keyword">import</span> { wordlist } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/bip39/wordlists/english.js"</span>;

<span class="hljs-comment">// utilities</span>
<span class="hljs-keyword">import</span> { hexToBytes, toHex, utf8ToBytes } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;
</code></pre>
<div class="pilwrap" id="hashes-sha256-keccak-256-ripemd160-blake2b">
  <h2>
    <a href="#hashes-sha256-keccak-256-ripemd160-blake2b" name="hashes-sha256-keccak-256-ripemd160-blake2b" class="pilcrow"></a>
Hashes: SHA256, keccak-256, RIPEMD160, BLAKE2b
  </h2>
</div>
<pre><code class="typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sha256</span>(<span class="hljs-params">msg: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sha512</span>(<span class="hljs-params">msg: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">keccak256</span>(<span class="hljs-params">msg: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ripemd160</span>(<span class="hljs-params">msg: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blake2b</span>(<span class="hljs-params">msg: <span class="hljs-built_in">Uint8Array</span>, outputLength = 64</span>): <span class="hljs-title">Uint8Array</span></span>;
</code></pre>
<p>Exposes following cryptographic hash functions:</p>
<ul>
<li>SHA2 (SHA256, SHA512)</li>
<li>keccak-256 variant of SHA3 (also <code>keccak224</code>, <code>keccak384</code>,
and <code>keccak512</code>)</li>
<li>RIPEMD160</li>
<li>BLAKE2b</li>
</ul>
<pre><code class="js"><span class="hljs-keyword">import</span> { sha256 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/sha256.js"</span>;
<span class="hljs-keyword">import</span> { sha512 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/sha512.js"</span>;
<span class="hljs-keyword">import</span> { keccak256, keccak224, keccak384, keccak512 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/keccak.js"</span>;
<span class="hljs-keyword">import</span> { ripemd160 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/ripemd160.js"</span>;
<span class="hljs-keyword">import</span> { blake2b } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/blake2b.js"</span>;

sha256(<span class="hljs-built_in">Uint8Array</span>.from([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]))

<span class="hljs-comment">// Can be used with strings</span>
<span class="hljs-keyword">import</span> { utf8ToBytes } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;
sha256(utf8ToBytes(<span class="hljs-string">"abc"</span>))

<span class="hljs-comment">// If you need hex</span>
<span class="hljs-keyword">import</span> { bytesToHex <span class="hljs-keyword">as</span> toHex } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;
toHex(sha256(utf8ToBytes(<span class="hljs-string">"abc"</span>)))
</code></pre>
<div class="pilwrap" id="kdfs-pbkdf2-scrypt">
  <h2>
    <a href="#kdfs-pbkdf2-scrypt" name="kdfs-pbkdf2-scrypt" class="pilcrow"></a>
KDFs: PBKDF2, Scrypt
  </h2>
</div>
<pre><code class="ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pbkdf2</span>(<span class="hljs-params">password: <span class="hljs-built_in">Uint8Array</span>, salt: <span class="hljs-built_in">Uint8Array</span>, iterations: <span class="hljs-built_in">number</span>, keylen: <span class="hljs-built_in">number</span>, digest: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">Uint8Array</span>&gt;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pbkdf2Sync</span>(<span class="hljs-params">password: <span class="hljs-built_in">Uint8Array</span>, salt: <span class="hljs-built_in">Uint8Array</span>, iterations: <span class="hljs-built_in">number</span>, keylen: <span class="hljs-built_in">number</span>, digest: <span class="hljs-built_in">string</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scrypt</span>(<span class="hljs-params">password: <span class="hljs-built_in">Uint8Array</span>, salt: <span class="hljs-built_in">Uint8Array</span>, N: <span class="hljs-built_in">number</span>, p: <span class="hljs-built_in">number</span>, r: <span class="hljs-built_in">number</span>, dkLen: <span class="hljs-built_in">number</span>, onProgress?: (progress: <span class="hljs-built_in">number</span>) =&gt; <span class="hljs-built_in">void</span></span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">Uint8Array</span>&gt;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">scryptSync</span>(<span class="hljs-params">password: <span class="hljs-built_in">Uint8Array</span>, salt: <span class="hljs-built_in">Uint8Array</span>, N: <span class="hljs-built_in">number</span>, p: <span class="hljs-built_in">number</span>, r: <span class="hljs-built_in">number</span>, dkLen: <span class="hljs-built_in">number</span>, onProgress?: (progress: <span class="hljs-built_in">number</span>) =&gt; <span class="hljs-built_in">void</span></span>)): <span class="hljs-title">Uint8Array</span></span>;
</code></pre>
<p>The <code>pbkdf2</code> submodule has two functions implementing the PBKDF2 key
derivation algorithm in synchronous and asynchronous ways. This algorithm is
very slow, and using the synchronous version in the browser is not recommended,
as it will block its main thread and hang your UI. The KDF supports <code>sha256</code> and <code>sha512</code> digests.</p>
<p>The <code>scrypt</code> submodule has two functions implementing the Scrypt key
derivation algorithm in synchronous and asynchronous ways. This algorithm is
very slow, and using the synchronous version in the browser is not recommended,
as it will block its main thread and hang your UI.</p>
<p>Encoding passwords is a frequent source of errors. Please read
<a href="https://github.com/ricmoo/scrypt-js/tree/0eb70873ddf3d24e34b53e0d9a99a0cef06a79c0#encoding-notes">these notes</a>
before using these submodules.</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { pbkdf2 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/pbkdf2.js"</span>;
<span class="hljs-keyword">import</span> { utf8ToBytes } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;
<span class="hljs-comment">// Pass Uint8Array, or convert strings to Uint8Array</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> pbkdf2(utf8ToBytes(<span class="hljs-string">"password"</span>), utf8ToBytes(<span class="hljs-string">"salt"</span>), <span class="hljs-number">131072</span>, <span class="hljs-number">32</span>, <span class="hljs-string">"sha256"</span>));
</code></pre>
<pre><code class="js"><span class="hljs-keyword">import</span> { scrypt } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/scrypt.js"</span>;
<span class="hljs-keyword">import</span> { utf8ToBytes } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">await</span> scrypt(utf8ToBytes(<span class="hljs-string">"password"</span>), utf8ToBytes(<span class="hljs-string">"salt"</span>), <span class="hljs-number">262144</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">32</span>));
</code></pre>
<div class="pilwrap" id="csprng-cryptographically-strong-pseudorandom-number-generator">
  <h2>
    <a href="#csprng-cryptographically-strong-pseudorandom-number-generator" name="csprng-cryptographically-strong-pseudorandom-number-generator" class="pilcrow"></a>
CSPRNG (Cryptographically strong pseudorandom number generator)
  </h2>
</div>
<pre><code class="ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRandomBytes</span>(<span class="hljs-params">bytes: <span class="hljs-built_in">number</span></span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">Uint8Array</span>&gt;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRandomBytesSync</span>(<span class="hljs-params">bytes: <span class="hljs-built_in">number</span></span>): <span class="hljs-title">Uint8Array</span></span>;
</code></pre>
<p>The <code>random</code> submodule has functions to generate cryptographically strong
pseudo-random data in synchronous and asynchronous ways.</p>
<p>Backed by <a href="https://developer.mozilla.org/en-US/docs/Web/API/Crypto/getRandomValues"><code>crypto.getRandomValues</code></a> in browser and by <a href="https://nodejs.org/api/crypto.html#crypto_crypto_randombytes_size_callback"><code>crypto.randomBytes</code></a> in node.js. If backends are somehow not available, the module would throw an error and won't work, as keeping them working would be insecure.</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { getRandomBytesSync } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/random.js"</span>;
<span class="hljs-built_in">console</span>.log(getRandomBytesSync(<span class="hljs-number">32</span>));
</code></pre>
<div class="pilwrap" id="secp256k1-curve">
  <h2>
    <a href="#secp256k1-curve" name="secp256k1-curve" class="pilcrow"></a>
secp256k1 curve
  </h2>
</div>
<pre><code class="ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPublicKey</span>(<span class="hljs-params">privateKey: <span class="hljs-built_in">Uint8Array</span>, isCompressed = <span class="hljs-literal">true</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sign</span>(<span class="hljs-params">msgHash: <span class="hljs-built_in">Uint8Array</span>, privateKey: <span class="hljs-built_in">Uint8Array</span></span>): </span>{ r: bigint; s: bigint; recovery: <span class="hljs-built_in">number</span> };
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">verify</span>(<span class="hljs-params">signature: <span class="hljs-built_in">Uint8Array</span>, msgHash: <span class="hljs-built_in">Uint8Array</span>, publicKey: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title">boolean</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSharedSecret</span>(<span class="hljs-params">privateKeyA: <span class="hljs-built_in">Uint8Array</span>, publicKeyB: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">utils</span>.<span class="hljs-title">randomPrivateKey</span>(<span class="hljs-params"></span>): <span class="hljs-title">Uint8Array</span></span>;
</span></code></pre>
<p>The <code>secp256k1</code> submodule provides a library for elliptic curve operations on
the curve secp256k1. For detailed documentation, follow <a href="https://github.com/paulmillr/noble-curves">README of <code>noble-curves</code></a>, which the module uses as a backend.</p>
<p>secp256k1 private keys need to be cryptographically secure random numbers with
certain characteristics. If this is not the case, the security of secp256k1 is
compromised. We strongly recommend using <code>utils.randomPrivateKey()</code> to generate them.</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { secp256k1 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/secp256k1.js"</span>;
<span class="hljs-function">(<span class="hljs-params"><span class="hljs-keyword">async</span> (</span>) =&gt;</span> {
  <span class="hljs-comment">// You pass either a hex string, or Uint8Array</span>
  <span class="hljs-keyword">const</span> privateKey = <span class="hljs-string">"6b911fd37cdf5c81d4c0adb1ab7fa822ed253ab0ad9aa18d77257c88b29b718e"</span>;
  <span class="hljs-keyword">const</span> messageHash = <span class="hljs-string">"a33321f98e4ff1c283c76998f14f57447545d339b3db534c6d886decb4209f28"</span>;
  <span class="hljs-keyword">const</span> publicKey = secp256k1.getPublicKey(privateKey);
  <span class="hljs-keyword">const</span> signature = secp256k1.sign(messageHash, privateKey);
  <span class="hljs-keyword">const</span> isSigned = secp256k1.verify(signature, messageHash, publicKey);
})();
</code></pre>
<p>We're also providing a compatibility layer for users who want to upgrade
from <code>tiny-secp256k1</code> or <code>secp256k1</code> modules without hassle.
Check out <a href="#legacy-secp256k1-compatibility-layer.html">secp256k1 compatibility layer</a>.</p>
<div class="pilwrap" id="bip32-hd-keygen">
  <h2>
    <a href="#bip32-hd-keygen" name="bip32-hd-keygen" class="pilcrow"></a>
BIP32 HD Keygen
  </h2>
</div>
<p>Hierarchical deterministic (HD) wallets that conform to BIP32 standard.
Also available as standalone package <a href="https://github.com/paulmillr/scure-bip32">scure-bip32</a>.</p>
<p>This module exports a single class <code>HDKey</code>, which should be used like this:</p>
<pre><code class="ts"><span class="hljs-keyword">import</span> { HDKey } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/hdkey.js"</span>;
<span class="hljs-keyword">const</span> hdkey1 = HDKey.fromMasterSeed(seed);
<span class="hljs-keyword">const</span> hdkey2 = HDKey.fromExtendedKey(base58key);
<span class="hljs-keyword">const</span> hdkey3 = HDKey.fromJSON({ xpriv: <span class="hljs-built_in">string</span> });

<span class="hljs-comment">// props</span>
[hdkey1.depth, hdkey1.index, hdkey1.chainCode];
<span class="hljs-built_in">console</span>.log(hdkey2.privateKey, hdkey2.publicKey);
<span class="hljs-built_in">console</span>.log(hdkey3.derive(<span class="hljs-string">"m/0/2147483647'/1"</span>));
<span class="hljs-keyword">const</span> sig = hdkey3.sign(hash);
hdkey3.verify(hash, sig);
</code></pre>
<p>Note: <code>chainCode</code> property is essentially a private part
of a secret &quot;master&quot; key, it should be guarded from unauthorized access.</p>
<p>The full API is:</p>
<pre><code class="ts"><span class="hljs-keyword">class</span> HDKey {
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> HARDENED_OFFSET: <span class="hljs-built_in">number</span>;
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> fromMasterSeed(seed: <span class="hljs-built_in">Uint8Array</span>, versions: Versions): HDKey;
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> fromExtendedKey(base58key: <span class="hljs-built_in">string</span>, versions: Versions): HDKey;
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> fromJSON(json: { xpriv: <span class="hljs-built_in">string</span> }): HDKey;

  readonly versions: Versions;
  readonly depth: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  readonly index: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
  readonly chainCode: <span class="hljs-built_in">Uint8Array</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  readonly parentFingerprint: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">get</span> fingerprint(): <span class="hljs-built_in">number</span>;
  <span class="hljs-keyword">get</span> identifier(): <span class="hljs-built_in">Uint8Array</span> | <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">get</span> pubKeyHash(): <span class="hljs-built_in">Uint8Array</span> | <span class="hljs-literal">undefined</span>;
  <span class="hljs-keyword">get</span> privateKey(): <span class="hljs-built_in">Uint8Array</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">get</span> publicKey(): <span class="hljs-built_in">Uint8Array</span> | <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">get</span> privateExtendedKey(): <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">get</span> publicExtendedKey(): <span class="hljs-built_in">string</span>;

  derive(path: <span class="hljs-built_in">string</span>): HDKey;
  deriveChild(index: <span class="hljs-built_in">number</span>): HDKey;
  sign(hash: <span class="hljs-built_in">Uint8Array</span>): <span class="hljs-built_in">Uint8Array</span>;
  verify(hash: <span class="hljs-built_in">Uint8Array</span>, signature: <span class="hljs-built_in">Uint8Array</span>): <span class="hljs-built_in">boolean</span>;
  wipePrivateData(): <span class="hljs-keyword">this</span>;
}

<span class="hljs-keyword">interface</span> Versions {
  <span class="hljs-keyword">private</span>: <span class="hljs-built_in">number</span>;
  <span class="hljs-keyword">public</span>: <span class="hljs-built_in">number</span>;
}
</code></pre>
<p>The <code>hdkey</code> submodule provides a library for keys derivation according to
<a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki">BIP32</a>.</p>
<p>It has almost the exact same API than the version <code>1.x</code> of
<a href="https://github.com/cryptocoinjs/hdkey"><code>hdkey</code> from cryptocoinjs</a>,
but it's backed by this package's primitives, and has built-in TypeScript types.
Its only difference is that it has to be used with a named import.
The implementation is <a href="#LICENSE.html">loosely based on hdkey, which has MIT License</a>.</p>
<div class="pilwrap" id="bip39-mnemonic-seed-phrase">
  <h2>
    <a href="#bip39-mnemonic-seed-phrase" name="bip39-mnemonic-seed-phrase" class="pilcrow"></a>
BIP39 Mnemonic Seed Phrase
  </h2>
</div>
<pre><code class="ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateMnemonic</span>(<span class="hljs-params">wordlist: <span class="hljs-built_in">string</span>[], strength: <span class="hljs-built_in">number</span> = 128</span>): <span class="hljs-title">string</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mnemonicToEntropy</span>(<span class="hljs-params">mnemonic: <span class="hljs-built_in">string</span>, wordlist: <span class="hljs-built_in">string</span>[]</span>): <span class="hljs-title">Uint8Array</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">entropyToMnemonic</span>(<span class="hljs-params">entropy: <span class="hljs-built_in">Uint8Array</span>, wordlist: <span class="hljs-built_in">string</span>[]</span>): <span class="hljs-title">string</span></span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateMnemonic</span>(<span class="hljs-params">mnemonic: <span class="hljs-built_in">string</span>, wordlist: <span class="hljs-built_in">string</span>[]</span>): <span class="hljs-title">boolean</span></span>;
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mnemonicToSeed</span>(<span class="hljs-params">mnemonic: <span class="hljs-built_in">string</span>, passphrase: <span class="hljs-built_in">string</span> = ""</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">Uint8Array</span>&gt;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mnemonicToSeedSync</span>(<span class="hljs-params">mnemonic: <span class="hljs-built_in">string</span>, passphrase: <span class="hljs-built_in">string</span> = ""</span>): <span class="hljs-title">Uint8Array</span></span>;
</code></pre>
<p>The <code>bip39</code> submodule provides functions to generate, validate and use seed
recovery phrases according to <a href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP39</a>.</p>
<p>Also available as standalone package <a href="https://github.com/paulmillr/scure-bip39">scure-bip39</a>.</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { generateMnemonic } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/bip39/index.js"</span>;
<span class="hljs-keyword">import</span> { wordlist } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/bip39/wordlists/english.js"</span>;
<span class="hljs-built_in">console</span>.log(generateMnemonic(wordlist));
</code></pre>
<p>This submodule also contains the word lists defined by BIP39 for Czech, English,
French, Italian, Japanese, Korean, Simplified and Traditional Chinese, and
Spanish. These are not imported by default, as that would increase bundle sizes
too much. Instead, you should import and use them explicitly.</p>
<p>The word lists are exported as a <code>wordlist</code> variable in each of these submodules:</p>
<ul>
<li><code>ethereum-cryptography/bip39/wordlists/czech.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/english.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/french.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/italian.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/japanese.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/korean.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/portuguese.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/simplified-chinese.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/spanish.js</code></li>
<li><code>ethereum-cryptography/bip39/wordlists/traditional-chinese.js</code></li>
</ul>
<div class="pilwrap" id="aes-encryption">
  <h2>
    <a href="#aes-encryption" name="aes-encryption" class="pilcrow"></a>
AES Encryption
  </h2>
</div>
<pre><code class="ts"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params">msg: <span class="hljs-built_in">Uint8Array</span>, key: <span class="hljs-built_in">Uint8Array</span>, iv: <span class="hljs-built_in">Uint8Array</span>, mode = "aes-128-ctr", pkcs7PaddingEnabled = <span class="hljs-literal">true</span></span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">Uint8Array</span>&gt;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decrypt</span>(<span class="hljs-params">cypherText: <span class="hljs-built_in">Uint8Array</span>, key: <span class="hljs-built_in">Uint8Array</span>, iv: <span class="hljs-built_in">Uint8Array</span>, mode = "aes-128-ctr", pkcs7PaddingEnabled = <span class="hljs-literal">true</span></span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">Uint8Array</span>&gt;</span>;
</code></pre>
<p>The <code>aes</code> submodule contains encryption and decryption functions implementing
the <a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Advanced Encryption Standard</a>
algorithm.</p>
<div class="pilwrap" id="encrypting-with-passwords">
  <h3>
    <a href="#encrypting-with-passwords" name="encrypting-with-passwords" class="pilcrow"></a>
Encrypting with passwords
  </h3>
</div>
<p>AES is not supposed to be used directly with a password. Doing that will
compromise your users' security.</p>
<p>The <code>key</code> parameters in this submodule are meant to be strong cryptographic
keys. If you want to obtain such a key from a password, please use a
<a href="https://en.wikipedia.org/wiki/Key_derivation_function">key derivation function</a>
like <a href="#kdfs-pbkdf2-scrypt.html">pbkdf2</a> or <a href="#kdfs-pbkdf2-scrypt.html">scrypt</a>.</p>
<div class="pilwrap" id="operation-modes">
  <h3>
    <a href="#operation-modes" name="operation-modes" class="pilcrow"></a>
Operation modes
  </h3>
</div>
<p>This submodule works with different <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">block cipher modes of operation</a>. If you are using this module in a new
application, we recommend using the default.</p>
<p>While this module may work with any mode supported by OpenSSL, we only test it
with <code>aes-128-ctr</code>, <code>aes-128-cbc</code>, and <code>aes-256-cbc</code>. If you use another module
a warning will be printed in the console.</p>
<p>We only recommend using <code>aes-128-cbc</code> and <code>aes-256-cbc</code> to decrypt already
encrypted data.</p>
<div class="pilwrap" id="padding-plaintext-messages">
  <h3>
    <a href="#padding-plaintext-messages" name="padding-plaintext-messages" class="pilcrow"></a>
Padding plaintext messages
  </h3>
</div>
<p>Some operation modes require the plaintext message to be a multiple of <code>16</code>. If
that isn't the case, your message has to be padded.</p>
<p>By default, this module automatically pads your messages according to <a href="https://tools.ietf.org/html/rfc2315">PKCS#7</a>.
Note that this padding scheme always adds at least 1 byte of padding. If you
are unsure what anything of this means, we <strong>strongly</strong> recommend you to use
the defaults.</p>
<p>If you need to encrypt without padding or want to use another padding scheme,
you can disable PKCS#7 padding by passing <code>false</code> as the last argument and
handling padding yourself. Note that if you do this and your operation mode
requires padding, <code>encrypt</code> will throw if your plaintext message isn't a
multiple of <code>16</code>.</p>
<p>This option is only present to enable the decryption of already encrypted data.
To encrypt new data, we recommend using the default.</p>
<div class="pilwrap" id="how-to-use-the-iv-parameter">
  <h3>
    <a href="#how-to-use-the-iv-parameter" name="how-to-use-the-iv-parameter" class="pilcrow"></a>
How to use the IV parameter
  </h3>
</div>
<p>The <code>iv</code> parameter of the <code>encrypt</code> function must be unique, or the security
of the encryption algorithm can be compromised.</p>
<p>You can generate a new <code>iv</code> using the <code>random</code> module.</p>
<p>Note that to decrypt a value, you have to provide the same <code>iv</code> used to encrypt
it.</p>
<div class="pilwrap" id="how-to-handle-errors-with-this-module">
  <h3>
    <a href="#how-to-handle-errors-with-this-module" name="how-to-handle-errors-with-this-module" class="pilcrow"></a>
How to handle errors with this module
  </h3>
</div>
<p>Sensitive information can be leaked via error messages when using this module.
To avoid this, you should make sure that the errors you return don't
contain the exact reason for the error. Instead, errors must report general
encryption/decryption failures.</p>
<p>Note that implementing this can mean catching all errors that can be thrown
when calling on of this module's functions, and just throwing a new generic
exception.</p>
<div class="pilwrap" id="example-usage">
  <h3>
    <a href="#example-usage" name="example-usage" class="pilcrow"></a>
Example usage
  </h3>
</div>
<pre><code class="js"><span class="hljs-keyword">import</span> { encrypt } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/aes.js"</span>;
<span class="hljs-keyword">import</span> { hexToBytes, utf8ToBytes } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;

<span class="hljs-built_in">console</span>.log(
  encrypt(
    utf8ToBytes(<span class="hljs-string">"message"</span>),
    hexToBytes(<span class="hljs-string">"2b7e151628aed2a6abf7158809cf4f3c"</span>),
    hexToBytes(<span class="hljs-string">"f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"</span>)
  )
);
</code></pre>
<div class="pilwrap" id="browser-usage">
  <h2>
    <a href="#browser-usage" name="browser-usage" class="pilcrow"></a>
Browser usage
  </h2>
</div>
<div class="pilwrap" id="rollup-setup">
  <h3>
    <a href="#rollup-setup" name="rollup-setup" class="pilcrow"></a>
Rollup setup
  </h3>
</div>
<p>Using this library with Rollup requires the following plugins:</p>
<ul>
<li><a href="https://www.npmjs.com/package/@rollup/plugin-commonjs"><code>@rollup/plugin-commonjs</code></a></li>
<li><a href="https://www.npmjs.com/package/@rollup/plugin-node-resolve"><code>@rollup/plugin-node-resolve</code></a></li>
</ul>
<p>These can be used by setting your <code>plugins</code> array like this:</p>
<pre><code class="js">  plugins: [
    commonjs(),
    resolve({
      <span class="hljs-attr">browser</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">preferBuiltins</span>: <span class="hljs-literal">false</span>,
    }),
  ]
</code></pre>
<div class="pilwrap" id="legacy-secp256k1-compatibility-layer">
  <h2>
    <a href="#legacy-secp256k1-compatibility-layer" name="legacy-secp256k1-compatibility-layer" class="pilcrow"></a>
Legacy secp256k1 compatibility layer
  </h2>
</div>
<p><strong>Warning:</strong> use <code>secp256k1</code> instead. This module is only for users who upgraded
from ethereum-cryptography v0.1. It could be removed in the future.</p>
<p>The API of <code>secp256k1-compat</code> is the same as <a href="https://github.com/cryptocoinjs/secp256k1-node">secp256k1-node</a>:</p>
<pre><code class="js"><span class="hljs-keyword">import</span> { createPrivateKeySync, ecdsaSign } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/secp256k1-compat"</span>;
<span class="hljs-keyword">const</span> msgHash = <span class="hljs-built_in">Uint8Array</span>.from(
  <span class="hljs-string">"82ff40c0a986c6a5cfad4ddf4c3aa6996f1a7837f9c398e17e5de5cbd5a12b28"</span>,
  <span class="hljs-string">"hex"</span>
);
<span class="hljs-keyword">const</span> privateKey = createPrivateKeySync();
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Uint8Array</span>.from(ecdsaSign(msgHash, privateKey).signature));
</code></pre>
<div class="pilwrap" id="missing-cryptographic-primitives">
  <h2>
    <a href="#missing-cryptographic-primitives" name="missing-cryptographic-primitives" class="pilcrow"></a>
Missing cryptographic primitives
  </h2>
</div>
<p>This package intentionally excludes the cryptographic primitives necessary
to implement the following EIPs:</p>
<ul>
<li><a href="https://eips.ethereum.org/EIPS/eip-196">EIP 196: Precompiled contracts for addition and scalar multiplication on the elliptic curve alt_bn128</a></li>
<li><a href="https://eips.ethereum.org/EIPS/eip-197">EIP 197: Precompiled contracts for optimal ate pairing check on the elliptic curve alt_bn128</a></li>
<li><a href="https://eips.ethereum.org/EIPS/eip-198">EIP 198: Big integer modular exponentiation</a></li>
<li><a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-152.md">EIP 152: Add Blake2 compression function <code>F</code> precompile</a></li>
</ul>
<p>Feel free to open an issue if you want this decision to be reconsidered, or if
you found another primitive that is missing.</p>
<div class="pilwrap" id="upgrading">
  <h2>
    <a href="#upgrading" name="upgrading" class="pilcrow"></a>
Upgrading
  </h2>
</div>
<p>Upgrading from 1.0 to 2.0:</p>
<ol>
<li><code>secp256k1</code> module was changed massively:
before, it was using <a href="https://github.com/paulmillr/noble-secp256k1">noble-secp256k1 1.7</a>;
now it uses safer <a href="https://github.com/paulmillr/noble-curves">noble-curves</a>. Please refer
to <a href="https://github.com/paulmillr/noble-curves#upgrading">upgrading section from curves README</a>.
Main changes to keep in mind: a) <code>sign</code> now returns <code>Signature</code> instance
b) <code>recoverPublicKey</code> got moved onto a <code>Signature</code> instance</li>
<li>node.js 14 and older support was dropped. Upgrade to node.js 16 or later.</li>
</ol>
<p>Upgrading from 0.1 to 1.0: <strong>Same functionality</strong>, all old APIs remain the same except for the breaking changes:</p>
<ol>
<li>We return <code>Uint8Array</code> from all methods that worked with <code>Buffer</code> before.
<code>Buffer</code> has never been supported in browsers, while <code>Uint8Array</code>s are supported natively in both
browsers and node.js.</li>
<li>We target runtimes with <a href="https://caniuse.com/bigint">bigint</a> support,
which is Chrome 67+, Edge 79+, Firefox 68+, Safari 14+, node.js 10+. If you need to support older runtimes, use <code>ethereum-cryptography@0.1</code></li>
<li>If you've used <code>secp256k1</code>, <a href="#legacy-secp256k1-compatibility-layer.html">rename it to <code>secp256k1-compat</code></a></li>
</ol>
<pre><code class="js"><span class="hljs-keyword">import</span> { sha256 } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/sha256.js"</span>;

<span class="hljs-comment">// Old usage</span>
<span class="hljs-keyword">const</span> hasho = sha256(Buffer.from(<span class="hljs-string">"string"</span>, <span class="hljs-string">"utf8"</span>)).toString(<span class="hljs-string">"hex"</span>);

<span class="hljs-comment">// New usage</span>
<span class="hljs-keyword">import</span> { toHex } <span class="hljs-keyword">from</span> <span class="hljs-string">"ethereum-cryptography/utils.js"</span>;
<span class="hljs-keyword">const</span> hashn = toHex(sha256(<span class="hljs-string">"string"</span>));

<span class="hljs-comment">// If you have `Buffer` module and want to preserve it:</span>
<span class="hljs-keyword">const</span> hashb = Buffer.from(sha256(<span class="hljs-string">"string"</span>));
<span class="hljs-keyword">const</span> hashbo = hashb.toString(<span class="hljs-string">"hex"</span>);
</code></pre>
<div class="pilwrap" id="security">
  <h2>
    <a href="#security" name="security" class="pilcrow"></a>
Security
  </h2>
</div>
<p>Audited by Cure53 on Jan 5, 2022. Check out the audit <a href="./audit/2022-01-05-cure53-audit-nbl2.pdf.html">PDF</a> &amp; <a href="https://cure53.de/pentest-report_hashing-libs.pdf">URL</a>.</p>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p><code>ethereum-cryptography</code> is released under The MIT License (MIT)</p>
<p>Copyright (c) 2021 Patricio Palladino, Paul Miller, ethereum-cryptography contributors</p>
<p>See <a href="./LICENSE.html">LICENSE</a> file.</p>
<p><code>hdkey</code> is loosely based on <a href="https://github.com/cryptocoinjs/hdkey">hdkey</a>,
which had <a href="https://github.com/cryptocoinjs/hdkey/blob/3f3c0b5cedb98f971835b5116ebea05b3c09422a/LICENSE">MIT License</a></p>
<p>Copyright (c) 2018 cryptocoinjs</p>
</div>
  </div>
</body>
</html>
