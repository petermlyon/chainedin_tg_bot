<!DOCTYPE html>
<html>
<head>
  <title>sha512.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "node_modules/@noble/hashes/sha512.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#sourcemappingurlsha512.js.map">sourceMappingURL=sha512.js.map</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>sha512.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">"use strict"</span>;
<span class="hljs-built_in">Object</span>.defineProperty(exports, <span class="hljs-string">"__esModule"</span>, { <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span> });
exports.sha384 = exports.sha512_256 = exports.sha512_224 = exports.sha512 = exports.SHA512 = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> _md_js_1 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./_md.js"</span>);
<span class="hljs-keyword">const</span> _u64_js_1 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./_u64.js"</span>);
<span class="hljs-keyword">const</span> utils_js_1 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"./utils.js"</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>Round contants (first 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409):
prettier-ignore</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">const</span> [SHA512_Kh, SHA512_Kl] = <span class="hljs-comment">/* @__PURE__ */</span> <span class="hljs-function">(<span class="hljs-params">(</span>) =&gt;</span> _u64_js_1.default.split([
    <span class="hljs-string">'0x428a2f98d728ae22'</span>, <span class="hljs-string">'0x7137449123ef65cd'</span>, <span class="hljs-string">'0xb5c0fbcfec4d3b2f'</span>, <span class="hljs-string">'0xe9b5dba58189dbbc'</span>,
    <span class="hljs-string">'0x3956c25bf348b538'</span>, <span class="hljs-string">'0x59f111f1b605d019'</span>, <span class="hljs-string">'0x923f82a4af194f9b'</span>, <span class="hljs-string">'0xab1c5ed5da6d8118'</span>,
    <span class="hljs-string">'0xd807aa98a3030242'</span>, <span class="hljs-string">'0x12835b0145706fbe'</span>, <span class="hljs-string">'0x243185be4ee4b28c'</span>, <span class="hljs-string">'0x550c7dc3d5ffb4e2'</span>,
    <span class="hljs-string">'0x72be5d74f27b896f'</span>, <span class="hljs-string">'0x80deb1fe3b1696b1'</span>, <span class="hljs-string">'0x9bdc06a725c71235'</span>, <span class="hljs-string">'0xc19bf174cf692694'</span>,
    <span class="hljs-string">'0xe49b69c19ef14ad2'</span>, <span class="hljs-string">'0xefbe4786384f25e3'</span>, <span class="hljs-string">'0x0fc19dc68b8cd5b5'</span>, <span class="hljs-string">'0x240ca1cc77ac9c65'</span>,
    <span class="hljs-string">'0x2de92c6f592b0275'</span>, <span class="hljs-string">'0x4a7484aa6ea6e483'</span>, <span class="hljs-string">'0x5cb0a9dcbd41fbd4'</span>, <span class="hljs-string">'0x76f988da831153b5'</span>,
    <span class="hljs-string">'0x983e5152ee66dfab'</span>, <span class="hljs-string">'0xa831c66d2db43210'</span>, <span class="hljs-string">'0xb00327c898fb213f'</span>, <span class="hljs-string">'0xbf597fc7beef0ee4'</span>,
    <span class="hljs-string">'0xc6e00bf33da88fc2'</span>, <span class="hljs-string">'0xd5a79147930aa725'</span>, <span class="hljs-string">'0x06ca6351e003826f'</span>, <span class="hljs-string">'0x142929670a0e6e70'</span>,
    <span class="hljs-string">'0x27b70a8546d22ffc'</span>, <span class="hljs-string">'0x2e1b21385c26c926'</span>, <span class="hljs-string">'0x4d2c6dfc5ac42aed'</span>, <span class="hljs-string">'0x53380d139d95b3df'</span>,
    <span class="hljs-string">'0x650a73548baf63de'</span>, <span class="hljs-string">'0x766a0abb3c77b2a8'</span>, <span class="hljs-string">'0x81c2c92e47edaee6'</span>, <span class="hljs-string">'0x92722c851482353b'</span>,
    <span class="hljs-string">'0xa2bfe8a14cf10364'</span>, <span class="hljs-string">'0xa81a664bbc423001'</span>, <span class="hljs-string">'0xc24b8b70d0f89791'</span>, <span class="hljs-string">'0xc76c51a30654be30'</span>,
    <span class="hljs-string">'0xd192e819d6ef5218'</span>, <span class="hljs-string">'0xd69906245565a910'</span>, <span class="hljs-string">'0xf40e35855771202a'</span>, <span class="hljs-string">'0x106aa07032bbd1b8'</span>,
    <span class="hljs-string">'0x19a4c116b8d2d0c8'</span>, <span class="hljs-string">'0x1e376c085141ab53'</span>, <span class="hljs-string">'0x2748774cdf8eeb99'</span>, <span class="hljs-string">'0x34b0bcb5e19b48a8'</span>,
    <span class="hljs-string">'0x391c0cb3c5c95a63'</span>, <span class="hljs-string">'0x4ed8aa4ae3418acb'</span>, <span class="hljs-string">'0x5b9cca4f7763e373'</span>, <span class="hljs-string">'0x682e6ff3d6b2b8a3'</span>,
    <span class="hljs-string">'0x748f82ee5defb2fc'</span>, <span class="hljs-string">'0x78a5636f43172f60'</span>, <span class="hljs-string">'0x84c87814a1f0ab72'</span>, <span class="hljs-string">'0x8cc702081a6439ec'</span>,
    <span class="hljs-string">'0x90befffa23631e28'</span>, <span class="hljs-string">'0xa4506cebde82bde9'</span>, <span class="hljs-string">'0xbef9a3f7b2c67915'</span>, <span class="hljs-string">'0xc67178f2e372532b'</span>,
    <span class="hljs-string">'0xca273eceea26619c'</span>, <span class="hljs-string">'0xd186b8c721c0c207'</span>, <span class="hljs-string">'0xeada7dd6cde0eb1e'</span>, <span class="hljs-string">'0xf57d4f7fee6ed178'</span>,
    <span class="hljs-string">'0x06f067aa72176fba'</span>, <span class="hljs-string">'0x0a637dc5a2c898a6'</span>, <span class="hljs-string">'0x113f9804bef90dae'</span>, <span class="hljs-string">'0x1b710b35131c471b'</span>,
    <span class="hljs-string">'0x28db77f523047d84'</span>, <span class="hljs-string">'0x32caab7b40c72493'</span>, <span class="hljs-string">'0x3c9ebe0a15c9bebc'</span>, <span class="hljs-string">'0x431d67c49c100d4c'</span>,
    <span class="hljs-string">'0x4cc5d4becb3e42b6'</span>, <span class="hljs-string">'0x597f299cfc657e2a'</span>, <span class="hljs-string">'0x5fcb6fab3ad6faec'</span>, <span class="hljs-string">'0x6c44198c4a475817'</span>
].map(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> BigInt(n))))();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Temporary buffer, not used to store anything between runs</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">const</span> SHA512_W_H = <span class="hljs-comment">/* @__PURE__ */</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint32Array</span>(<span class="hljs-number">80</span>);
<span class="hljs-keyword">const</span> SHA512_W_L = <span class="hljs-comment">/* @__PURE__ */</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint32Array</span>(<span class="hljs-number">80</span>);
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SHA512</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">_md_js_1</span>.<span class="hljs-title">HashMD</span> </span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">super</span>(<span class="hljs-number">128</span>, <span class="hljs-number">64</span>, <span class="hljs-number">16</span>, <span class="hljs-literal">false</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>We cannot use array here since array allows indexing by variable which means optimizer/compiler cannot use registers.
Also looks cleaner and easier to verify with spec.
Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):
h -- high 32 bits, l -- low 32 bits</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">this</span>.Ah = <span class="hljs-number">0x6a09e667</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Al = <span class="hljs-number">0xf3bcc908</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bh = <span class="hljs-number">0xbb67ae85</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bl = <span class="hljs-number">0x84caa73b</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Ch = <span class="hljs-number">0x3c6ef372</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Cl = <span class="hljs-number">0xfe94f82b</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dh = <span class="hljs-number">0xa54ff53a</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dl = <span class="hljs-number">0x5f1d36f1</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Eh = <span class="hljs-number">0x510e527f</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.El = <span class="hljs-number">0xade682d1</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fh = <span class="hljs-number">0x9b05688c</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fl = <span class="hljs-number">0x2b3e6c1f</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gh = <span class="hljs-number">0x1f83d9ab</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gl = <span class="hljs-number">0xfb41bd6b</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hh = <span class="hljs-number">0x5be0cd19</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hl = <span class="hljs-number">0x137e2179</span> | <span class="hljs-number">0</span>;
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>prettier-ignore</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">get</span>() {
        <span class="hljs-keyword">const</span> { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = <span class="hljs-keyword">this</span>;
        <span class="hljs-keyword">return</span> [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];
    }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>prettier-ignore</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">set</span>(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {
        <span class="hljs-keyword">this</span>.Ah = Ah | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Al = Al | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bh = Bh | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bl = Bl | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Ch = Ch | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Cl = Cl | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dh = Dh | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dl = Dl | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Eh = Eh | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.El = El | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fh = Fh | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fl = Fl | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gh = Gh | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gl = Gl | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hh = Hh | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hl = Hl | <span class="hljs-number">0</span>;
    }
    process(view, offset) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++, offset += <span class="hljs-number">4</span>) {
            SHA512_W_H[i] = view.getUint32(offset);
            SHA512_W_L[i] = view.getUint32((offset += <span class="hljs-number">4</span>));
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">16</span>; i &lt; <span class="hljs-number">80</span>; i++) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> W15h = SHA512_W_H[i - <span class="hljs-number">15</span>] | <span class="hljs-number">0</span>;
            <span class="hljs-keyword">const</span> W15l = SHA512_W_L[i - <span class="hljs-number">15</span>] | <span class="hljs-number">0</span>;
            <span class="hljs-keyword">const</span> s0h = _u64_js_1.default.rotrSH(W15h, W15l, <span class="hljs-number">1</span>) ^ _u64_js_1.default.rotrSH(W15h, W15l, <span class="hljs-number">8</span>) ^ _u64_js_1.default.shrSH(W15h, W15l, <span class="hljs-number">7</span>);
            <span class="hljs-keyword">const</span> s0l = _u64_js_1.default.rotrSL(W15h, W15l, <span class="hljs-number">1</span>) ^ _u64_js_1.default.rotrSL(W15h, W15l, <span class="hljs-number">8</span>) ^ _u64_js_1.default.shrSL(W15h, W15l, <span class="hljs-number">7</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> W2h = SHA512_W_H[i - <span class="hljs-number">2</span>] | <span class="hljs-number">0</span>;
            <span class="hljs-keyword">const</span> W2l = SHA512_W_L[i - <span class="hljs-number">2</span>] | <span class="hljs-number">0</span>;
            <span class="hljs-keyword">const</span> s1h = _u64_js_1.default.rotrSH(W2h, W2l, <span class="hljs-number">19</span>) ^ _u64_js_1.default.rotrBH(W2h, W2l, <span class="hljs-number">61</span>) ^ _u64_js_1.default.shrSH(W2h, W2l, <span class="hljs-number">6</span>);
            <span class="hljs-keyword">const</span> s1l = _u64_js_1.default.rotrSL(W2h, W2l, <span class="hljs-number">19</span>) ^ _u64_js_1.default.rotrBL(W2h, W2l, <span class="hljs-number">61</span>) ^ _u64_js_1.default.shrSL(W2h, W2l, <span class="hljs-number">6</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> SUMl = _u64_js_1.default.add4L(s0l, s1l, SHA512_W_L[i - <span class="hljs-number">7</span>], SHA512_W_L[i - <span class="hljs-number">16</span>]);
            <span class="hljs-keyword">const</span> SUMh = _u64_js_1.default.add4H(SUMl, s0h, s1h, SHA512_W_H[i - <span class="hljs-number">7</span>], SHA512_W_H[i - <span class="hljs-number">16</span>]);
            SHA512_W_H[i] = SUMh | <span class="hljs-number">0</span>;
            SHA512_W_L[i] = SUMl | <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">let</span> { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = <span class="hljs-keyword">this</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Compression function main loop, 80 rounds</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">80</span>; i++) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> sigma1h = _u64_js_1.default.rotrSH(Eh, El, <span class="hljs-number">14</span>) ^ _u64_js_1.default.rotrSH(Eh, El, <span class="hljs-number">18</span>) ^ _u64_js_1.default.rotrBH(Eh, El, <span class="hljs-number">41</span>);
            <span class="hljs-keyword">const</span> sigma1l = _u64_js_1.default.rotrSL(Eh, El, <span class="hljs-number">14</span>) ^ _u64_js_1.default.rotrSL(Eh, El, <span class="hljs-number">18</span>) ^ _u64_js_1.default.rotrBL(Eh, El, <span class="hljs-number">41</span>);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> CHIh = (Eh &amp; Fh) ^ (~Eh &amp; Gh);
            <span class="hljs-keyword">const</span> CHIl = (El &amp; Fl) ^ (~El &amp; Gl);
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-14" id="section-14"></a>
</div>
<p>T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]
prettier-ignore</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> T1ll = _u64_js_1.default.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);
            <span class="hljs-keyword">const</span> T1h = _u64_js_1.default.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);
            <span class="hljs-keyword">const</span> T1l = T1ll | <span class="hljs-number">0</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15"></a>
</div>
<p>S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">const</span> sigma0h = _u64_js_1.default.rotrSH(Ah, Al, <span class="hljs-number">28</span>) ^ _u64_js_1.default.rotrBH(Ah, Al, <span class="hljs-number">34</span>) ^ _u64_js_1.default.rotrBH(Ah, Al, <span class="hljs-number">39</span>);
            <span class="hljs-keyword">const</span> sigma0l = _u64_js_1.default.rotrSL(Ah, Al, <span class="hljs-number">28</span>) ^ _u64_js_1.default.rotrBL(Ah, Al, <span class="hljs-number">34</span>) ^ _u64_js_1.default.rotrBL(Ah, Al, <span class="hljs-number">39</span>);
            <span class="hljs-keyword">const</span> MAJh = (Ah &amp; Bh) ^ (Ah &amp; Ch) ^ (Bh &amp; Ch);
            <span class="hljs-keyword">const</span> MAJl = (Al &amp; Bl) ^ (Al &amp; Cl) ^ (Bl &amp; Cl);
            Hh = Gh | <span class="hljs-number">0</span>;
            Hl = Gl | <span class="hljs-number">0</span>;
            Gh = Fh | <span class="hljs-number">0</span>;
            Gl = Fl | <span class="hljs-number">0</span>;
            Fh = Eh | <span class="hljs-number">0</span>;
            Fl = El | <span class="hljs-number">0</span>;
            ({ <span class="hljs-attr">h</span>: Eh, <span class="hljs-attr">l</span>: El } = _u64_js_1.default.add(Dh | <span class="hljs-number">0</span>, Dl | <span class="hljs-number">0</span>, T1h | <span class="hljs-number">0</span>, T1l | <span class="hljs-number">0</span>));
            Dh = Ch | <span class="hljs-number">0</span>;
            Dl = Cl | <span class="hljs-number">0</span>;
            Ch = Bh | <span class="hljs-number">0</span>;
            Cl = Bl | <span class="hljs-number">0</span>;
            Bh = Ah | <span class="hljs-number">0</span>;
            Bl = Al | <span class="hljs-number">0</span>;
            <span class="hljs-keyword">const</span> All = _u64_js_1.default.add3L(T1l, sigma0l, MAJl);
            Ah = _u64_js_1.default.add3H(All, T1h, sigma0h, MAJh);
            Al = All | <span class="hljs-number">0</span>;
        }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16"></a>
</div>
<p>Add the compressed chunk to the current hash value</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        ({ <span class="hljs-attr">h</span>: Ah, <span class="hljs-attr">l</span>: Al } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Ah | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Al | <span class="hljs-number">0</span>, Ah | <span class="hljs-number">0</span>, Al | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Bh, <span class="hljs-attr">l</span>: Bl } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Bh | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Bl | <span class="hljs-number">0</span>, Bh | <span class="hljs-number">0</span>, Bl | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Ch, <span class="hljs-attr">l</span>: Cl } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Ch | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Cl | <span class="hljs-number">0</span>, Ch | <span class="hljs-number">0</span>, Cl | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Dh, <span class="hljs-attr">l</span>: Dl } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Dh | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Dl | <span class="hljs-number">0</span>, Dh | <span class="hljs-number">0</span>, Dl | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Eh, <span class="hljs-attr">l</span>: El } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Eh | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.El | <span class="hljs-number">0</span>, Eh | <span class="hljs-number">0</span>, El | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Fh, <span class="hljs-attr">l</span>: Fl } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Fh | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Fl | <span class="hljs-number">0</span>, Fh | <span class="hljs-number">0</span>, Fl | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Gh, <span class="hljs-attr">l</span>: Gl } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Gh | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Gl | <span class="hljs-number">0</span>, Gh | <span class="hljs-number">0</span>, Gl | <span class="hljs-number">0</span>));
        ({ <span class="hljs-attr">h</span>: Hh, <span class="hljs-attr">l</span>: Hl } = _u64_js_1.default.add(<span class="hljs-keyword">this</span>.Hh | <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.Hl | <span class="hljs-number">0</span>, Hh | <span class="hljs-number">0</span>, Hl | <span class="hljs-number">0</span>));
        <span class="hljs-keyword">this</span>.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);
    }
    roundClean() {
        SHA512_W_H.fill(<span class="hljs-number">0</span>);
        SHA512_W_L.fill(<span class="hljs-number">0</span>);
    }
    destroy() {
        <span class="hljs-keyword">this</span>.buffer.fill(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">this</span>.set(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    }
}
exports.SHA512 = SHA512;
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SHA512_224</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SHA512</span> </span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">super</span>();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17"></a>
</div>
<p>h -- high 32 bits, l -- low 32 bits</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">this</span>.Ah = <span class="hljs-number">0x8c3d37c8</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Al = <span class="hljs-number">0x19544da2</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bh = <span class="hljs-number">0x73e19966</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bl = <span class="hljs-number">0x89dcd4d6</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Ch = <span class="hljs-number">0x1dfab7ae</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Cl = <span class="hljs-number">0x32ff9c82</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dh = <span class="hljs-number">0x679dd514</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dl = <span class="hljs-number">0x582f9fcf</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Eh = <span class="hljs-number">0x0f6d2b69</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.El = <span class="hljs-number">0x7bd44da8</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fh = <span class="hljs-number">0x77e36f73</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fl = <span class="hljs-number">0x04c48942</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gh = <span class="hljs-number">0x3f9d85a8</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gl = <span class="hljs-number">0x6a1d36c8</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hh = <span class="hljs-number">0x1112e6ad</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hl = <span class="hljs-number">0x91d692a1</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.outputLen = <span class="hljs-number">28</span>;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SHA512_256</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SHA512</span> </span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">super</span>();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18"></a>
</div>
<p>h -- high 32 bits, l -- low 32 bits</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">this</span>.Ah = <span class="hljs-number">0x22312194</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Al = <span class="hljs-number">0xfc2bf72c</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bh = <span class="hljs-number">0x9f555fa3</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bl = <span class="hljs-number">0xc84c64c2</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Ch = <span class="hljs-number">0x2393b86b</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Cl = <span class="hljs-number">0x6f53b151</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dh = <span class="hljs-number">0x96387719</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dl = <span class="hljs-number">0x5940eabd</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Eh = <span class="hljs-number">0x96283ee2</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.El = <span class="hljs-number">0xa88effe3</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fh = <span class="hljs-number">0xbe5e1e25</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fl = <span class="hljs-number">0x53863992</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gh = <span class="hljs-number">0x2b0199fc</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gl = <span class="hljs-number">0x2c85b8aa</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hh = <span class="hljs-number">0x0eb72ddc</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hl = <span class="hljs-number">0x81c52ca2</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.outputLen = <span class="hljs-number">32</span>;
    }
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SHA384</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SHA512</span> </span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">super</span>();
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<p>h -- high 32 bits, l -- low 32 bits</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">this</span>.Ah = <span class="hljs-number">0xcbbb9d5d</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Al = <span class="hljs-number">0xc1059ed8</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bh = <span class="hljs-number">0x629a292a</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Bl = <span class="hljs-number">0x367cd507</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Ch = <span class="hljs-number">0x9159015a</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Cl = <span class="hljs-number">0x3070dd17</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dh = <span class="hljs-number">0x152fecd8</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Dl = <span class="hljs-number">0xf70e5939</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Eh = <span class="hljs-number">0x67332667</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.El = <span class="hljs-number">0xffc00b31</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fh = <span class="hljs-number">0x8eb44a87</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Fl = <span class="hljs-number">0x68581511</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gh = <span class="hljs-number">0xdb0c2e0d</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Gl = <span class="hljs-number">0x64f98fa7</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hh = <span class="hljs-number">0x47b5481d</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.Hl = <span class="hljs-number">0xbefa4fa4</span> | <span class="hljs-number">0</span>;
        <span class="hljs-keyword">this</span>.outputLen = <span class="hljs-number">48</span>;
    }
}
exports.sha512 = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>, utils_js_1.wrapConstructor</span>)(<span class="hljs-params">(</span>) =&gt;</span> <span class="hljs-keyword">new</span> SHA512());
exports.sha512_224 = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>, utils_js_1.wrapConstructor</span>)(<span class="hljs-params">(</span>) =&gt;</span> <span class="hljs-keyword">new</span> SHA512_224());
exports.sha512_256 = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>, utils_js_1.wrapConstructor</span>)(<span class="hljs-params">(</span>) =&gt;</span> <span class="hljs-keyword">new</span> SHA512_256());
exports.sha384 = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-number">0</span>, utils_js_1.wrapConstructor</span>)(<span class="hljs-params">(</span>) =&gt;</span> <span class="hljs-keyword">new</span> SHA384());
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="sourcemappingurlsha512.js.map">
  <h1>
    <a href="#sourcemappingurlsha512.js.map" name="sourcemappingurlsha512.js.map" class="pilcrow"></a>
sourceMappingURL=sha512.js.map
  </h1>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"></pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
